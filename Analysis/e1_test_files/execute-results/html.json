{
  "hash": "aabafdf5ff035db485dbacd1388f2183",
  "result": {
    "markdown": "---\ntitle: \"HTW E1 Testing\"\ncategories: [Analysis, R, Bayesian]\n---\n\n\n\n\n## Analyses Strategy\n\nTo assess differences between groups, we used Bayesian Mixed Effects Regression. Model fitting was performed with the brms package in R @burknerBrmsPackageBayesian2017, and descriptive stats and tables were extracted with the BayestestR package @makowskiBayestestRDescribingEffects2019a. Mixed effects regression enables us to take advantage of partial pooling, simultaneously estimating parameters at the individual and group level. Our use of Bayesian, rather than frequentist methods allows us to directly quantify the uncertainty in our parameter estimates, as well as circumventing convergence issues common to the frequentist analogues of our mixed models. For each model, we report the median values of the posterior distribution, and 95% credible intervals.\n\nEach model was set to run with 4 chains, 5000 iterations per chain, with the first 2500 of which were discarded as warmup chains. Rhat values were generally within an acceptable range, with values <=1.02 (see appendix for diagnostic plots). We used uninformative priors for the fixed effects of the model (condition and velocity band), and weakly informative Student T distributions for for the random effects. \n\nWe compared varied and constant performance across two measures, deviation and discrimination. Deviation was quantified as the absolute deviation from the nearest boundary of the velocity band, or set to 0 if the throw velocity fell anywhere inside the target band. Thus, when the target band was 600-800, throws of 400, 650, and 1100 would result in deviation values of 200, 0, and 300, respectively. Discrimination was measured by fitting a linear model to the testing throws of each subjects, with the lower end of the target velocity band as the predicted variable, and the x velocity produced by the participants as the predictor variable. Participants who reliably discriminated between velocity bands tended to have positive slopes with values ~1, while participants who made throws irrespective of the current target band would have slopes ~0.  \n\n\n\n\n\n\n\n\n\n::: {#tbl-bmm-structure .cell tbl-cap='Mixed model structure and coefficient descriptions'}\n\n```{.r .cell-code}\n# Create the data frame for the table\ntable_data <- data.frame(\n  Type = c(\n    rep(\"Population-Level Effects\", 4),\n    rep(\"Group-Level Effects\", 2),\n    \"Family Specific Parameters\"\n  ),\n  Parameter = c(\n    \"\\\\(\\\\beta_0\\\\)\", \"\\\\(\\\\beta_1\\\\)\", \"\\\\(\\\\beta_2\\\\)\", \"\\\\(\\\\beta_3\\\\)\",\n    \"\\\\(\\\\sigma_{\\\\text{Intercept}}\\\\)\", \"\\\\(\\\\sigma_{\\\\text{bandInt}}\\\\)\", \"\\\\(\\\\sigma_{\\\\text{Observation}}\\\\)\"\n  ),\n  Term = c(\n    \"(Intercept)\", \"conditVaried\", \"bandInt\", \"conditVaried:bandInt\",\n    \"sd__(Intercept)\", \"sd__bandInt\", \"sd__Observation\"\n  ),\n  Description = c(\n    \"Intercept representing the baseline deviation\", \"Effect of condition (Varied vs. Constant) on deviation\", \"Effect of target velocity band (bandInt) on deviation\", \"Interaction effect between training condition and target velocity band on deviation\",\n    \"Standard deviation for (Intercept)\", \"Standard deviation for bandInt\", \"Standard deviation for Gaussian Family\"\n  )\n) |>   mutate(\n    Term = glue::glue(\"<code>{Term}</code>\")\n  ) \n\n# Create the table\nkable_out <- table_data %>%\n  kbl(format = 'html', escape = FALSE, booktabs = TRUE, \n      #caption = '<span style = \"color:black;\"><center><strong>Table 1: General Model Structure Information</strong></center></span>',\n      col.names = c(\"Type\", \"Parameter\", \"Term\", \"Description\")) %>%\n  kable_styling(position=\"left\", bootstrap_options = c(\"hover\"), full_width = FALSE) %>%\n  column_spec(1, bold = FALSE, border_right = TRUE) %>%\n  column_spec(2, width = '4cm') %>%\n  column_spec(3, width = '4cm') %>%\n  row_spec(c(4, 7), extra_css = \"border-bottom: 2px solid black;\") %>%\n  pack_rows(\"\", 1, 4, bold = FALSE, italic = TRUE) %>%\n  pack_rows(\"\", 5, 6, bold = FALSE, italic = TRUE) %>%\n  pack_rows(\"\", 7, 7, bold = FALSE, italic = TRUE)\n\nkable_out\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover\" style=\"width: auto !important; \">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Type </th>\n   <th style=\"text-align:left;\"> Parameter </th>\n   <th style=\"text-align:left;\"> Term </th>\n   <th style=\"text-align:left;\"> Description </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"4\"><td colspan=\"4\" style=\"border-bottom: 1px solid;\"><em></em></td></tr>\n<tr>\n   <td style=\"text-align:left;border-right:1px solid;padding-left: 2em;\" indentlevel=\"1\"> Population-Level Effects </td>\n   <td style=\"text-align:left;width: 4cm; \"> \\(\\beta_0\\) </td>\n   <td style=\"text-align:left;width: 4cm; \"> <code>(Intercept)</code> </td>\n   <td style=\"text-align:left;\"> Intercept representing the baseline deviation </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;border-right:1px solid;padding-left: 2em;\" indentlevel=\"1\"> Population-Level Effects </td>\n   <td style=\"text-align:left;width: 4cm; \"> \\(\\beta_1\\) </td>\n   <td style=\"text-align:left;width: 4cm; \"> <code>conditVaried</code> </td>\n   <td style=\"text-align:left;\"> Effect of condition (Varied vs. Constant) on deviation </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;border-right:1px solid;padding-left: 2em;\" indentlevel=\"1\"> Population-Level Effects </td>\n   <td style=\"text-align:left;width: 4cm; \"> \\(\\beta_2\\) </td>\n   <td style=\"text-align:left;width: 4cm; \"> <code>bandInt</code> </td>\n   <td style=\"text-align:left;\"> Effect of target velocity band (bandInt) on deviation </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;border-right:1px solid;border-bottom: 2px solid black;padding-left: 2em;\" indentlevel=\"1\"> Population-Level Effects </td>\n   <td style=\"text-align:left;width: 4cm; border-bottom: 2px solid black;\"> \\(\\beta_3\\) </td>\n   <td style=\"text-align:left;width: 4cm; border-bottom: 2px solid black;\"> <code>conditVaried:bandInt</code> </td>\n   <td style=\"text-align:left;border-bottom: 2px solid black;\"> Interaction effect between training condition and target velocity band on deviation </td>\n  </tr>\n  <tr grouplength=\"2\"><td colspan=\"4\" style=\"border-bottom: 1px solid;\"><em></em></td></tr>\n<tr>\n   <td style=\"text-align:left;border-right:1px solid;padding-left: 2em;\" indentlevel=\"1\"> Group-Level Effects </td>\n   <td style=\"text-align:left;width: 4cm; \"> \\(\\sigma_{\\text{Intercept}}\\) </td>\n   <td style=\"text-align:left;width: 4cm; \"> <code>sd__(Intercept)</code> </td>\n   <td style=\"text-align:left;\"> Standard deviation for (Intercept) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;border-right:1px solid;padding-left: 2em;\" indentlevel=\"1\"> Group-Level Effects </td>\n   <td style=\"text-align:left;width: 4cm; \"> \\(\\sigma_{\\text{bandInt}}\\) </td>\n   <td style=\"text-align:left;width: 4cm; \"> <code>sd__bandInt</code> </td>\n   <td style=\"text-align:left;\"> Standard deviation for bandInt </td>\n  </tr>\n  <tr grouplength=\"1\"><td colspan=\"4\" style=\"border-bottom: 1px solid;\"><em></em></td></tr>\n<tr>\n   <td style=\"text-align:left;border-right:1px solid;border-bottom: 2px solid black;padding-left: 2em;\" indentlevel=\"1\"> Family Specific Parameters </td>\n   <td style=\"text-align:left;width: 4cm; border-bottom: 2px solid black;\"> \\(\\sigma_{\\text{Observation}}\\) </td>\n   <td style=\"text-align:left;width: 4cm; border-bottom: 2px solid black;\"> <code>sd__Observation</code> </td>\n   <td style=\"text-align:left;border-bottom: 2px solid black;\"> Standard deviation for Gaussian Family </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Results\n\n### Testing Phase - No feedback. \n\nIn the first part of the testing phase, participants are tested from each of the velocity bands, and receive no feedback after each throw. \n\n\n#### Deviation From Target Band\n\nDescriptive summaries testing deviation data are provided in @tbl-e1-test-nf-deviation and @fig-e1-test-dev. \nTo model differences in accuracy between groups, we used Bayesian mixed effects regression models to the trial level data from the testing phase. The primary model predicted the absolute deviation from the target velocity band (dist) as a function of training condition (condit), target velocity band (band), and their interaction, with random intercepts and slopes for each participant (id). \n\n\\begin{equation}\ndist_{ij} = \\beta_0 + \\beta_1 \\cdot condit_{ij} + \\beta_2 \\cdot band_{ij} + \\beta_3 \\cdot condit_{ij} \\cdot band_{ij} + b_{0i} + b_{1i} \\cdot band_{ij} + \\epsilon_{ij}\n\\end{equation}\n\n\n\n::: {#tbl-e1-test-nf-deviation .cell layout-ncol=\"2\" tbl-cap='Testing Deviation - Empirical Summary' tbl-subcap='[\"Constant Testing - Deviation\",\"Varied Testing - Deviation\"]'}\n\n````{.cell-code}\n```{{r}}\n#| label: tbl-e1-test-nf-deviation\n#| tbl-cap: \"Testing Deviation - Empirical Summary\"\n#| tbl-subcap: [\"Constant Testing - Deviation\", \"Varied Testing - Deviation\"]\n#| layout-ncol: 2\n\nresult <- test_summary_table(test, \"dist\", mfun = list(mean = mean, median = median, sd = sd))\nresult$constant\nresult$varied\n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Summary of dist - Constant</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Band </th>\n   <th style=\"text-align:left;\"> Band Type </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> Median </th>\n   <th style=\"text-align:right;\"> Sd </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 100-300 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 271 </td>\n   <td style=\"text-align:right;\"> 161 </td>\n   <td style=\"text-align:right;\"> 308 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 350-550 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 201 </td>\n   <td style=\"text-align:right;\"> 116 </td>\n   <td style=\"text-align:right;\"> 238 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 600-800 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 155 </td>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 194 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 800-1000 </td>\n   <td style=\"text-align:left;\"> Trained </td>\n   <td style=\"text-align:right;\"> 192 </td>\n   <td style=\"text-align:right;\"> 119 </td>\n   <td style=\"text-align:right;\"> 238 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1000-1200 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 233 </td>\n   <td style=\"text-align:right;\"> 157 </td>\n   <td style=\"text-align:right;\"> 282 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1200-1400 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 214 </td>\n   <td style=\"text-align:right;\"> 290 </td>\n  </tr>\n</tbody>\n</table>\n\n<table>\n<caption>Summary of dist - Varied</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Band </th>\n   <th style=\"text-align:left;\"> Band Type </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> Median </th>\n   <th style=\"text-align:right;\"> Sd </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 100-300 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 386 </td>\n   <td style=\"text-align:right;\"> 233 </td>\n   <td style=\"text-align:right;\"> 426 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 350-550 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 285 </td>\n   <td style=\"text-align:right;\"> 149 </td>\n   <td style=\"text-align:right;\"> 340 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 600-800 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 234 </td>\n   <td style=\"text-align:right;\"> 144 </td>\n   <td style=\"text-align:right;\"> 270 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 800-1000 </td>\n   <td style=\"text-align:left;\"> Trained </td>\n   <td style=\"text-align:right;\"> 221 </td>\n   <td style=\"text-align:right;\"> 149 </td>\n   <td style=\"text-align:right;\"> 248 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1000-1200 </td>\n   <td style=\"text-align:left;\"> Trained </td>\n   <td style=\"text-align:right;\"> 208 </td>\n   <td style=\"text-align:right;\"> 142 </td>\n   <td style=\"text-align:right;\"> 226 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1200-1400 </td>\n   <td style=\"text-align:left;\"> Trained </td>\n   <td style=\"text-align:right;\"> 242 </td>\n   <td style=\"text-align:right;\"> 182 </td>\n   <td style=\"text-align:right;\"> 235 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntest |>  ggplot(aes(x = vb, y = dist,fill=condit)) +\n    stat_summary(geom = \"bar\", position=position_dodge(), fun = mean) +\n    stat_summary(geom = \"errorbar\", position=position_dodge(.9), fun.data = mean_se, width = .4, alpha = .7) + \n  labs(x=\"Band\", y=\"Deviation From Target\")\n```\n\n::: {.cell-output-display}\n![E1. Deviations from target band during testing without feedback stage.](e1_test_files/figure-html/fig-e1-test-dev-1.png){#fig-e1-test-dev width=672}\n:::\n:::\n\n::: {#tbl-e1-bmm-dist .cell tbl-cap='Experiment 1. Bayesian Mixed Model predicting absolute deviation as a function of condition (Constant vs. Varied) and Velocity Band'}\n\n```{.r .cell-code}\n#contrasts(test$condit) \n\n# contrasts(test$vb)\n\nmodelName <- \"e1_testDistBand_RF_5K_Ml1\"\ne1_distBMM <- brm(dist ~ condit * bandInt + (1 + bandInt|id),\n                      data=test,file=paste0(here::here(\"data/model_cache\",modelName)),\n                      iter=5000,chains=4)\nmp1 <- GetModelStats(e1_distBMM) |> kable(escape=F,booktabs=T)\nmp1\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Term </th>\n   <th style=\"text-align:right;\"> Estimate </th>\n   <th style=\"text-align:right;\"> Est.Error </th>\n   <th style=\"text-align:right;\"> 95% CrI Lower </th>\n   <th style=\"text-align:right;\"> 95% CrI Upper </th>\n   <th style=\"text-align:right;\"> pd </th>\n   <th style=\"text-align:right;\"> Rhat </th>\n   <th style=\"text-align:right;\"> ESS </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:right;\"> 226.03 </td>\n   <td style=\"text-align:right;\"> 32.32 </td>\n   <td style=\"text-align:right;\"> 162.33 </td>\n   <td style=\"text-align:right;\"> 287.60 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n   <td style=\"text-align:right;\"> 414.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> conditVaried </td>\n   <td style=\"text-align:right;\"> 135.16 </td>\n   <td style=\"text-align:right;\"> 47.79 </td>\n   <td style=\"text-align:right;\"> 43.63 </td>\n   <td style=\"text-align:right;\"> 231.74 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n   <td style=\"text-align:right;\"> 430.61 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Band </td>\n   <td style=\"text-align:right;\"> -0.02 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> -0.09 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.74 </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n   <td style=\"text-align:right;\"> 505.15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> conditVaried:Band </td>\n   <td style=\"text-align:right;\"> -0.13 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n   <td style=\"text-align:right;\"> -0.23 </td>\n   <td style=\"text-align:right;\"> -0.03 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n   <td style=\"text-align:right;\"> 532.83 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ne1_distBMM |> emmeans( ~condit + bandInt, \n                       at = list(bandInt = c(100, 350, 600, 800, 1000, 1200))) |>\n  gather_emmeans_draws() |>\n  ggplot(aes(x = bandInt, y = .value, color = condit, fill = condit)) + \n  stat_dist_pointinterval() +\n  stat_lineribbon(alpha = .25, size = 1, .width = c(.95)) +\n    ylab(\"Predicted Deviation\") + xlab(\"Velocity Band\")+\n  scale_x_continuous(breaks = c(100, 350, 600, 800, 1000, 1200), \n                     labels = levels(test$vb), \n                     limits = c(0, 1400)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) \n```\n\n::: {.cell-output-display}\n![E1. Conditioinal Effect of Training Condition and Band. Ribbon indicated 95% Credible Intervals.](e1_test_files/figure-html/fig-e1-bmm-dist-1.png){#fig-e1-bmm-dist width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_data_grid=map_dfr(1, ~data.frame(unique(test[,c(\"id\",\"condit\",\"bandInt\")])))\n\ncSamp <- e1_distBMM |> \n  emmeans(\"condit\",by=\"bandInt\",at=list(bandInt=c(100,350,600,800,1000,1200)),\n          epred = TRUE, re_formula = NA) |> \n  pairs() |> gather_emmeans_draws()  |>\n  group_by(contrast, .draw,bandInt) |> summarise(value=mean(.value), n=n())\n\n ameBand <- cSamp |> ggplot(aes(x=value,y=\"\")) + \n  stat_halfeye() + \n  geom_vline(xintercept=0,alpha=.4)+\n  facet_wrap(~bandInt,ncol=1) + labs(x=\"Marginal Effect (Constant - Varied)\", y= NULL)+\n  ggtitle(\"Average Marginal Effect\")\n\nbothConditGM <- e1_distBMM %>%\n  epred_draws(newdata = new_data_grid,ndraws = 2000, re_formula = NA) |>\n  ggplot(aes(x=.epred,y=\"Mean\",fill=condit)) + \n  stat_halfeye() +facet_wrap(~bandInt, ncol = 1) +\n  labs(x=\"Predicted Deviation\", y=NULL)+\n  ggtitle(\"Grand Means\") +theme(legend.position = \"bottom\")\n\n(bothConditGM | ameBand) + plot_layout(widths=c(2,1.0))\n```\n\n::: {.cell-output-display}\n![E1. Predicted Means Per Condition and Band, and Average Marginal Effect (Constant - Varied)](e1_test_files/figure-html/fig-e1-ame-1.png){#fig-e1-ame width=960}\n:::\n:::\n\n\n\n\nThe model predicting absolute deviation (dist) showed clear effects of both training condition and target velocity band (Table X). Overall, the varied training group showed a larger deviation relative to the constant training group (β = 135, 95% CI [43, 231]). Deviation also depended on target velocity band, with lower bands showing less deviation. See @tbl-e1-bmm-dist for full model output. \n\n\n#### Discrimination between Velocity Bands\n\nIn addition to accuracy/deviation. We also assessed the ability of participants to reliably discriminate between the velocity bands (i.e. responding differently when prompted for band 600-800 than when prompted for band 150-350). @tbl-e1-test-nf-vx shows descriptive statistics of this measure, and Figure 1 visualizes the full distributions of throws for each combination of condition and velocity band. To quantify discrimination, we again fit Bayesian Mixed Models as above, but this time the dependent variable was the raw x velocity generated by participants. \n\n\\begin{equation}\nvx_{ij} = \\beta_0 + \\beta_1 \\cdot condit_{ij} + \\beta_2 \\cdot bandInt_{ij} + \\beta_3 \\cdot condit_{ij} \\cdot bandInt_{ij} + b_{0i} + b_{1i} \\cdot bandInt_{ij} + \\epsilon_{ij}\n\\end{equation}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest %>% group_by(id,vb,condit) |> plot_distByCondit()\n```\n\n::: {.cell-output-display}\n![E1 testing x velocities. Translucent bands with dash lines indicate the correct range for each velocity band.](e1_test_files/figure-html/fig-e1-test-vx-1.png){#fig-e1-test-vx width=1056}\n:::\n:::\n\n::: {#tbl-e1-test-nf-vx .cell layout-ncol=\"2\" tbl-cap='Testing vx - Empirical Summary' tbl-subcap='[\"Constant Testing - vx\",\"Varied Testing - vx\"]'}\n\n````{.cell-code}\n```{{r}}\n#| label: tbl-e1-test-nf-vx\n#| tbl-cap: \"Testing vx - Empirical Summary\"\n#| tbl-subcap: [\"Constant Testing - vx\", \"Varied Testing - vx\"]\n#| layout-ncol: 2\n\nresult <- test_summary_table(test, \"vx\", mfun = list(mean = mean, median = median, sd = sd))\nresult$constant \nresult$varied \n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Summary of vx - Constant</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Band </th>\n   <th style=\"text-align:left;\"> Band Type </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> Median </th>\n   <th style=\"text-align:right;\"> Sd </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 100-300 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 544 </td>\n   <td style=\"text-align:right;\"> 461 </td>\n   <td style=\"text-align:right;\"> 335 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 350-550 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 674 </td>\n   <td style=\"text-align:right;\"> 638 </td>\n   <td style=\"text-align:right;\"> 309 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 600-800 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 786 </td>\n   <td style=\"text-align:right;\"> 742 </td>\n   <td style=\"text-align:right;\"> 305 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 800-1000 </td>\n   <td style=\"text-align:left;\"> Trained </td>\n   <td style=\"text-align:right;\"> 1010 </td>\n   <td style=\"text-align:right;\"> 952 </td>\n   <td style=\"text-align:right;\"> 358 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1000-1200 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 1167 </td>\n   <td style=\"text-align:right;\"> 1104 </td>\n   <td style=\"text-align:right;\"> 430 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1200-1400 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 1283 </td>\n   <td style=\"text-align:right;\"> 1225 </td>\n   <td style=\"text-align:right;\"> 483 </td>\n  </tr>\n</tbody>\n</table>\n\n<table>\n<caption>Summary of vx - Varied</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Band </th>\n   <th style=\"text-align:left;\"> Band Type </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> Median </th>\n   <th style=\"text-align:right;\"> Sd </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 100-300 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 664 </td>\n   <td style=\"text-align:right;\"> 533 </td>\n   <td style=\"text-align:right;\"> 448 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 350-550 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 768 </td>\n   <td style=\"text-align:right;\"> 677 </td>\n   <td style=\"text-align:right;\"> 402 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 600-800 </td>\n   <td style=\"text-align:left;\"> Extrapolation </td>\n   <td style=\"text-align:right;\"> 876 </td>\n   <td style=\"text-align:right;\"> 813 </td>\n   <td style=\"text-align:right;\"> 390 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 800-1000 </td>\n   <td style=\"text-align:left;\"> Trained </td>\n   <td style=\"text-align:right;\"> 1064 </td>\n   <td style=\"text-align:right;\"> 1029 </td>\n   <td style=\"text-align:right;\"> 370 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1000-1200 </td>\n   <td style=\"text-align:left;\"> Trained </td>\n   <td style=\"text-align:right;\"> 1180 </td>\n   <td style=\"text-align:right;\"> 1179 </td>\n   <td style=\"text-align:right;\"> 372 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1200-1400 </td>\n   <td style=\"text-align:left;\"> Trained </td>\n   <td style=\"text-align:right;\"> 1265 </td>\n   <td style=\"text-align:right;\"> 1249 </td>\n   <td style=\"text-align:right;\"> 412 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-e1-bmm-vx .cell tbl-cap='Experiment 1. Bayesian Mixed Model Predicting Vx as a function of condition (Constant vs. Varied) and Velocity Band'}\n\n```{.r .cell-code}\ne1_vxBMM <- brm(vx ~ condit * bandInt + (1 + bandInt|id),\n                        data=test,file=paste0(here::here(\"data/model_cache\", \"e1_testVxBand_RF_5k_Ml1\")),\n                        iter=5000,chains=4,silent=0,\n                        control=list(adapt_delta=0.94, max_treedepth=13))\nmt2 <-GetModelStats(e1_vxBMM ) |> kable(escape=F,booktabs=T)\nmt2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Term </th>\n   <th style=\"text-align:right;\"> Estimate </th>\n   <th style=\"text-align:right;\"> Est.Error </th>\n   <th style=\"text-align:right;\"> 95% CrI Lower </th>\n   <th style=\"text-align:right;\"> 95% CrI Upper </th>\n   <th style=\"text-align:right;\"> pd </th>\n   <th style=\"text-align:right;\"> Rhat </th>\n   <th style=\"text-align:right;\"> ESS </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:right;\"> 439.42 </td>\n   <td style=\"text-align:right;\"> 39.13 </td>\n   <td style=\"text-align:right;\"> 362.91 </td>\n   <td style=\"text-align:right;\"> 517.87 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 497.68 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> conditVaried </td>\n   <td style=\"text-align:right;\"> 146.06 </td>\n   <td style=\"text-align:right;\"> 55.81 </td>\n   <td style=\"text-align:right;\"> 35.96 </td>\n   <td style=\"text-align:right;\"> 254.70 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 569.96 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Band </td>\n   <td style=\"text-align:right;\"> 0.69 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.59 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 672.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> conditVaried:Band </td>\n   <td style=\"text-align:right;\"> -0.12 </td>\n   <td style=\"text-align:right;\"> 0.06 </td>\n   <td style=\"text-align:right;\"> -0.25 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.97 </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n   <td style=\"text-align:right;\"> 750.18 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nSee @tbl-e1-bmm-vx for the full model results. The estimated coefficient for training condition (β = 146, 95% CI [35.96, 254.70]) suggests that the varied group tends to produce harder throws than the constant group. More relevant to the issue of discrimination is the slope on Velocity Band (β = 0.69, 95% CI [.59, .77]). Although the median slope does fall underneath the ideal of value of 1, the fact that the 95% credible interval does not contain 0 provides strong evidence that participants exhibted some discrimination between bands. The slope coefficient (β = 0.69 ) also seems in accordance with an examination of @tbl-e1-test-nf-vx, which shows that average x-velocity fell within the range of the target band for four out of six of the bands ($4/6$=.67). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ne1_vxBMM |> emmeans( ~condit + bandInt, \n                       at = list(bandInt = c(100, 350, 600, 800, 1000, 1200))) |>\n  gather_emmeans_draws() |>\n  ggplot(aes(x = bandInt, y = .value, color = condit, fill = condit)) + \n  stat_dist_pointinterval() +\n  stat_lineribbon(alpha = .25, size = 1, .width = c(.95)) +\n  ylab(\"Predicted X Velocity\") + xlab(\"Band\")+\n  scale_x_continuous(breaks = c(100, 350, 600, 800, 1000, 1200), \n                     labels = levels(test$vb), \n                     limits = c(0, 1400)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) \n```\n\n::: {.cell-output-display}\n![Conditional effect of training condition and Band. Ribbons indicate 95% HDI.](e1_test_files/figure-html/fig-e1-bmm-vx-1.png){#fig-e1-bmm-vx width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_data_grid=map_dfr(1, ~data.frame(unique(test[,c(\"id\",\"condit\",\"bandInt\")]))) |> \n  dplyr::arrange(id,bandInt) |> \n  mutate(condit_dummy = ifelse(condit == \"Varied\", 1, 0)) \n\nindv_coefs <- coef(e1_vxBMM)$id |> \n  as_tibble(rownames=\"id\") |> \n  select(id, starts_with(\"Est\")) |>\n  left_join(e1Sbjs, by=join_by(id) ) |> \n  group_by(condit) |> \n  mutate(rank = rank(desc(Estimate.bandInt)),\n         intErrorRank=rank((Est.Error.Intercept)),\n         bandErrorRank=rank((Est.Error.bandInt)),\n         nCond = n()) |> arrange(intErrorRank)\n\nfixed_effects <- e1_vxBMM |> \n  spread_draws(`^b_.*`,regex=TRUE) |> arrange(.chain,.draw,.iteration)\n\n\nrandom_effects <- e1_vxBMM |> \n  gather_draws(`^r_id.*$`, regex = TRUE, ndraws = 2000) |> \n  separate(.variable, into = c(\"effect\", \"id\", \"term\"), sep = \"\\\\[|,|\\\\]\") |> \n  mutate(id = factor(id,levels=levels(test$id))) |> \n  pivot_wider(names_from = term, values_from = .value) |> arrange(id,.chain,.draw,.iteration)\n\ncd <- left_join(random_effects, fixed_effects, by = join_by(\".chain\", \".iteration\", \".draw\")) |> \n  rename(bandInt_RF = bandInt) |>\n  mutate(Slope=bandInt_RF+b_bandInt) |> group_by(id) \n\ncdMed <- cd |> group_by(id) |> median_qi(Slope)  |> \n  left_join(e1Sbjs, by=join_by(id)) |> group_by(condit) |>\n  mutate(rankSlope=rank(Slope)) |> arrange(rankSlope)\n\ncdMed %>% ggplot(aes(y=rankSlope, x=Slope,fill=condit,color=condit)) + \n  geom_pointrange(aes(xmin=.lower , xmax=.upper)) + \n  labs(x=\"Estimated Slope\", y=\"Participant\")  + facet_wrap(~condit)  \n\n# cdMed |>  ggplot(aes(x = condit, y = Slope,fill=condit)) +\n#     stat_summary(geom = \"bar\", position=position_dodge(), fun = mean) +\n#     stat_summary(geom = \"errorbar\", position=position_dodge(.9), fun.data = mean_se, width = .4, alpha = .7) + \n#   geom_jitter()\n#   labs(x=\"Band\", y=\"Deviation From Target\")\n```\n\n::: {.cell-output-display}\n![Slope estimates by participant - ordered from lowest to highest within each condition.](e1_test_files/figure-html/fig-e1-slope-dist-1.png){#fig-e1-slope-dist width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnTop <- 2\n\ncombined_df <- left_join(random_effects, fixed_effects, by = join_by(\".chain\", \".iteration\", \".draw\")) |> \n  rename(bandInt_RF = bandInt) |>\n  right_join(new_data_grid, by = join_by(\"id\"),relationship=\"many-to-many\") |> \n  mutate(\n    fixed_effects = b_Intercept +\n      (bandInt * b_bandInt) +\n      condit_dummy * b_conditVaried + \n      (bandInt * condit_dummy) * `b_conditVaried:bandInt` ,  # Note: Replace : with correct operator\n    random_effects = Intercept + bandInt_RF,  # Assuming random effects for intercept and bandInt\n    estimate = fixed_effects + random_effects\n  )\n\ncombined_df |> \n  filter(id %in% (indv_coefs |> filter(rank<=nTop) |> pull(id)) )  |> \n  group_by(id, bandInt) |>\n  sample_n(200) |>\n  ggplot(aes(x=bandInt,y=estimate)) + \n  geom_abline(aes(intercept=Intercept+b_Intercept, slope=bandInt_RF+b_bandInt), color=\"grey50\", alpha=.1) +\n  geom_abline(data=indv_coefs |> \n                filter(id %in% (indv_coefs |> filter(rank<=nTop) |> pull(id))),aes(intercept=Estimate.Intercept,slope=Estimate.bandInt),color=\"red\") +\n  stat_pointinterval(data=test |> filter(id %in% (indv_coefs |> filter(rank<=nTop) |> pull(id))), aes(x=bandInt,y=vx, color=vb)) +\n  facet_nested_wrap(vars(condit,id),ncol = 2) +\n  scale_x_continuous(breaks = c(100, 350, 600, 800, 1000, 1200), \n                     labels = levels(test$vb), \n                     limits = c(0, 1400)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +  ylab(\"X Velocity\") + xlab(\"Band\")\n```\n\n::: {.cell-output-display}\n![Subset of Varied and Constant Participants with the largest estimated slope values. Red lines represent the best fitting line for each participant, gray lines are 200 random samples from the posterior distribution. Colored points and intervals at each band represent the empirical median and 95% HDI.](e1_test_files/figure-html/fig-e1-indv-slopes-1.png){#fig-e1-indv-slopes width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnTop <- 2\n\n\ncombined_df |> \n  filter(id %in% (indv_coefs |> filter(rank>nCond-nTop) |> pull(id)) )  |> \n  group_by(id, bandInt) |>\n  sample_n(200) |>\n  ggplot(aes(x=bandInt,y=estimate)) + \n  geom_abline(aes(intercept=Intercept+b_Intercept, slope=bandInt_RF+b_bandInt), color=\"grey50\", alpha=.1) +\n  geom_abline(data=indv_coefs |> \n                filter(id %in% (indv_coefs |> filter(rank>nCond-nTop) |> pull(id))),aes(intercept=Estimate.Intercept,slope=Estimate.bandInt),color=\"red\") +\n  stat_pointinterval(data=test |> filter(id %in% (indv_coefs |> filter(rank>nCond-nTop) |> pull(id))), aes(x=bandInt,y=vx, color=vb)) +\n  facet_nested_wrap(vars(condit,id),ncol = 2) +\n  scale_x_continuous(breaks = c(100, 350, 600, 800, 1000, 1200), \n                     labels = levels(test$vb), \n                     limits = c(0, 1400)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +  ylab(\"X Velocity\") + xlab(\"Band\")\n```\n\n::: {.cell-output-display}\n![Subset of Varied and Constant Participants with the smallest estimated slope values. Red lines represent the best fitting line for each participant, gray lines are 200 random samples from the posterior distribution. Colored points and intervals at each band represent the empirical median and 95% HDI.](e1_test_files/figure-html/fig-e1-indv-slopes-small-1.png){#fig-e1-indv-slopes-small width=672}\n:::\n:::\n\n\n\n## Acknowledgments {.appendix}\n\nI am grateful for the insightful comments offered by the anonymous peer reviewers at Books & Texts. The generosity and expertise of one and all have improved this study in innumerable ways and saved me from many errors; those that inevitably remain are entirely my own responsibility.\n\n\n\n\n#### E1 Results Discussion\n\nNEEDS TO BE WRITTEN\n\n\n\n\n::: {.cell layout=\"[[70,30],[-5]]\" tbl-cap='Deviations from target'}\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n## References\n\n::: {#refs}\n:::\n\n\n\n\n",
    "supporting": [
      "e1_test_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}