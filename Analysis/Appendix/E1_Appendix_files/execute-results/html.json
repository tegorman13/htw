{
  "hash": "4541d18654a55c2b241feca62e8bbda4",
  "result": {
    "markdown": "\n\n\n\n## E1 Appendix\n\n### Posterior Predictive Distributions\n\n\n::: {#fig-post-pred .cell}\n\n```{.r .cell-code}\nvx_pred <- \n  posterior_predict(e1_vxBMM, ndraws = 500) |> \n  array_branch(margin=1) |> \n   map_dfr( \n    function(yrep_iter) {\n      test  |>\n        mutate(vx_pred = yrep_iter)\n    },\n    .id = 'iter'\n  ) |>\n  mutate(iter = as.numeric(iter))\n\n\ndist_pred <- \n  posterior_predict(e1_distBMM, ndraws = 500) |> \n  array_branch(margin=1) |> \n   map_dfr( \n    function(yrep_iter) {\n      test  |>\n        mutate(dist_pred = yrep_iter)\n    },\n    .id = 'iter'\n  ) |>\n  mutate(iter = as.numeric(iter))\n\n\n\ndist_pred  |>\n  filter(iter < 100) %>%\n  ggplot(aes(dist_pred, group = iter)) +\n  geom_line(alpha = .03, stat = 'density', color = 'blue') +\n  geom_density(data = test,\n               aes(dist,col=vb),\n               inherit.aes = FALSE,\n               size = 0.7) + # 1\n  facet_grid(condit ~ vb) +\n  xlab('Deviation')\n\n\nvx_pred  |>\n  filter(iter < 100) %>%\n  ggplot(aes(vx_pred, group = iter)) +\n  geom_line(alpha = .03, stat = 'density', color = 'blue') +\n  geom_density(data = test,\n               aes(vx,col=vb),\n               inherit.aes = FALSE,\n               size = 0.7) + # 1\n  facet_grid(condit ~ vb) +\n  xlab('Vx')\n```\n\n::: {.cell-output-display}\n![Posterior Predictive Distribution - Deviation](E1_Appendix_files/figure-html/fig-post-pred-1.png){#fig-post-pred-1 width=1248}\n:::\n\n::: {.cell-output-display}\n![Posterior Predictive Distribution - X Velocity](E1_Appendix_files/figure-html/fig-post-pred-2.png){#fig-post-pred-2 width=1248}\n:::\n\nPosterior Predictive distributions for Deviation and Vx. Posterior Draws in Blue, colored lines are empirical data.\n:::\n\n\n\n\n### Empirical vs. Predicted\n\n\n::: {.cell}\n\n```{.r .cell-code}\n{\nvx_pred  |>\n  filter(iter < 100)  |> group_by(id,condit,vb,iter) |>\n  summarise(vx_pred=mean(vx_pred)) %>%\n  ggplot(aes(x=vb,y=vx_pred,fill=condit)) + \n  geom_flat_violin( position = position_nudge(x = 0.1, y = 0),\n                   adjust = 1.5,\n                   trim = FALSE, alpha = .5, colour = NA) +\n  # geom_point(aes(x = as.numeric(vb) - 0.15, y = vx_pred, colour = vb),\n  #            position = position_jitter(width = 0.05, height = 0),\n  #            size = 1, shape = 20) +\n  geom_boxplot(aes(x = vb, y = vx_pred, fill = condit),\n               outlier.shape = NA,\n               alpha = 0.5,\n               width = 0.1,\n               colour = \"black\") +\n  geom_hline(yintercept = 0,\n             linetype = 'dashed',\n             color = 'red',\n             size = 0.4) + \n  coord_flip() + ggtitle(\"Predicted Vx\")  } /\n{\nvx_pred  |>\n  filter(iter < 2)  |> group_by(id,condit,vb) |>\n  summarise(vx=mean(vx)) %>%\n  ggplot(aes(x=vb,y=vx,fill=condit)) + \n  geom_flat_violin( position = position_nudge(x = 0.1, y = 0),\n                   adjust = 1.5,\n                   trim = FALSE,\n                   alpha = .5,\n                   colour = NA) +\n  geom_point(aes(x = as.numeric(vb) - 0.15,col=condit),\n             # position = position_jitter(width = 0.05),\n             position = position_jitter(width = 0.05, height = 0),\n             size = 1,\n             shape = 20) +\n  geom_boxplot(\n               outlier.shape = NA,\n               alpha = 0.5,\n               width = 0.1,\n               colour = \"black\") +\n  geom_hline(yintercept = 0,\n             linetype = 'dashed',\n             color = 'red',\n             size = 0.4) + \n  coord_flip() + ggtitle(\"Empirical Vx\") }\n```\n\n::: {.cell-output-display}\n![Bayesian Mixed Model predictions vs. Empirical Predictions - X velocity](E1_Appendix_files/figure-html/fig-empVsPred-1.png){#fig-empVsPred width=1152}\n:::\n:::\n\n\n\n### Different Aggregations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nepId <- vx_pred  |>\n  filter(iter < 2)  |> group_by(id,condit,vb) |>\n  summarise(vx=median(vx)) |>\n  ggplot(aes(x=vb,y=vx,fill=condit)) + \n  geom_flat_violin(aes(fill=condit), position = position_nudge(x = 0.1, y = 0),\n                   adjust = 1.5,trim = FALSE, alpha = .5, colour = NA) +\n  geom_point(aes(x = as.numeric(vb) - 0.15, col=condit),\n             position = position_jitter(width = 0.05, height = 0),\n             size = 1, shape = 20, alpha=.7) +\n  geom_boxplot(aes(x=vb,y=vx,fill=condit),\n               outlier.shape = NA,\n               alpha = 0.5, width = 0.1) +\n  geom_hline(yintercept = 0,\n             linetype = 'dashed',\n             color = 'red',\n             size = 0.4) + \n  coord_flip() + ggtitle(\"Empirical Vx - Subject level averaging\") \n\nepTrial <- vx_pred  |>\n  filter(iter < 2)  |> group_by(id,condit,vb) |>\n  ggplot(aes(x=vb,y=vx,fill=condit)) + \n  geom_flat_violin(aes(fill=condit), position = position_nudge(x = 0.1, y = 0),\n                   adjust = 1.5,trim = FALSE, alpha = .5, colour = NA) +\n  geom_point(aes(x = as.numeric(vb) - 0.15, col=condit),\n             position = position_jitter(width = 0.05, height = 0),\n             size = .5, shape = 20, alpha=.7) +\n  geom_boxplot(aes(x=vb,y=vx,fill=condit),\n               outlier.shape = NA,\n               alpha = 0.5, width = 0.1) +\n  geom_hline(yintercept = 0,\n             linetype = 'dashed',\n             color = 'red',\n             size = 0.4) + \n  coord_flip() + ggtitle(\"Empirical Vx - Raw Trial\") +\n   theme(axis.title.y=element_blank(),\n        axis.text.y=element_blank())\n\nepId + epTrial\n```\n\n::: {.cell-output-display}\n![E1. Distribution of vx at Participant and Trial level](E1_Appendix_files/figure-html/fig-empirical-vxGrp-1.png){#fig-empirical-vxGrp width=1248}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nepId <- dist_pred  |>\n  filter(iter < 2)  |> group_by(id,condit,vb) |>\n  summarise(dist=median(dist)) |>\n  ggplot(aes(x=vb,y=dist,fill=condit)) + \n  geom_flat_violin(aes(fill=condit), position = position_nudge(x = 0.1, y = 0),\n                   adjust = 1.5,trim = FALSE, alpha = .5, colour = NA) +\n  geom_point(aes(x = as.numeric(vb) - 0.15, col=condit),\n             position = position_jitter(width = 0.05, height = 0),\n             size = 1, shape = 20, alpha=.7) +\n  geom_boxplot(aes(x=vb,y=dist,fill=condit),\n               outlier.shape = NA,\n               alpha = 0.5, width = 0.1) +\n  geom_hline(yintercept = 0,\n             linetype = 'dashed',\n             color = 'red',\n             size = 0.4) + \n  coord_flip() + ggtitle(\"Empirical Deviation - Subject level averaging\") \n\nepTrial <- dist_pred  |>\n  filter(iter < 2)  |> group_by(id,condit,vb) |>\n  ggplot(aes(x=vb,y=dist,fill=condit)) + \n  geom_flat_violin(aes(fill=condit), position = position_nudge(x = 0.1, y = 0),\n                   adjust = 1.5,trim = FALSE, alpha = .5, colour = NA) +\n  geom_point(aes(x = as.numeric(vb) - 0.15, col=condit),\n             position = position_jitter(width = 0.05, height = 0),\n             size = .5, shape = 20, alpha=.7) +\n  geom_boxplot(aes(x=vb,y=dist,fill=condit),\n               outlier.shape = NA,\n               alpha = 0.5, width = 0.1) +\n  geom_hline(yintercept = 0,\n             linetype = 'dashed',\n             color = 'red',\n             size = 0.4) + \n  coord_flip() + ggtitle(\"Empirical Deviation - Raw Trial\") +\n   theme(axis.title.y=element_blank(),\n        axis.text.y=element_blank())\n\nepId + epTrial\n```\n\n::: {.cell-output-display}\n![E1. Distribution of Vx  at Participant and Trial level](E1_Appendix_files/figure-html/fig-empirical-distGrp-1.png){#fig-empirical-distGrp width=1248}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_data_grid=map_dfr(1, ~data.frame(unique(test[,c(\"id\",\"condit\",\"bandInt\")])))\n\ncSamp <- e1_distBMM  |> \n  emmeans(\"condit\",by=\"bandInt\",at=list(bandInt=c(100,350,600,800,1000,1200)),\n          epred = TRUE, re_formula = NA) |> \n  pairs() |> gather_emmeans_draws()  |>\n  group_by(contrast, .draw,bandInt) |> summarise(value=mean(.value), n=n())\n\n\n ameBand <- cSamp |> ggplot(aes(x=value,y=\"\")) + \n  stat_halfeye() + \n  geom_vline(xintercept=0,alpha=.4)+\n  facet_wrap(~bandInt,ncol=1) + labs(x=\"Marginal Effect (Constant - Varied)\", y= NULL)+\n  ggtitle(\"Average Marginal Effect\")\n\nbothConditGM <- e1_distBMM %>%\n  epred_draws(newdata = new_data_grid,ndraws = 2000, re_formula = NA) |>\n  ggplot(aes(x=.epred,y=\"Mean\",fill=condit)) + \n  stat_halfeye() +facet_wrap(~bandInt, ncol = 1) +\n  labs(x=\"Predicted Deviation\", y=NULL)+\n  ggtitle(\"Grand Means\") +theme(legend.position = \"bottom\")\n\n(bothConditGM | ameBand) + plot_layout(widths=c(2,1.0))\n```\n\n::: {.cell-output-display}\n![E1. Predicted Means Per Condition and Band, and Average Marginal Effect (Constant - Varied)](E1_Appendix_files/figure-html/fig-e1-ame-1.png){#fig-e1-ame width=960}\n:::\n:::",
    "supporting": [
      "E1_Appendix_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}