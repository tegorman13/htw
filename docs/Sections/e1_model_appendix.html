<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Thomas Gorman">
<meta name="dcterms.date" content="2024-03-21">
<title>HTW Project - ABC-rejection models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Misc/benchmarks.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../site_libs/tabwid-1.1.3/tabwid.js"></script><script src="../site_libs/core-js-2.5.3/shim.min.js"></script><script src="../site_libs/react-18.2.0/react.min.js"></script><script src="../site_libs/react-18.2.0/react-dom.min.js"></script><script src="../site_libs/reactwidget-1.0.0/react-tools.js"></script><script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="../site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="../site_libs/reactable-binding-0.4.4/reactable.js"></script><link rel="stylesheet" href="../Assets/Style/calloutTG.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Sections/e1_model_appendix.html">Appendix</a></li><li class="breadcrumb-item"><a href="../Sections/e1_model_appendix.html">ABC-rejection models</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">HTW Project</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/tegorman13/htw" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW Project</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manuscript</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Sections</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Sections/Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Sections/Methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Sections/Results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Sections/Discussion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Discussion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Sections/combo1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">combo1</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Analyses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/e1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experiment 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/e2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experiment 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/e3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experiment 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/combo_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW All Exp Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/e1_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW E1 Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/e2_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW E2 Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/e3_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW E3 Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/e1_Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E1 Extras</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model/htw_exam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EXAM Group Fits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model/htw_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model/htw_model_e1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW Model e1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model/htw_model_e2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW Model e2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model/htw_model_e3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW Model e3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model/hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW Hybrid Models</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Simulations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Simulations/DeLosh97_Sim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulating DeLosh 1997</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Simulations/SimReplications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Simulations</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Interactive</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Misc/Visuals_Interactives/ojs_alm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OJS ALM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Misc/Visuals_Interactives/ALM_Shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ALM Shiny App Code</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Misc</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analysis/combo_train.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Misc/Visuals_Interactives/model_viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Misc/htw_dp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Misc/HTW_ToDo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTW To-do and Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Misc/benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benchmarking</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Sections/e1_model_appendix.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">ABC-rejection models</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section"></a></li>
  <li><a href="#posterior-average-table" id="toc-posterior-average-table" class="nav-link" data-scroll-target="#posterior-average-table">Posterior Average Table</a></li>
  <li><a href="#interactive-test-predictions-table" id="toc-interactive-test-predictions-table" class="nav-link" data-scroll-target="#interactive-test-predictions-table">Interactive Test Predictions Table</a></li>
  <li><a href="#train-predictions" id="toc-train-predictions" class="nav-link" data-scroll-target="#train-predictions">Train Predictions</a></li>
  <li>
<a href="#posterior-predictive" id="toc-posterior-predictive" class="nav-link" data-scroll-target="#posterior-predictive">Posterior Predictive:</a>
  <ul>
<li><a href="#alt-grouping-of-posterior-predictive" id="toc-alt-grouping-of-posterior-predictive" class="nav-link" data-scroll-target="#alt-grouping-of-posterior-predictive">Alt grouping of Posterior Predictive</a></li>
  </ul>
</li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model Comparison:</a></li>
  <li>
<a href="#individual-predictive-plots" id="toc-individual-predictive-plots" class="nav-link" data-scroll-target="#individual-predictive-plots">Individual Predictive Plots</a>
  <ul>
<li><a href="#subject-1" id="toc-subject-1" class="nav-link" data-scroll-target="#subject-1">Subject 1</a></li>
  <li><a href="#subject-36" id="toc-subject-36" class="nav-link" data-scroll-target="#subject-36">Subject 36</a></li>
  </ul>
</li>
  <li><a href="#more-comparisons" id="toc-more-comparisons" class="nav-link" data-scroll-target="#more-comparisons">More Comparisons</a></li>
  <li><a href="#best-test---exam-fits" id="toc-best-test---exam-fits" class="nav-link" data-scroll-target="#best-test---exam-fits">Best Test - EXAM Fits</a></li>
  <li><a href="#best-test---alm-fits" id="toc-best-test---alm-fits" class="nav-link" data-scroll-target="#best-test---alm-fits">Best Test - ALM Fits</a></li>
  <li><a href="#best-test_train---exam-fits" id="toc-best-test_train---exam-fits" class="nav-link" data-scroll-target="#best-test_train---exam-fits">Best Test_Train - EXAM Fits</a></li>
  <li><a href="#best-test_train---alm-fits" id="toc-best-test_train---alm-fits" class="nav-link" data-scroll-target="#best-test_train---alm-fits">Best Test_Train - ALM Fits</a></li>
  <li><a href="#best-train---exam-fits" id="toc-best-train---exam-fits" class="nav-link" data-scroll-target="#best-train---exam-fits">Best Train - EXAM Fits</a></li>
  <li><a href="#best-train---alm-fits" id="toc-best-train---alm-fits" class="nav-link" data-scroll-target="#best-train---alm-fits">Best Train - ALM Fits</a></li>
  <li><a href="#learning-curves" id="toc-learning-curves" class="nav-link" data-scroll-target="#learning-curves">Learning Curves</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/tegorman13/htw/blob/main/Sections/e1_model_appendix.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/tegorman13/htw/edit/main/Sections/e1_model_appendix.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/tegorman13/htw/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Sections/e1_model_appendix.html">Appendix</a></li><li class="breadcrumb-item"><a href="../Sections/e1_model_appendix.html">ABC-rejection models</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">ABC-rejection models</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Thomas Gorman </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 21, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">dplyr</span>,<span class="va">purrr</span>,<span class="va">tidyr</span>,<span class="va">ggplot2</span>, <span class="va">data.table</span>, <span class="va">here</span>, <span class="va">patchwork</span>, <span class="va">conflicted</span>, </span>
<span>               <span class="va">stringr</span>,<span class="va">future</span>,<span class="va">furrr</span>, <span class="va">knitr</span>, <span class="va">reactable</span>, <span class="va">flextable</span>,<span class="va">ggstance</span>, <span class="va">htmltools</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer_all</span><span class="op">(</span><span class="st">"dplyr"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span>
<span><span class="fu">walk</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Display_Functions"</span>,<span class="st">"fun_alm"</span>,<span class="st">"fun_indv_fit"</span>,<span class="st">"fun_model"</span><span class="op">)</span>, <span class="op">~</span> <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Functions/"</span>, <span class="va">.x</span>, <span class="st">".R"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/e1_md_11-06-23.rds"</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data/e1_08-21-23.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">fd</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">expMode2</span> <span class="op">==</span> <span class="st">"Test"</span><span class="op">)</span> </span>
<span><span class="va">testAvg</span> <span class="op">&lt;-</span> <span class="va">test</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">vb</span>, <span class="va">bandInt</span>,<span class="va">bandType</span>,<span class="va">tOrder</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>nHits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span>,vx<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">vx</span><span class="op">)</span>,dist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>,sdist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sdist</span><span class="op">)</span>,n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,Percent_Hit<span class="op">=</span><span class="va">nHits</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">nbins</span><span class="op">=</span><span class="fl">3</span></span>
<span><span class="va">trainAvg</span> <span class="op">&lt;-</span> <span class="va">fd</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">expMode2</span> <span class="op">==</span> <span class="st">"Train"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>tr<span class="op">=</span><span class="va">trial</span>,x<span class="op">=</span><span class="va">vb</span>,Block<span class="op">=</span><span class="fu">case_when</span><span class="op">(</span><span class="va">expMode2</span><span class="op">==</span><span class="st">"Train"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">tr</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">tr</span><span class="op">)</span>, length.out<span class="op">=</span><span class="va">nbins</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,include.lowest<span class="op">=</span><span class="cn">TRUE</span>,labels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                                         <span class="va">expMode2</span><span class="op">==</span><span class="st">"Test"</span> <span class="op">~</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">vb</span>,<span class="va">x</span>,<span class="va">Block</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>dist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">vx</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># df with trial count columns for each level of expMode, for each id</span></span>
<span><span class="va">id_n</span> <span class="op">&lt;-</span> <span class="va">ds</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">summarise</span><span class="op">(</span>nTest<span class="op">=</span><span class="fu">n_distinct</span><span class="op">(</span><span class="va">tr</span><span class="op">[</span><span class="va">expMode2</span><span class="op">==</span><span class="st">"Test"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                        nTrain<span class="op">=</span><span class="fu">n_distinct</span><span class="op">(</span><span class="va">tr</span><span class="op">[</span><span class="va">expMode2</span><span class="op">==</span><span class="st">"Train"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>nTotal<span class="op">=</span><span class="va">nTest</span><span class="op">+</span><span class="va">nTrain</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">testAvg</span> <span class="op">&lt;-</span> <span class="va">test</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">vb</span>, <span class="va">bandInt</span>,<span class="va">bandType</span>,<span class="va">tOrder</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>nHits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span>,vx<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">vx</span><span class="op">)</span>,dist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>,sdist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sdist</span><span class="op">)</span>,n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,Percent_Hit<span class="op">=</span><span class="va">nHits</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_layer</span> <span class="op">&lt;&lt;-</span> <span class="va">output_layer</span> <span class="op">&lt;&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">350</span>,<span class="fl">600</span>,<span class="fl">800</span>,<span class="fl">1000</span>,<span class="fl">1200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>, <span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">ids2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">66</span>,<span class="fl">36</span><span class="op">)</span></span>
<span><span class="va">ids3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">71</span>,<span class="fl">101</span>,<span class="fl">4</span>,<span class="fl">76</span>,<span class="fl">192</span><span class="op">)</span></span>
<span><span class="va">idsBad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">76</span>,<span class="fl">192</span>, <span class="fl">101</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#file_name &lt;- "n_iter_300_ntry_3000_0800"</span></span>
<span><span class="co">#file_name &lt;- "n_iter_100_ntry_200_4509"</span></span>
<span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="st">"n_iter_100_ntry_400_3247"</span></span>
<span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="st">"n_iter_200_ntry_300_5354"</span></span>
<span></span>
<span><span class="co"># list.files(here('data/abc_reject'))</span></span>
<span><span class="co"># (grep("Train",list.files(here(paste0('data/abc_reject/',file_name)),</span></span>
<span><span class="co">#                                            pattern="EXAM_Test",full.names = TRUE),</span></span>
<span><span class="co">#                                 invert=TRUE, value=TRUE))</span></span>
<span></span>
<span></span>
<span><span class="va">ind_fits</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'data/abc_reject/'</span><span class="op">)</span>,<span class="va">file_name</span><span class="op">)</span>,full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="va">readRDS</span><span class="op">)</span></span>
<span><span class="co"># ind_fits &lt;- map(list.files(here('data/abc_reject/n_iter_2000_ntry_10_2918'),full.names=TRUE), readRDS)</span></span>
<span><span class="va">ind_fits_df</span> <span class="op">&lt;-</span> <span class="va">ind_fits</span> <span class="op">|&gt;</span> <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>dat<span class="op">=</span><span class="va">.x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, Model <span class="op">=</span> <span class="va">.x</span><span class="op">[[</span><span class="st">"Model"</span><span class="op">]</span><span class="op">]</span>, Fit_Method<span class="op">=</span><span class="va">.x</span><span class="op">[[</span><span class="st">"Fit_Method"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ind_fits_df</span> <span class="op">&lt;-</span> <span class="va">ind_fits_df</span> <span class="op">|&gt;</span> <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu">rbindlist</span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">dat</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>Model <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">Model</span>, Fit_Method <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">Fit_Method</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rbindlist</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="va">avg_samples</span> <span class="op">&lt;-</span> <span class="va">ind_fits_df</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>inc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">inc_count</span><span class="op">)</span>,iter_sum<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">iter_count</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">avg_samples</span><span class="op">$</span><span class="va">iter_sum</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 205708.7</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">avg_samples</span><span class="op">$</span><span class="va">iter_sum</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 205708.7</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">avg_samples</span><span class="op">$</span><span class="va">iter_sum</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 9965</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">avg_samples</span><span class="op">$</span><span class="va">iter_sum</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1644491</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">avg_samples</span><span class="op">$</span><span class="va">iter_sum</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 192543336</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">avg_samples</span><span class="op">$</span><span class="va">iter_sum</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 192543336</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">avg_samples</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">summarise</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">iter_sum</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   Model [2]
  Model Fit_Method `mean(inc)` `mean(iter_sum)`
  &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;            &lt;dbl&gt;
1 ALM   Test              763.          295556.
2 ALM   Test_Train        501.          197177.
3 ALM   Train             358.          163335.
4 EXAM  Test              581.          220765.
5 EXAM  Test_Train        445.          185647.
6 EXAM  Train             351.          171773.</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#run_params &lt;- tibble::lst(file_name,cMean=ind_fits[[1]]$cMean, cSig=ind_fits[[1]]$cSig, </span></span>
<span>                          </span>
<span><span class="va">run_params</span> <span class="op">&lt;-</span> <span class="fu">keep</span><span class="op">(</span><span class="va">ind_fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"character"</span>, <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">run_params</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">run_params</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">Model</span>,<span class="op">-</span><span class="va">Fit_Method</span><span class="op">)</span></span>
<span></span>
<span><span class="va">extract_info</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">raw_names</span>, <span class="va">run_params</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/fileutils.html">file_path_sans_ext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">raw_names</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">n_samp</span> <span class="op">&lt;-</span> <span class="fu">str_extract</span><span class="op">(</span><span class="va">raw_names</span>, <span class="st">"(?&lt;=_)\\d+(?=_)"</span><span class="op">)</span></span>
<span>  <span class="va">ntry_</span> <span class="op">&lt;-</span> <span class="fu">str_extract</span><span class="op">(</span><span class="va">raw_names</span>, <span class="st">"(?&lt;=ntry_)\\d+"</span><span class="op">)</span></span>
<span>  <span class="va">type</span> <span class="op">&lt;-</span> <span class="st">'ss'</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">run_params</span>, <span class="va">n_samp</span>, <span class="va">ntry_</span>, <span class="va">type</span>, <span class="va">fname</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">run_info</span> <span class="op">&lt;-</span> <span class="fu">extract_info</span><span class="op">(</span><span class="va">file_name</span>,<span class="va">run_params</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">generate_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Model</span>, <span class="va">post_samples</span>, <span class="va">data</span>, <span class="va">num_samples</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">return_dat</span> <span class="op">=</span> <span class="st">"train_data, test_data"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Filter data for the specific id without invalidating selfref</span></span>
<span>  <span class="va">sbj_data</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">id</span> <span class="op">==</span> <span class="va">post_samples</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">simulation_function</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Model</span> <span class="op">==</span> <span class="st">"EXAM"</span>, <span class="va">full_sim_exam</span>, <span class="va">full_sim_alm</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">target_data</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span><span class="va">return_dat</span>,</span>
<span>                        <span class="st">"test_data"</span> <span class="op">=</span> <span class="fu">copy</span><span class="op">(</span><span class="va">sbj_data</span><span class="op">[</span><span class="va">expMode2</span> <span class="op">==</span> <span class="st">"Test"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                        <span class="st">"train_data"</span> <span class="op">=</span> <span class="fu">copy</span><span class="op">(</span><span class="va">sbj_data</span><span class="op">[</span><span class="va">expMode2</span> <span class="op">==</span> <span class="st">"Train"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                        <span class="st">"train_data, test_data"</span> <span class="op">=</span> <span class="fu">copy</span><span class="op">(</span><span class="va">sbj_data</span><span class="op">[</span><span class="va">expMode2</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Test"</span>, <span class="st">"Train"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">post_samples</span> <span class="op">&lt;-</span> <span class="va">post_samples</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">num_samples</span>, <span class="fu">.</span><span class="op">(</span><span class="va">c</span>, <span class="va">lr</span>, <span class="va">mean_error</span>, rank <span class="op">=</span> <span class="va">.I</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">simulated_data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">params</span> <span class="op">&lt;-</span> <span class="va">post_samples</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu">simulation_function</span><span class="op">(</span><span class="va">sbj_data</span>, <span class="va">params</span><span class="op">$</span><span class="va">c</span>, <span class="va">params</span><span class="op">$</span><span class="va">lr</span>, input_layer <span class="op">=</span> <span class="va">input_layer</span>, </span>
<span>                                    output_layer <span class="op">=</span> <span class="va">output_layer</span>, return_dat <span class="op">=</span> <span class="va">return_dat</span><span class="op">)</span></span>
<span>    <span class="va">sim_data_dt</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>id <span class="op">=</span> <span class="va">sbj_data</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, condit <span class="op">=</span> <span class="va">sbj_data</span><span class="op">$</span><span class="va">condit</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                              expMode2 <span class="op">=</span> <span class="va">target_data</span><span class="op">$</span><span class="va">expMode2</span>, Model <span class="op">=</span> <span class="va">Model</span>,tr<span class="op">=</span><span class="va">target_data</span><span class="op">$</span><span class="va">tr</span>,</span>
<span>                              y <span class="op">=</span> <span class="va">target_data</span><span class="op">$</span><span class="va">y</span>, x <span class="op">=</span> <span class="va">target_data</span><span class="op">$</span><span class="va">x</span>, c <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">c</span>, </span>
<span>                              lr <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">lr</span>, mean_error <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">mean_error</span>, rank <span class="op">=</span> <span class="va">i</span>,</span>
<span>                              pred <span class="op">=</span> <span class="va">sim_data</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">sim_data_dt</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">result_dt</span> <span class="op">&lt;-</span> <span class="fu">rbindlist</span><span class="op">(</span><span class="va">simulated_data_list</span><span class="op">)</span></span>
<span>  <span class="fu">setcolorder</span><span class="op">(</span><span class="va">result_dt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"condit"</span>, <span class="st">"expMode2"</span>,<span class="st">"tr"</span>, <span class="st">"c"</span>, <span class="st">"lr"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"pred"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">result_dt</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nestSbjModelFit</span> <span class="op">&lt;-</span> <span class="va">ind_fits_df</span> <span class="op">%&gt;%</span> <span class="fu">nest</span><span class="op">(</span>.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">id</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># organize test data predictions</span></span>
<span><span class="va">post_dat</span> <span class="op">&lt;-</span> <span class="va">nestSbjModelFit</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>pp<span class="op">=</span><span class="fu">furrr</span><span class="fu">::</span><span class="fu"><a href="https://furrr.futureverse.org/reference/future_map2.html">future_pmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">id</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span>,<span class="va">data</span><span class="op">)</span>, <span class="op">~</span><span class="op">{</span></span>
<span>   <span class="fu">generate_data</span><span class="op">(</span><span class="va">..2</span>, <span class="va">..4</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>id<span class="op">=</span><span class="va">..1</span><span class="op">)</span>, <span class="va">ds</span>, num_samples <span class="op">=</span> <span class="fl">20</span>, return_dat<span class="op">=</span><span class="st">"test_data"</span><span class="op">)</span></span>
<span>   <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">Fit_Method</span>,<span class="va">pp</span>,<span class="op">-</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">pp</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">expMode2</span><span class="op">==</span><span class="st">"Test"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_dat_avg</span> <span class="op">&lt;-</span> <span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span>, <span class="va">x</span>, <span class="va">c</span>, <span class="va">lr</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>, error <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">pred</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">post_dat_avg2</span> <span class="op">&lt;-</span> <span class="va">post_dat_avg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span>, <span class="va">c</span>, <span class="va">lr</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>, error <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">pred</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">rank</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_id</span> <span class="op">&lt;-</span> <span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">rank</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">slice_head</span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">Model</span>,<span class="va">c</span>,<span class="va">lr</span>,<span class="va">mean_error</span>,<span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">id_n</span>,by<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"condit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute BIC for each row of map_id; p=2 for c and lr</span></span>
<span><span class="va">map_id</span> <span class="op">&lt;-</span> <span class="va">map_id</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">fifelse</span><span class="op">(</span><span class="va">Fit_Method</span> <span class="op">==</span> <span class="st">"Test"</span>, <span class="va">nTest</span>, <span class="fu">fifelse</span><span class="op">(</span><span class="va">Fit_Method</span> <span class="op">==</span> <span class="st">"Train"</span>, <span class="va">nTrain</span>, <span class="va">nTotal</span><span class="op">)</span><span class="op">)</span>,BIC <span class="op">=</span> <span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bic_id</span> <span class="op">&lt;-</span> <span class="va">map_id</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">Fit_Method</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Model</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>BIC_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">BIC</span><span class="op">)</span>,</span>
<span>            .groups <span class="op">=</span> <span class="st">'drop'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">map_id</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"Fit_Method"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">Fit_Method</span>, <span class="va">Model</span>, <span class="va">BIC</span>, <span class="va">BIC_diff</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu">setorder</span><span class="op">(</span><span class="va">post_dat_avg</span>, <span class="va">id</span>, <span class="va">x</span>, <span class="va">rank</span><span class="op">)</span></span>
<span><span class="va">post_dat_l</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">post_dat_avg</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"condit"</span>, <span class="st">"Model"</span>, <span class="st">"Fit_Method"</span>, <span class="st">"x"</span>, <span class="st">"c"</span>, <span class="st">"lr"</span>, <span class="st">"rank"</span>,<span class="st">"error"</span><span class="op">)</span>,</span>
<span>                   measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pred"</span>, <span class="st">"y"</span><span class="op">)</span>, variable.name <span class="op">=</span> <span class="st">"Resp"</span>, value.name <span class="op">=</span> <span class="st">"val"</span><span class="op">)</span></span>
<span><span class="va">post_dat_l</span><span class="op">[</span>, <span class="va">Resp</span> <span class="op">:=</span> <span class="fu">fifelse</span><span class="op">(</span><span class="va">Resp</span> <span class="op">==</span> <span class="st">"y"</span>, <span class="st">"Observed"</span>,</span>
<span>                             <span class="fu">fifelse</span><span class="op">(</span><span class="va">Model</span> <span class="op">==</span> <span class="st">"ALM"</span>, <span class="st">"ALM"</span>, <span class="st">"EXAM"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">setorder</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">id</span>, <span class="va">Resp</span><span class="op">)</span></span>
<span><span class="co">#rm(post_dat_avg)</span></span>
<span></span>
<span></span>
<span><span class="co"># organize training data predictions</span></span>
<span><span class="va">pd_train</span> <span class="op">&lt;-</span> <span class="va">nestSbjModelFit</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>pp<span class="op">=</span><span class="fu">furrr</span><span class="fu">::</span><span class="fu"><a href="https://furrr.futureverse.org/reference/future_map2.html">future_pmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">id</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span>,<span class="va">data</span><span class="op">)</span>, <span class="op">~</span><span class="op">{</span></span>
<span>   <span class="fu">generate_data</span><span class="op">(</span><span class="va">..2</span>, <span class="va">..4</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>id<span class="op">=</span><span class="va">..1</span><span class="op">)</span>, <span class="va">ds</span>, num_samples <span class="op">=</span> <span class="fl">20</span>, return_dat<span class="op">=</span><span class="st">"train_data"</span><span class="op">)</span></span>
<span>   <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">Fit_Method</span>,<span class="va">pp</span>,<span class="op">-</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">pp</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">expMode2</span><span class="op">==</span><span class="st">"Train"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nbins</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">pd_train</span> <span class="op">&lt;-</span> <span class="va">pd_train</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Block<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">tr</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">tr</span><span class="op">)</span>, length.out<span class="op">=</span><span class="va">nbins</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,include.lowest<span class="op">=</span><span class="cn">TRUE</span>,labels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">setorder</span><span class="op">(</span><span class="va">pd_train</span>, <span class="va">id</span>, <span class="va">x</span>,<span class="va">Block</span>, <span class="va">rank</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pd_train_l</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">pd_train</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"condit"</span>, <span class="st">"Model"</span>,<span class="st">"Block"</span>, <span class="st">"Fit_Method"</span>, <span class="st">"x"</span>, <span class="st">"c"</span>, <span class="st">"lr"</span>, <span class="st">"rank"</span><span class="op">)</span>,</span>
<span>                   measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pred"</span>, <span class="st">"y"</span><span class="op">)</span>, variable.name <span class="op">=</span> <span class="st">"Resp"</span>, value.name <span class="op">=</span> <span class="st">"val"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pd_train_l</span><span class="op">[</span>, <span class="va">Resp</span> <span class="op">:=</span> <span class="fu">fifelse</span><span class="op">(</span><span class="va">Resp</span> <span class="op">==</span> <span class="st">"y"</span>, <span class="st">"Observed"</span>,</span>
<span>                             <span class="fu">fifelse</span><span class="op">(</span><span class="va">Model</span> <span class="op">==</span> <span class="st">"ALM"</span>, <span class="st">"ALM"</span>, <span class="st">"EXAM"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> </span>
<span><span class="fu">setorder</span><span class="op">(</span><span class="va">pd_train_l</span>, <span class="va">id</span>,<span class="va">Block</span>, <span class="va">Resp</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">pd_train_l</span> <span class="op">&lt;-</span> <span class="va">pd_train_l</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>dist <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">val</span> <span class="op">&gt;=</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">val</span> <span class="op">&lt;=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">200</span> <span class="op">~</span> <span class="fl">0</span>,                 </span>
<span>    <span class="va">val</span> <span class="op">&lt;</span> <span class="va">x</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">val</span><span class="op">)</span>,                       </span>
<span>    <span class="va">val</span> <span class="op">&gt;</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">200</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">val</span> <span class="op">-</span> <span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span>,           </span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span>                                 </span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># theta_map &lt;- post_dat_avg |&gt; group_by(condit,Model,Fit_Method) |&gt; summarize(c=median(c),lr=median(lr))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># map &lt;- simulation_function(sbj_data &lt;- ds |&gt; theta_map$c[1], , params$lr, input_layer = input_layer, </span></span>
<span><span class="co">#                                     output_layer = output_layer, return_dat = return_dat)</span></span>
<span></span>
<span><span class="co"># AIC and BIC</span></span>
<span><span class="co"># mc2 &lt;- post_dat |&gt; filter(rank==1) |&gt;</span></span>
<span><span class="co">#   group_by(id,condit,Model,Fit_Method) |&gt;</span></span>
<span><span class="co">#   mutate(e2=abs(y-pred),n=n(),k=2) |&gt;</span></span>
<span><span class="co">#   group_by(id,condit,Model,Fit_Method,x) |&gt;</span></span>
<span><span class="co">#   summarise(y=mean(y), pred=mean(pred), e2=mean(e2), mean_error=first(mean_error),n=first(n),k=first(k)) |&gt;</span></span>
<span><span class="co">#   group_by(id,condit,Model,Fit_Method) |&gt;</span></span>
<span><span class="co">#   summarise(e2=mean(e2), mean_error=first(mean_error),n=first(n),k=first(k)) |&gt;</span></span>
<span><span class="co">#   mutate(AIC=2*k+n*mean_error, BIC=log(n)*k+n*mean_error)</span></span>
<span></span>
<span><span class="co"># Single run extraction:</span></span>
<span><span class="co"># exam_test &lt;- ind_fits_df |&gt; filter(Model == "EXAM", Fit_Method == "Test")</span></span>
<span><span class="co"># post_dat_trial &lt;- exam_test %&gt;% split(f =c(.$id), drop=TRUE) |&gt; </span></span>
<span><span class="co">#   map(~generate_data(.x$Model, .x, ds, num_samples = 15, return_dat="train_data, test_data")) |&gt; </span></span>
<span><span class="co">#   rbindlist() |&gt; </span></span>
<span><span class="co">#   filter(expMode2=="Test")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># post_dat_avg &lt;- post_dat_trial |&gt; group_by(id,condit,x,c,lr,rank) |&gt; </span></span>
<span><span class="co">#   summarise(y = mean(y),pred = mean(pred)) |&gt; arrange(id,x,rank)</span></span>
<span></span>
<span><span class="co">#post_dat_l |&gt; filter(Model == "EXAM", Fit_Method == "Test",id==1) |&gt; arrange(rank)</span></span>
<span><span class="co"># head(post_dat_l)</span></span>
<span></span>
<span></span>
<span><span class="va">bestTestEXAM</span> <span class="op">&lt;-</span> <span class="va">post_dat_l</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span>, <span class="va">rank</span><span class="op">==</span><span class="fl">1</span>, <span class="va">Resp</span><span class="op">==</span><span class="st">"EXAM"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mae<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>group_rank <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bestTestALM</span><span class="op">&lt;-</span> <span class="va">post_dat_l</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span>, <span class="va">rank</span><span class="op">==</span><span class="fl">1</span>, <span class="va">Resp</span><span class="op">==</span><span class="st">"ALM"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mae<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>group_rank <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bestTrainALM</span><span class="op">&lt;-</span> <span class="va">post_dat_l</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Train"</span>, <span class="va">rank</span><span class="op">==</span><span class="fl">1</span>, <span class="va">Resp</span><span class="op">==</span><span class="st">"ALM"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mae<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>group_rank <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bestTrainEXAM</span><span class="op">&lt;-</span> <span class="va">post_dat_l</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Train"</span>, <span class="va">rank</span><span class="op">==</span><span class="fl">1</span>, <span class="va">Resp</span><span class="op">==</span><span class="st">"EXAM"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mae<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>group_rank <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bestTtEXAM</span> <span class="op">&lt;-</span> <span class="va">post_dat_l</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span>, <span class="va">rank</span><span class="op">==</span><span class="fl">1</span>, <span class="va">Resp</span><span class="op">==</span><span class="st">"EXAM"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mae<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>group_rank <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="section" class="level4"><h4 class="anchored" data-anchor-id="section"></h4>
</section><section id="posterior-average-table" class="level2"><h2 class="anchored" data-anchor-id="posterior-average-table">Posterior Average Table</h2>
<div id="tbl-anonymous-2089966" class="cell anchored">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># post_tabs &lt;- abc_tables(post_dat_l)</span></span>
<span><span class="co"># post_tabs$et_sum |&gt; gt::gt()</span></span>
<span></span>
<span><span class="va">post_tabs</span> <span class="op">&lt;-</span> <span class="fu">abc_tables</span><span class="op">(</span><span class="va">post_dat</span>,<span class="va">post_dat_l</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tables with fit error</span></span>
<span><span class="co"># post_tabs$agg_full |&gt; flextable::tabulator(rows=c("Fit_Method","Model"), columns=c("condit"), </span></span>
<span><span class="co">#                        `ME` = as_paragraph(mean_error)) |&gt; as_flextable() |&gt;</span></span>
<span><span class="co">#   set_caption("Mean from full_posterior") </span></span>
<span></span>
<span><span class="co"># post_tabs$agg_best |&gt; flextable::tabulator(rows=c("Fit_Method","Model"), columns=c("condit"), </span></span>
<span><span class="co">#                        `ME` = as_paragraph(mean_error)) |&gt; as_flextable() |&gt;</span></span>
<span><span class="co">#   set_caption("Mean from best parameters") </span></span>
<span></span>
<span><span class="va">post_tabs</span><span class="op">$</span><span class="va">agg_pred_full</span> <span class="op">|&gt;</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Model"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condit"</span><span class="op">)</span>, </span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full_posterior"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-6eeb5dc6{}.cl-6ee8342a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6ee989ce{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ee989d8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6ee989d9{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ee989ec{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ee989f6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6ee989f7{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ee993b0{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993b1{width:0.697in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993ba{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993bb{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993bc{width:0.706in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993bd{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993c4{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993c5{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993ce{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993d8{width:0.706in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993d9{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993e2{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993e3{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993ec{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993f6{width:0.706in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993f7{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee993f8{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee99400{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee99401{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee99402{width:0.706in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee9940a{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee99414{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ee99415{width:0.706in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6eeb5dc6">
<caption>
<p>Full Posterior</p> {#tbl-anonymous-2089966-1}</caption>
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-6ee993b0"><p class="cl-6ee989ce"><span class="cl-6ee8342a">Fit_Method</span></p></th>
<th class="cl-6ee993b1"><p class="cl-6ee989ce"><span class="cl-6ee8342a">Model</span></p></th>
<th class="cl-6ee993ba"><p class="cl-6ee989d8"><span class="cl-6ee8342a"></span></p></th>
<th class="cl-6ee993bb"><p class="cl-6ee989d9"><span class="cl-6ee8342a">Constant</span></p></th>
<th class="cl-6ee993ba"><p class="cl-6ee989d8"><span class="cl-6ee8342a"></span></p></th>
<th class="cl-6ee993bc"><p class="cl-6ee989d9"><span class="cl-6ee8342a">Varied</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6ee993bd"><p class="cl-6ee989ec"><span class="cl-6ee8342a">Test</span></p></td>
<td class="cl-6ee993c4"><p class="cl-6ee989ec"><span class="cl-6ee8342a">ALM</span></p></td>
<td class="cl-6ee993c5"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee993ce"><p class="cl-6ee989f7"><span class="cl-6ee8342a">275.4</span></p></td>
<td class="cl-6ee993c5"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee993d8"><p class="cl-6ee989f7"><span class="cl-6ee8342a">226.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ee993c4"><p class="cl-6ee989ec"><span class="cl-6ee8342a">EXAM</span></p></td>
<td class="cl-6ee993c5"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee993ce"><p class="cl-6ee989f7"><span class="cl-6ee8342a">214.6</span></p></td>
<td class="cl-6ee993c5"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee993d8"><p class="cl-6ee989f7"><span class="cl-6ee8342a">212.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6ee993d9"><p class="cl-6ee989ec"><span class="cl-6ee8342a">Test_Train</span></p></td>
<td class="cl-6ee993e2"><p class="cl-6ee989ec"><span class="cl-6ee8342a">ALM</span></p></td>
<td class="cl-6ee993e3"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee993ec"><p class="cl-6ee989f7"><span class="cl-6ee8342a">286.4</span></p></td>
<td class="cl-6ee993e3"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee993f6"><p class="cl-6ee989f7"><span class="cl-6ee8342a">265.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ee993e2"><p class="cl-6ee989ec"><span class="cl-6ee8342a">EXAM</span></p></td>
<td class="cl-6ee993e3"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee993ec"><p class="cl-6ee989f7"><span class="cl-6ee8342a">227.5</span></p></td>
<td class="cl-6ee993e3"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee993f6"><p class="cl-6ee989f7"><span class="cl-6ee8342a">246.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6ee993f7"><p class="cl-6ee989ec"><span class="cl-6ee8342a">Train</span></p></td>
<td class="cl-6ee993f8"><p class="cl-6ee989ec"><span class="cl-6ee8342a">ALM</span></p></td>
<td class="cl-6ee99400"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee99401"><p class="cl-6ee989f7"><span class="cl-6ee8342a">530.6</span></p></td>
<td class="cl-6ee99400"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee99402"><p class="cl-6ee989f7"><span class="cl-6ee8342a">365.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ee9940a"><p class="cl-6ee989ec"><span class="cl-6ee8342a">EXAM</span></p></td>
<td class="cl-6ee99400"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee99414"><p class="cl-6ee989f7"><span class="cl-6ee8342a">339.1</span></p></td>
<td class="cl-6ee99400"><p class="cl-6ee989f6"><span class="cl-6ee8342a"></span></p></td>
<td class="cl-6ee99415"><p class="cl-6ee989f7"><span class="cl-6ee8342a">370.7</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_tabs</span><span class="op">$</span><span class="va">agg_pred_best</span> <span class="op">|&gt;</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Model"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condit"</span><span class="op">)</span>, </span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full_posterior"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-6ef91d94{}.cl-6ef61d10{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6ef759dc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ef759dd{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6ef759e6{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ef759f0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ef759f1{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6ef759fa{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ef7624c{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef7624d{width:0.697in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef7624e{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76256{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76260{width:0.706in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76261{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef7626a{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef7626b{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76274{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76275{width:0.706in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef7627e{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76288{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76289{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76292{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76293{width:0.706in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef76294{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef7629c{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef762a6{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef762a7{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef762a8{width:0.706in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef762b0{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef762b1{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ef762ba{width:0.706in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6ef91d94">
<caption>
<p>Best Posterior</p> {#tbl-anonymous-2089966-2}</caption>
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-6ef7624c"><p class="cl-6ef759dc"><span class="cl-6ef61d10">Fit_Method</span></p></th>
<th class="cl-6ef7624d"><p class="cl-6ef759dc"><span class="cl-6ef61d10">Model</span></p></th>
<th class="cl-6ef7624e"><p class="cl-6ef759dd"><span class="cl-6ef61d10"></span></p></th>
<th class="cl-6ef76256"><p class="cl-6ef759e6"><span class="cl-6ef61d10">Constant</span></p></th>
<th class="cl-6ef7624e"><p class="cl-6ef759dd"><span class="cl-6ef61d10"></span></p></th>
<th class="cl-6ef76260"><p class="cl-6ef759e6"><span class="cl-6ef61d10">Varied</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6ef76261"><p class="cl-6ef759f0"><span class="cl-6ef61d10">Test</span></p></td>
<td class="cl-6ef7626a"><p class="cl-6ef759f0"><span class="cl-6ef61d10">ALM</span></p></td>
<td class="cl-6ef7626b"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef76274"><p class="cl-6ef759fa"><span class="cl-6ef61d10">273.8</span></p></td>
<td class="cl-6ef7626b"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef76275"><p class="cl-6ef759fa"><span class="cl-6ef61d10">219.3</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ef7626a"><p class="cl-6ef759f0"><span class="cl-6ef61d10">EXAM</span></p></td>
<td class="cl-6ef7626b"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef76274"><p class="cl-6ef759fa"><span class="cl-6ef61d10">213.3</span></p></td>
<td class="cl-6ef7626b"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef76275"><p class="cl-6ef759fa"><span class="cl-6ef61d10">208.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6ef7627e"><p class="cl-6ef759f0"><span class="cl-6ef61d10">Test_Train</span></p></td>
<td class="cl-6ef76288"><p class="cl-6ef759f0"><span class="cl-6ef61d10">ALM</span></p></td>
<td class="cl-6ef76289"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef76292"><p class="cl-6ef759fa"><span class="cl-6ef61d10">285.1</span></p></td>
<td class="cl-6ef76289"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef76293"><p class="cl-6ef759fa"><span class="cl-6ef61d10">260.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ef76288"><p class="cl-6ef759f0"><span class="cl-6ef61d10">EXAM</span></p></td>
<td class="cl-6ef76289"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef76292"><p class="cl-6ef759fa"><span class="cl-6ef61d10">226.9</span></p></td>
<td class="cl-6ef76289"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef76293"><p class="cl-6ef759fa"><span class="cl-6ef61d10">240.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6ef76294"><p class="cl-6ef759f0"><span class="cl-6ef61d10">Train</span></p></td>
<td class="cl-6ef7629c"><p class="cl-6ef759f0"><span class="cl-6ef61d10">ALM</span></p></td>
<td class="cl-6ef762a6"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef762a7"><p class="cl-6ef759fa"><span class="cl-6ef61d10">517.0</span></p></td>
<td class="cl-6ef762a6"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef762a8"><p class="cl-6ef759fa"><span class="cl-6ef61d10">363.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ef762b0"><p class="cl-6ef759f0"><span class="cl-6ef61d10">EXAM</span></p></td>
<td class="cl-6ef762a6"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef762b1"><p class="cl-6ef759fa"><span class="cl-6ef61d10">338.5</span></p></td>
<td class="cl-6ef762a6"><p class="cl-6ef759f1"><span class="cl-6ef61d10"></span></p></td>
<td class="cl-6ef762ba"><p class="cl-6ef759fa"><span class="cl-6ef61d10">356.7</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Posterior Distribution</p>
</div>
</section><section id="interactive-test-predictions-table" class="level2"><h2 class="anchored" data-anchor-id="interactive-test-predictions-table">Interactive Test Predictions Table</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tags</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span></span>
<span>  <span class="va">tags</span><span class="op">$</span><span class="fu">option</span><span class="op">(</span>value <span class="op">=</span> <span class="st">""</span>, <span class="st">"All"</span><span class="op">)</span>,</span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">post_tabs</span><span class="op">$</span><span class="va">agg_x_full</span><span class="op">$</span><span class="va">condit</span><span class="op">)</span>, <span class="va">tags</span><span class="op">$</span><span class="va">option</span><span class="op">)</span>,</span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">post_tabs</span><span class="op">$</span><span class="va">agg_x_full</span><span class="op">$</span><span class="va">Model</span><span class="op">)</span>, <span class="va">tags</span><span class="op">$</span><span class="va">option</span><span class="op">)</span>,</span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">post_tabs</span><span class="op">$</span><span class="va">agg_x_full</span><span class="op">$</span><span class="va">Fit_Method</span><span class="op">)</span>, <span class="va">tags</span><span class="op">$</span><span class="va">option</span><span class="op">)</span>,</span>
<span>   <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">post_tabs</span><span class="op">$</span><span class="va">agg_x_full</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, <span class="va">tags</span><span class="op">$</span><span class="va">option</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display no-overflow-x">
<select><option value="">All</option>
<option>Constant</option>
<option>Varied</option>
<option>ALM</option>
<option>EXAM</option>
<option>Test</option>
<option>Test_Train</option>
<option>Train</option>
<option>100</option>
<option>350</option>
<option>600</option>
<option>800</option>
<option>1000</option>
<option>1200</option></select>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selectFilter</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tableId</span>, <span class="va">style</span> <span class="op">=</span> <span class="st">"width: 100%; height: 100%;"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">values</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tags</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span></span>
<span>      <span class="co"># Set to undefined to clear the filter</span></span>
<span>      onchange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">        const value = event.target.value</span></span>
<span><span class="st">        Reactable.setFilter('%s', '%s', value === '__ALL__' ? undefined : value)</span></span>
<span><span class="st">      "</span>, <span class="va">tableId</span>, <span class="va">name</span><span class="op">)</span>,</span>
<span>      <span class="co"># "All" has a special value to clear the filter, and is the default option</span></span>
<span>      <span class="va">tags</span><span class="op">$</span><span class="fu">option</span><span class="op">(</span>value <span class="op">=</span> <span class="st">"__ALL__"</span>, <span class="st">"All"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>, <span class="va">tags</span><span class="op">$</span><span class="va">option</span><span class="op">)</span>,</span>
<span>      <span class="st">"aria-label"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Filter %s"</span>, <span class="va">name</span><span class="op">)</span>,</span>
<span>      style <span class="op">=</span> <span class="va">style</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">post_tabs</span><span class="op">$</span><span class="va">agg_x_full</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">post_tabs</span><span class="op">$</span><span class="va">agg_x_best</span> <span class="op">|&gt;</span> <span class="fu">rename</span><span class="op">(</span><span class="st">"best_error"</span><span class="op">=</span><span class="va">mean_error</span>,<span class="st">"best_pred"</span><span class="op">=</span><span class="va">pred</span><span class="op">)</span>, </span>
<span>            by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condit"</span>,<span class="st">"Model"</span>,<span class="st">"Fit_Method"</span>,<span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">condit</span><span class="op">)</span>,<span class="va">x</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">reactable</span><span class="fu">::</span><span class="fu"><a href="https://glin.github.io/reactable/reference/reactable.html">reactable</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>condit<span class="op">=</span><span class="fu">colDef</span><span class="op">(</span>name<span class="op">=</span><span class="st">"Condit"</span>,filterInput<span class="op">=</span><span class="fu">selectFilter</span><span class="op">(</span><span class="st">"my-tbl"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   Model<span class="op">=</span><span class="fu">colDef</span><span class="op">(</span>name<span class="op">=</span><span class="st">"Model"</span>,filterInput<span class="op">=</span><span class="fu">selectFilter</span><span class="op">(</span><span class="st">"my-tbl"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   Fit_Method<span class="op">=</span><span class="fu">colDef</span><span class="op">(</span>name<span class="op">=</span><span class="st">"Fit_Method"</span>,filterInput<span class="op">=</span><span class="fu">selectFilter</span><span class="op">(</span><span class="st">"my-tbl"</span><span class="op">)</span>,</span>
<span>                                     filterMethod <span class="op">=</span> <span class="fu">JS</span><span class="op">(</span><span class="st">"(rows, columnId, filterValue) =&gt; {</span></span>
<span><span class="st">        return rows.filter(row =&gt; row.values[columnId] === filterValue)</span></span>
<span><span class="st">      }"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      x<span class="op">=</span><span class="fu">colDef</span><span class="op">(</span>name<span class="op">=</span><span class="st">"x"</span>,filterInput<span class="op">=</span><span class="fu">selectFilter</span><span class="op">(</span><span class="st">"my-tbl"</span><span class="op">)</span>,</span>
<span>               filterMethod <span class="op">=</span> <span class="fu">JS</span><span class="op">(</span><span class="st">"(rows, columnId, filterValue) =&gt; {</span></span>
<span><span class="st">        return rows.filter(row =&gt; row.values[columnId] === filterValue)</span></span>
<span><span class="st">      }"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    elementId <span class="op">=</span> <span class="st">"my-tbl"</span>,</span>
<span>    defaultPageSize<span class="op">=</span><span class="fl">15</span>,</span>
<span>    filterable<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="my-tbl" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="my-tbl">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"condit":["Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Varied","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant","Constant"],"Model":["ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM","ALM","EXAM"],"Fit_Method":["Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train","Test","Test","Test_Train","Test_Train","Train","Train"],"x":["100","100","100","100","100","100","350","350","350","350","350","350","600","600","600","600","600","600","800","800","800","800","800","800","1000","1000","1000","1000","1000","1000","1200","1200","1200","1200","1200","1200","100","100","100","100","100","100","350","350","350","350","350","350","600","600","600","600","600","600","800","800","800","800","800","800","1000","1000","1000","1000","1000","1000","1200","1200","1200","1200","1200","1200"],"y":[664,664,664,664,664,664,767.8,767.8,767.8,767.8,767.8,767.8,876.5,876.5,876.5,876.5,876.5,876.5,1063.9,1063.9,1063.9,1063.9,1063.9,1063.9,1180.4,1180.4,1180.4,1180.4,1180.4,1180.4,1264.7,1264.7,1264.7,1264.7,1264.7,1264.7,524.3,524.3,524.3,524.3,524.3,524.3,658.8,658.8,658.8,658.8,658.8,658.8,770.4,770.4,770.4,770.4,770.4,770.4,1000.5,1000.5,1000.5,1000.5,1000.5,1000.5,1166.6,1166.6,1166.6,1166.6,1166.6,1166.6,1282.5,1282.5,1282.5,1282.5,1282.5,1282.5],"pred":[683.4,634.6,639.1,680.9,869.3,875.3,819.4,770.4,847.6,782.3,979.2,916.2,892.6,910.9,942.8,888,987.7,955.3,982.7,1019.2,967,969.7,996.2,989.1,1143.9,1134.4,1042.8,1059.7,1026.3,1025.9,1206.9,1225.9,1085.1,1087.6,1053.8,1052.7,444.5,443.7,452.5,407.3,376.3,408.3,792.3,630.8,767.7,594.2,476.3,585.5,946.1,821.3,910.6,784.8,571.8,757.3,941.4,967.2,908.1,932.5,895.3,895.6,943,1119.9,908.9,1083.3,560.6,1035.4,949.6,1255.4,919.6,1225.8,491.2,1177.7],"mean_error":[227.9,192.1,233,213.4,494.2,500.9,208.7,192.3,240.4,204.4,392,404.3,218.4,218.6,267.9,226.8,341.3,349,240.2,220.9,268.6,255.5,296.8,299.1,219.1,219.4,271.8,267.5,309.2,309.4,247.1,231.2,311.6,309.7,359.4,361.7,202.2,188.1,193.7,212.2,516.4,423.6,249.4,168.1,242,183.1,473.5,305.6,265.6,199.8,255.9,190.2,440.5,239.3,215.8,213.3,242.5,220.6,261.2,261.8,313.6,244.7,353.4,264,666.7,356.2,405.7,273.7,430.9,294.8,825.5,448.3],"best_pred":[700.2,627.7,652.4,699.6,893.4,853.7,802.4,767.5,842.4,799.5,981.1,905.1,882,911.4,943.3,904.1,989.6,951.5,984.5,1022.3,965.9,984.2,1005.3,989.1,1143.4,1141.2,1060.6,1072.6,1034.8,1033.2,1232.4,1242.8,1089.6,1103.9,1050,1055.3,439.1,446.6,451.1,405.7,410.3,373.9,783.2,632.1,769.2,592.8,496.4,561.6,943.3,821.1,914,783.7,566,744.9,938.5,965.9,911.5,931.3,895.7,893.6,940.5,1117,912.2,1082.2,554,1043,948.2,1251.5,924,1224.8,512.6,1193.2],"best_error":[217.6,190.6,238.2,210.7,480.7,477.3,198.3,189.9,232.3,202.7,401.8,383.1,214.9,218.2,262.4,228.6,345,334,236.3,217.8,266.1,249.5,297.2,291.9,214.4,212.7,259.4,256,302.3,302.1,234,221.4,306.2,297.5,355,351.7,198.8,185.5,189.4,211,483,422.7,246.1,167.5,241.9,182.5,456.9,305.5,263.6,199.8,255.8,189.5,429,237.8,214.6,212.5,241.9,220,262.7,262.7,313.5,244.1,353.2,264.4,667.2,355.3,406,270.1,428.2,293.7,803,447]},"columns":[{"id":"condit","name":"Condit","type":"factor","filterInput":{"name":"select","attribs":{"aria-label":"Filter condit","style":{"width":"100%","height":"100%"},"onChange":"function(_e){(function(event){\n        const value = event.target.value\n        Reactable.setFilter('my-tbl', 'condit', value === '__ALL__' ? undefined : value)\n      }).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":"__ALL__"},"children":["All"]},{"name":"option","attribs":{},"children":["Varied"]},{"name":"option","attribs":{},"children":["Constant"]}]}},{"id":"Model","name":"Model","type":"character","filterInput":{"name":"select","attribs":{"aria-label":"Filter Model","style":{"width":"100%","height":"100%"},"onChange":"function(_e){(function(event){\n        const value = event.target.value\n        Reactable.setFilter('my-tbl', 'Model', value === '__ALL__' ? undefined : value)\n      }).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":"__ALL__"},"children":["All"]},{"name":"option","attribs":{},"children":["ALM"]},{"name":"option","attribs":{},"children":["EXAM"]}]}},{"id":"Fit_Method","name":"Fit_Method","type":"character","filterMethod":"(rows, columnId, filterValue) => {\n        return rows.filter(row => row.values[columnId] === filterValue)\n      }","filterInput":{"name":"select","attribs":{"aria-label":"Filter Fit_Method","style":{"width":"100%","height":"100%"},"onChange":"function(_e){(function(event){\n        const value = event.target.value\n        Reactable.setFilter('my-tbl', 'Fit_Method', value === '__ALL__' ? undefined : value)\n      }).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":"__ALL__"},"children":["All"]},{"name":"option","attribs":{},"children":["Test"]},{"name":"option","attribs":{},"children":["Test_Train"]},{"name":"option","attribs":{},"children":["Train"]}]}},{"id":"x","name":"x","type":"character","filterMethod":"(rows, columnId, filterValue) => {\n        return rows.filter(row => row.values[columnId] === filterValue)\n      }","filterInput":{"name":"select","attribs":{"aria-label":"Filter x","style":{"width":"100%","height":"100%"},"onChange":"function(_e){(function(event){\n        const value = event.target.value\n        Reactable.setFilter('my-tbl', 'x', value === '__ALL__' ? undefined : value)\n      }).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":"__ALL__"},"children":["All"]},{"name":"option","attribs":{},"children":["100"]},{"name":"option","attribs":{},"children":["350"]},{"name":"option","attribs":{},"children":["600"]},{"name":"option","attribs":{},"children":["800"]},{"name":"option","attribs":{},"children":["1000"]},{"name":"option","attribs":{},"children":["1200"]}]}},{"id":"y","name":"y","type":"numeric"},{"id":"pred","name":"pred","type":"numeric"},{"id":"mean_error","name":"mean_error","type":"numeric"},{"id":"best_pred","name":"best_pred","type":"numeric"},{"id":"best_error","name":"best_error","type":"numeric"}],"filterable":true,"defaultPageSize":15,"elementId":"my-tbl","dataKey":"7b32d9c9e44f189288f5e6b8ee1eb838"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.filterInput.attribs.onChange","tag.attribs.columns.1.filterInput.attribs.onChange","tag.attribs.columns.2.filterMethod","tag.attribs.columns.2.filterInput.attribs.onChange","tag.attribs.columns.3.filterMethod","tag.attribs.columns.3.filterInput.attribs.onChange"],"jsHooks":[]}</script>
</div>
</div>
</section><section id="train-predictions" class="level2"><h2 class="anchored" data-anchor-id="train-predictions">Train Predictions</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pt_train</span> <span class="op">&lt;-</span> <span class="fu">abc_train_tables</span><span class="op">(</span><span class="va">pd_train</span>,<span class="va">pd_train_l</span><span class="op">)</span></span>
<span><span class="va">pt_train</span><span class="op">$</span><span class="va">agg_pred_full</span> <span class="op">|&gt;</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Model"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condit"</span><span class="op">)</span>, </span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full_posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-6f8893de{}.cl-6f857528{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6f86bc80{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6f86bc8a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6f86bc94{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6f86bc95{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6f86bc96{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6f86bc9e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6f86c4f0{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c4fa{width:0.697in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c4fb{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c504{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c505{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c50e{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c518{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c522{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c523{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c52c{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c52d{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c536{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c540{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c541{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c54a{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c54b{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c554{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c55e{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c55f{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c568{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c572{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c573{width:0.875in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6f86c57c{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6f8893de">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-6f86c4f0"><p class="cl-6f86bc80"><span class="cl-6f857528">Fit_Method</span></p></th>
<th class="cl-6f86c4fa"><p class="cl-6f86bc80"><span class="cl-6f857528">Model</span></p></th>
<th class="cl-6f86c4fb"><p class="cl-6f86bc8a"><span class="cl-6f857528"></span></p></th>
<th class="cl-6f86c504"><p class="cl-6f86bc94"><span class="cl-6f857528">Constant</span></p></th>
<th class="cl-6f86c4fb"><p class="cl-6f86bc8a"><span class="cl-6f857528"></span></p></th>
<th class="cl-6f86c505"><p class="cl-6f86bc94"><span class="cl-6f857528">Varied</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6f86c50e"><p class="cl-6f86bc95"><span class="cl-6f857528">Test</span></p></td>
<td class="cl-6f86c518"><p class="cl-6f86bc95"><span class="cl-6f857528">ALM</span></p></td>
<td class="cl-6f86c522"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c523"><p class="cl-6f86bc9e"><span class="cl-6f857528">851.2</span></p></td>
<td class="cl-6f86c522"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c52c"><p class="cl-6f86bc9e"><span class="cl-6f857528">3,049.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6f86c518"><p class="cl-6f86bc95"><span class="cl-6f857528">EXAM</span></p></td>
<td class="cl-6f86c522"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c523"><p class="cl-6f86bc9e"><span class="cl-6f857528">711.9</span></p></td>
<td class="cl-6f86c522"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c52c"><p class="cl-6f86bc9e"><span class="cl-6f857528">1,047.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6f86c52d"><p class="cl-6f86bc95"><span class="cl-6f857528">Test_Train</span></p></td>
<td class="cl-6f86c536"><p class="cl-6f86bc95"><span class="cl-6f857528">ALM</span></p></td>
<td class="cl-6f86c540"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c541"><p class="cl-6f86bc9e"><span class="cl-6f857528">229.7</span></p></td>
<td class="cl-6f86c540"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c54a"><p class="cl-6f86bc9e"><span class="cl-6f857528">324.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6f86c536"><p class="cl-6f86bc95"><span class="cl-6f857528">EXAM</span></p></td>
<td class="cl-6f86c540"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c541"><p class="cl-6f86bc9e"><span class="cl-6f857528">233.4</span></p></td>
<td class="cl-6f86c540"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c54a"><p class="cl-6f86bc9e"><span class="cl-6f857528">331.3</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="2" class="cl-6f86c54b"><p class="cl-6f86bc95"><span class="cl-6f857528">Train</span></p></td>
<td class="cl-6f86c554"><p class="cl-6f86bc95"><span class="cl-6f857528">ALM</span></p></td>
<td class="cl-6f86c55e"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c55f"><p class="cl-6f86bc9e"><span class="cl-6f857528">216.1</span></p></td>
<td class="cl-6f86c55e"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c568"><p class="cl-6f86bc9e"><span class="cl-6f857528">301.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6f86c572"><p class="cl-6f86bc95"><span class="cl-6f857528">EXAM</span></p></td>
<td class="cl-6f86c55e"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c573"><p class="cl-6f86bc9e"><span class="cl-6f857528">216.0</span></p></td>
<td class="cl-6f86c55e"><p class="cl-6f86bc96"><span class="cl-6f857528"></span></p></td>
<td class="cl-6f86c57c"><p class="cl-6f86bc9e"><span class="cl-6f857528">302.3</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pt_train</span><span class="op">$</span><span class="va">block_pred_full</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Model"</span>,<span class="st">"Block"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condit"</span><span class="op">)</span>, </span>
<span>                       `Observed` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, </span>
<span>                       `Predicted` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>,</span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full_posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-6fa90182{}.cl-6fa50d3e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6fa68b6e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fa68b78{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fa68b79{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fa68b7a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fa68b82{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fa68b8c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fa68b8d{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fa6962c{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69636{width:0.697in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69640{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6964a{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69654{width:0.926in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6965e{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6965f{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69660{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69668{width:0.697in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69672{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6967c{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6967d{width:0.926in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69686{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69687{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69690{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6969a{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696a4{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696a5{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696ae{width:0.926in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696af{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696b8{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696b9{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696c2{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696c3{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696c4{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696cc{width:0.926in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696cd{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696d6{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696d7{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696e0{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696e1{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696ea{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696eb{width:0.926in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696f4{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696f5{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696fe{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa696ff{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69708{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6971c{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6971d{width:0.926in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69726{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69730{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6973a{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69744{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69745{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6974e{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6974f{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69758{width:0.926in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa69759{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fa6975a{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6fa90182">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-6fa6962c"><p class="cl-6fa68b6e"><span class="cl-6fa50d3e">Fit_Method</span></p></th>
<th rowspan="2" class="cl-6fa69636"><p class="cl-6fa68b6e"><span class="cl-6fa50d3e">Model</span></p></th>
<th rowspan="2" class="cl-6fa69640"><p class="cl-6fa68b6e"><span class="cl-6fa50d3e">Block</span></p></th>
<th class="cl-6fa6964a"><p class="cl-6fa68b78"><span class="cl-6fa50d3e"></span></p></th>
<th colspan="3" class="cl-6fa69654"><p class="cl-6fa68b79"><span class="cl-6fa50d3e">Constant</span></p></th>
<th class="cl-6fa6964a"><p class="cl-6fa68b78"><span class="cl-6fa50d3e"></span></p></th>
<th colspan="3" class="cl-6fa69654"><p class="cl-6fa68b79"><span class="cl-6fa50d3e">Varied</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6fa6967c"><p class="cl-6fa68b7a"><span class="cl-6fa50d3e"></span></p></th>
<th class="cl-6fa6967d"><p class="cl-6fa68b79"><span class="cl-6fa50d3e">Observed</span></p></th>
<th class="cl-6fa69686"><p class="cl-6fa68b79"><span class="cl-6fa50d3e">Predicted</span></p></th>
<th class="cl-6fa69687"><p class="cl-6fa68b79"><span class="cl-6fa50d3e">ME</span></p></th>
<th class="cl-6fa6967c"><p class="cl-6fa68b7a"><span class="cl-6fa50d3e"></span></p></th>
<th class="cl-6fa6967d"><p class="cl-6fa68b79"><span class="cl-6fa50d3e">Observed</span></p></th>
<th class="cl-6fa69686"><p class="cl-6fa68b79"><span class="cl-6fa50d3e">Predicted</span></p></th>
<th class="cl-6fa69687"><p class="cl-6fa68b79"><span class="cl-6fa50d3e">ME</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="6" class="cl-6fa69690"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">Test</span></p></td>
<td rowspan="3" class="cl-6fa6969a"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">ALM</span></p></td>
<td class="cl-6fa696a4"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">1</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">927.4</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">730.3</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">876.2</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,069.0</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">746.6</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,838.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa696a4"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">2</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">922.8</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">484.7</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,001.5</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,091.9</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">-4,869.1</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">7,073.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa696a4"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">3</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">916.5</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,202.4</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">714.1</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,100.8</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">951.3</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,022.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fa6969a"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">EXAM</span></p></td>
<td class="cl-6fa696a4"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">1</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">927.4</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">796.9</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">980.6</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,069.0</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">889.1</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,248.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa696c3"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">2</span></p></td>
<td class="cl-6fa696c4"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696cc"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">922.8</span></p></td>
<td class="cl-6fa696cd"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">895.1</span></p></td>
<td class="cl-6fa696d6"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">720.6</span></p></td>
<td class="cl-6fa696c4"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696cc"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,091.9</span></p></td>
<td class="cl-6fa696cd"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,024.3</span></p></td>
<td class="cl-6fa696d6"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,139.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa696e1"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">3</span></p></td>
<td class="cl-6fa696ea"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696eb"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">916.5</span></p></td>
<td class="cl-6fa696f4"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">918.0</span></p></td>
<td class="cl-6fa696f5"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">442.5</span></p></td>
<td class="cl-6fa696ea"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696eb"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,100.8</span></p></td>
<td class="cl-6fa696f4"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,005.0</span></p></td>
<td class="cl-6fa696f5"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">772.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="6" class="cl-6fa69690"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">Test_Train</span></p></td>
<td rowspan="3" class="cl-6fa6969a"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">ALM</span></p></td>
<td class="cl-6fa696a4"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">1</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">927.4</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">820.4</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">294.8</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,069.0</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">872.4</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">393.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa69708"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">2</span></p></td>
<td class="cl-6fa6971c"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa6971d"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">922.8</span></p></td>
<td class="cl-6fa69726"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">885.6</span></p></td>
<td class="cl-6fa69730"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">202.9</span></p></td>
<td class="cl-6fa6971c"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa6971d"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,091.9</span></p></td>
<td class="cl-6fa69726"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">980.9</span></p></td>
<td class="cl-6fa69730"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">307.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa696e1"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">3</span></p></td>
<td class="cl-6fa696ea"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696eb"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">916.5</span></p></td>
<td class="cl-6fa696f4"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">886.9</span></p></td>
<td class="cl-6fa696f5"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">191.9</span></p></td>
<td class="cl-6fa696ea"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696eb"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,100.8</span></p></td>
<td class="cl-6fa696f4"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,008.5</span></p></td>
<td class="cl-6fa696f5"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">277.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fa6969a"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">EXAM</span></p></td>
<td class="cl-6fa696a4"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">1</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">927.4</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">832.4</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">296.8</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,069.0</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">864.5</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">411.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa69708"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">2</span></p></td>
<td class="cl-6fa6971c"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa6971d"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">922.8</span></p></td>
<td class="cl-6fa69726"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">902.8</span></p></td>
<td class="cl-6fa69730"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">205.8</span></p></td>
<td class="cl-6fa6971c"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa6971d"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,091.9</span></p></td>
<td class="cl-6fa69726"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">989.2</span></p></td>
<td class="cl-6fa69730"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">309.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa696c3"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">3</span></p></td>
<td class="cl-6fa696c4"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696cc"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">916.5</span></p></td>
<td class="cl-6fa696cd"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">902.2</span></p></td>
<td class="cl-6fa696d6"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">198.3</span></p></td>
<td class="cl-6fa696c4"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696cc"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,100.8</span></p></td>
<td class="cl-6fa696cd"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,020.4</span></p></td>
<td class="cl-6fa696d6"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">277.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="6" class="cl-6fa6973a"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">Train</span></p></td>
<td rowspan="3" class="cl-6fa6969a"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">ALM</span></p></td>
<td class="cl-6fa696a4"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">1</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">927.4</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">830.6</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">272.3</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,069.0</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">921.7</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">355.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa69708"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">2</span></p></td>
<td class="cl-6fa6971c"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa6971d"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">922.8</span></p></td>
<td class="cl-6fa69726"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">889.9</span></p></td>
<td class="cl-6fa69730"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">193.6</span></p></td>
<td class="cl-6fa6971c"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa6971d"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,091.9</span></p></td>
<td class="cl-6fa69726"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,005.0</span></p></td>
<td class="cl-6fa69730"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">289.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa696c3"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">3</span></p></td>
<td class="cl-6fa696c4"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696cc"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">916.5</span></p></td>
<td class="cl-6fa696cd"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">890.3</span></p></td>
<td class="cl-6fa696d6"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">183.0</span></p></td>
<td class="cl-6fa696c4"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696cc"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,100.8</span></p></td>
<td class="cl-6fa696cd"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,022.5</span></p></td>
<td class="cl-6fa696d6"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">265.3</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fa69744"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">EXAM</span></p></td>
<td class="cl-6fa696a4"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">1</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">927.4</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">831.4</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">272.1</span></p></td>
<td class="cl-6fa696a5"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696ae"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,069.0</span></p></td>
<td class="cl-6fa696af"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">916.3</span></p></td>
<td class="cl-6fa696b8"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">355.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa696e1"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">2</span></p></td>
<td class="cl-6fa696ea"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696eb"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">922.8</span></p></td>
<td class="cl-6fa696f4"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">890.3</span></p></td>
<td class="cl-6fa696f5"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">193.4</span></p></td>
<td class="cl-6fa696ea"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa696eb"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,091.9</span></p></td>
<td class="cl-6fa696f4"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,001.8</span></p></td>
<td class="cl-6fa696f5"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">289.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fa6974f"><p class="cl-6fa68b82"><span class="cl-6fa50d3e">3</span></p></td>
<td class="cl-6fa696c4"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa69758"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">916.5</span></p></td>
<td class="cl-6fa69759"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">890.0</span></p></td>
<td class="cl-6fa6975a"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">183.1</span></p></td>
<td class="cl-6fa696c4"><p class="cl-6fa68b8c"><span class="cl-6fa50d3e"></span></p></td>
<td class="cl-6fa69758"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,100.8</span></p></td>
<td class="cl-6fa69759"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">1,020.8</span></p></td>
<td class="cl-6fa6975a"><p class="cl-6fa68b8d"><span class="cl-6fa50d3e">266.1</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pt_train</span><span class="op">$</span><span class="va">block_pred_full</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">condit</span><span class="op">==</span><span class="st">"Varied"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Block"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span>, </span>
<span>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span>                       `Predicted` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>,</span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full_posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-6fbfca34{}.cl-6fbbdae6{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6fbd7824{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fbd782e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fbd782f{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fbd7830{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fbd7842{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fbd7843{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fbd784c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fbd82ce{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82cf{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82d0{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82d8{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82d9{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82e2{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82ec{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82ed{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82f6{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd82f7{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8300{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8301{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd830a{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8314{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8315{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8316{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd831e{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8328{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8329{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8332{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8333{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8334{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd833c{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd833d{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd833e{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8346{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8350{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd835a{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd835b{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd835c{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8364{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8365{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8378{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8379{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8382{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8383{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd838c{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8396{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fbd8397{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6fbfca34">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-6fbd82ce"><p class="cl-6fbd7824"><span class="cl-6fbbdae6">Fit_Method</span></p></th>
<th rowspan="2" class="cl-6fbd82cf"><p class="cl-6fbd7824"><span class="cl-6fbbdae6">Block</span></p></th>
<th class="cl-6fbd82d0"><p class="cl-6fbd782e"><span class="cl-6fbbdae6"></span></p></th>
<th colspan="2" class="cl-6fbd82d8"><p class="cl-6fbd782f"><span class="cl-6fbbdae6">ALM</span></p></th>
<th class="cl-6fbd82d0"><p class="cl-6fbd782e"><span class="cl-6fbbdae6"></span></p></th>
<th colspan="2" class="cl-6fbd82d8"><p class="cl-6fbd782f"><span class="cl-6fbbdae6">EXAM</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6fbd82ed"><p class="cl-6fbd7830"><span class="cl-6fbbdae6"></span></p></th>
<th class="cl-6fbd82f6"><p class="cl-6fbd782f"><span class="cl-6fbbdae6">Predicted</span></p></th>
<th class="cl-6fbd82f7"><p class="cl-6fbd782f"><span class="cl-6fbbdae6">ME</span></p></th>
<th class="cl-6fbd82ed"><p class="cl-6fbd7830"><span class="cl-6fbbdae6"></span></p></th>
<th class="cl-6fbd82f6"><p class="cl-6fbd782f"><span class="cl-6fbbdae6">Predicted</span></p></th>
<th class="cl-6fbd82f7"><p class="cl-6fbd782f"><span class="cl-6fbbdae6">ME</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fbd8300"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">Test</span></p></td>
<td class="cl-6fbd8301"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">1</span></p></td>
<td class="cl-6fbd830a"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8314"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">746.6</span></p></td>
<td class="cl-6fbd8315"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,838.5</span></p></td>
<td class="cl-6fbd830a"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8314"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">889.1</span></p></td>
<td class="cl-6fbd8315"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,248.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fbd8301"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">2</span></p></td>
<td class="cl-6fbd830a"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8314"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">-4,869.1</span></p></td>
<td class="cl-6fbd8315"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">7,073.9</span></p></td>
<td class="cl-6fbd830a"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8314"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,024.3</span></p></td>
<td class="cl-6fbd8315"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,139.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fbd8301"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">3</span></p></td>
<td class="cl-6fbd830a"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8314"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">951.3</span></p></td>
<td class="cl-6fbd8315"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,022.6</span></p></td>
<td class="cl-6fbd830a"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8314"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,005.0</span></p></td>
<td class="cl-6fbd8315"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">772.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fbd8316"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">Test_Train</span></p></td>
<td class="cl-6fbd831e"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">1</span></p></td>
<td class="cl-6fbd8328"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8329"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">872.4</span></p></td>
<td class="cl-6fbd8332"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">393.2</span></p></td>
<td class="cl-6fbd8328"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8329"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">864.5</span></p></td>
<td class="cl-6fbd8332"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">411.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fbd831e"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">2</span></p></td>
<td class="cl-6fbd8328"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8329"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">980.9</span></p></td>
<td class="cl-6fbd8332"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">307.6</span></p></td>
<td class="cl-6fbd8328"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8329"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">989.2</span></p></td>
<td class="cl-6fbd8332"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">309.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fbd8334"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">3</span></p></td>
<td class="cl-6fbd833c"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd833d"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,008.5</span></p></td>
<td class="cl-6fbd833e"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">277.9</span></p></td>
<td class="cl-6fbd833c"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd833d"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,020.4</span></p></td>
<td class="cl-6fbd833e"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">277.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fbd8346"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">Train</span></p></td>
<td class="cl-6fbd8350"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">1</span></p></td>
<td class="cl-6fbd835a"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd835b"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">921.7</span></p></td>
<td class="cl-6fbd835c"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">355.6</span></p></td>
<td class="cl-6fbd835a"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd835b"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">916.3</span></p></td>
<td class="cl-6fbd835c"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">355.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fbd8365"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">2</span></p></td>
<td class="cl-6fbd8378"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8379"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,005.0</span></p></td>
<td class="cl-6fbd8382"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">289.1</span></p></td>
<td class="cl-6fbd8378"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8379"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,001.8</span></p></td>
<td class="cl-6fbd8382"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">289.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fbd838c"><p class="cl-6fbd7842"><span class="cl-6fbbdae6">3</span></p></td>
<td class="cl-6fbd833c"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8396"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,022.5</span></p></td>
<td class="cl-6fbd8397"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">265.3</span></p></td>
<td class="cl-6fbd833c"><p class="cl-6fbd7843"><span class="cl-6fbbdae6"></span></p></td>
<td class="cl-6fbd8396"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">1,020.8</span></p></td>
<td class="cl-6fbd8397"><p class="cl-6fbd784c"><span class="cl-6fbbdae6">266.1</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pt_train</span><span class="op">$</span><span class="va">block_pred_full</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Block"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condit"</span>,<span class="st">"Model"</span><span class="op">)</span>, </span>
<span>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span>                       `Predicted` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>,</span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full_posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-6fdf7ac8{}.cl-6fdbbbb8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6fdd2afc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fdd2b06{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fdd2b10{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fdd2b1a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fdd2b24{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fdd2b25{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6fdd2b2e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6fdd356a{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3574{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3575{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd357e{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd357f{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3580{width:0.646in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3588{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3592{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3593{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3594{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd359c{width:0.646in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd359d{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd359e{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35a6{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35a7{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35b0{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35b1{width:0.646in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35ba{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35bb{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35c4{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35c5{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35c6{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35ce{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35d8{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35e2{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35e3{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35e4{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35ec{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35f6{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd35f7{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3600{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3601{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd360a{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3614{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3615{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3616{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd361e{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3628{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3629{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3632{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3633{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd363c{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd363d{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3646{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3650{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3651{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3652{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd365a{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd365b{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd365c{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3664{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6fdd3665{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6fdf7ac8">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="3" class="cl-6fdd356a"><p class="cl-6fdd2afc"><span class="cl-6fdbbbb8">Fit_Method</span></p></th>
<th rowspan="3" class="cl-6fdd3574"><p class="cl-6fdd2afc"><span class="cl-6fdbbbb8">Block</span></p></th>
<th class="cl-6fdd3575"><p class="cl-6fdd2b06"><span class="cl-6fdbbbb8"></span></p></th>
<th colspan="5" class="cl-6fdd357e"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">Constant</span></p></th>
<th class="cl-6fdd3575"><p class="cl-6fdd2b06"><span class="cl-6fdbbbb8"></span></p></th>
<th colspan="5" class="cl-6fdd357e"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">Varied</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6fdd3575"><p class="cl-6fdd2b06"><span class="cl-6fdbbbb8"></span></p></th>
<th colspan="2" class="cl-6fdd3593"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">ALM</span></p></th>
<th class="cl-6fdd3575"><p class="cl-6fdd2b06"><span class="cl-6fdbbbb8"></span></p></th>
<th colspan="2" class="cl-6fdd3593"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">EXAM</span></p></th>
<th class="cl-6fdd3575"><p class="cl-6fdd2b06"><span class="cl-6fdbbbb8"></span></p></th>
<th colspan="2" class="cl-6fdd3593"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">ALM</span></p></th>
<th class="cl-6fdd3575"><p class="cl-6fdd2b06"><span class="cl-6fdbbbb8"></span></p></th>
<th colspan="2" class="cl-6fdd3593"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">EXAM</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6fdd35a6"><p class="cl-6fdd2b1a"><span class="cl-6fdbbbb8"></span></p></th>
<th class="cl-6fdd35a7"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">Predicted</span></p></th>
<th class="cl-6fdd35b0"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">ME</span></p></th>
<th class="cl-6fdd35a6"><p class="cl-6fdd2b1a"><span class="cl-6fdbbbb8"></span></p></th>
<th class="cl-6fdd35a7"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">Predicted</span></p></th>
<th class="cl-6fdd35b1"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">ME</span></p></th>
<th class="cl-6fdd35a6"><p class="cl-6fdd2b1a"><span class="cl-6fdbbbb8"></span></p></th>
<th class="cl-6fdd35a7"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">Predicted</span></p></th>
<th class="cl-6fdd35b0"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">ME</span></p></th>
<th class="cl-6fdd35a6"><p class="cl-6fdd2b1a"><span class="cl-6fdbbbb8"></span></p></th>
<th class="cl-6fdd35a7"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">Predicted</span></p></th>
<th class="cl-6fdd35b0"><p class="cl-6fdd2b10"><span class="cl-6fdbbbb8">ME</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fdd35ba"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">Test</span></p></td>
<td class="cl-6fdd35bb"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">1</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">730.3</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">876.2</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">796.9</span></p></td>
<td class="cl-6fdd35ce"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">980.6</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">746.6</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,838.5</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">889.1</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,248.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fdd35bb"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">2</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">484.7</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,001.5</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">895.1</span></p></td>
<td class="cl-6fdd35ce"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">720.6</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">-4,869.1</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">7,073.9</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,024.3</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,139.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fdd35bb"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">3</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,202.4</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">714.1</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">918.0</span></p></td>
<td class="cl-6fdd35ce"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">442.5</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">951.3</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,022.6</span></p></td>
<td class="cl-6fdd35c4"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35c5"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,005.0</span></p></td>
<td class="cl-6fdd35c6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">772.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fdd35d8"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">Test_Train</span></p></td>
<td class="cl-6fdd35e2"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">1</span></p></td>
<td class="cl-6fdd35e3"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35e4"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">820.4</span></p></td>
<td class="cl-6fdd35ec"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">294.8</span></p></td>
<td class="cl-6fdd35e3"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35e4"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">832.4</span></p></td>
<td class="cl-6fdd35f6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">296.8</span></p></td>
<td class="cl-6fdd35e3"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35e4"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">872.4</span></p></td>
<td class="cl-6fdd35ec"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">393.2</span></p></td>
<td class="cl-6fdd35e3"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35e4"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">864.5</span></p></td>
<td class="cl-6fdd35ec"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">411.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fdd35e2"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">2</span></p></td>
<td class="cl-6fdd35e3"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35e4"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">885.6</span></p></td>
<td class="cl-6fdd35ec"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">202.9</span></p></td>
<td class="cl-6fdd35e3"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35e4"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">902.8</span></p></td>
<td class="cl-6fdd35f6"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">205.8</span></p></td>
<td class="cl-6fdd35e3"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35e4"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">980.9</span></p></td>
<td class="cl-6fdd35ec"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">307.6</span></p></td>
<td class="cl-6fdd35e3"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd35e4"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">989.2</span></p></td>
<td class="cl-6fdd35ec"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">309.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fdd3600"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">3</span></p></td>
<td class="cl-6fdd3601"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd360a"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">886.9</span></p></td>
<td class="cl-6fdd3614"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">191.9</span></p></td>
<td class="cl-6fdd3601"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd360a"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">902.2</span></p></td>
<td class="cl-6fdd3615"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">198.3</span></p></td>
<td class="cl-6fdd3601"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd360a"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,008.5</span></p></td>
<td class="cl-6fdd3614"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">277.9</span></p></td>
<td class="cl-6fdd3601"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd360a"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,020.4</span></p></td>
<td class="cl-6fdd3614"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">277.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6fdd3616"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">Train</span></p></td>
<td class="cl-6fdd361e"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">1</span></p></td>
<td class="cl-6fdd3628"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd3629"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">830.6</span></p></td>
<td class="cl-6fdd3632"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">272.3</span></p></td>
<td class="cl-6fdd3628"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd3629"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">831.4</span></p></td>
<td class="cl-6fdd3633"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">272.1</span></p></td>
<td class="cl-6fdd3628"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd3629"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">921.7</span></p></td>
<td class="cl-6fdd3632"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">355.6</span></p></td>
<td class="cl-6fdd3628"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd3629"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">916.3</span></p></td>
<td class="cl-6fdd3632"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">355.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fdd363d"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">2</span></p></td>
<td class="cl-6fdd3646"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd3650"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">889.9</span></p></td>
<td class="cl-6fdd3651"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">193.6</span></p></td>
<td class="cl-6fdd3646"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd3650"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">890.3</span></p></td>
<td class="cl-6fdd3652"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">193.4</span></p></td>
<td class="cl-6fdd3646"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd3650"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,005.0</span></p></td>
<td class="cl-6fdd3651"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">289.1</span></p></td>
<td class="cl-6fdd3646"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd3650"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,001.8</span></p></td>
<td class="cl-6fdd3651"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">289.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6fdd365b"><p class="cl-6fdd2b24"><span class="cl-6fdbbbb8">3</span></p></td>
<td class="cl-6fdd3601"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd365c"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">890.3</span></p></td>
<td class="cl-6fdd3664"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">183.0</span></p></td>
<td class="cl-6fdd3601"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd365c"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">890.0</span></p></td>
<td class="cl-6fdd3665"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">183.1</span></p></td>
<td class="cl-6fdd3601"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd365c"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,022.5</span></p></td>
<td class="cl-6fdd3664"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">265.3</span></p></td>
<td class="cl-6fdd3601"><p class="cl-6fdd2b25"><span class="cl-6fdbbbb8"></span></p></td>
<td class="cl-6fdd365c"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">1,020.8</span></p></td>
<td class="cl-6fdd3664"><p class="cl-6fdd2b2e"><span class="cl-6fdbbbb8">266.1</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pt_train</span><span class="op">$</span><span class="va">block_pred_full</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Block"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condit"</span>,<span class="st">"Model"</span><span class="op">)</span>, </span>
<span>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full_posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-6ff74b4e{}.cl-6ff3d9f0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6ff543a8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ff543bc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6ff543bd{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ff543c6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6ff543c7{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ff543d0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-6ff543da{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ff54d26{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d30{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d31{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d3a{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d3b{width:0.697in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d44{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d4e{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d4f{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d50{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d58{width:0.697in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d62{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d63{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d6c{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d76{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d77{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d80{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d8a{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d8b{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d94{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d9e{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54d9f{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54da8{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54db2{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54db3{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dbc{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dbd{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dc6{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dc7{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dc8{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dd0{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dd1{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dd2{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54dda{width:0.774in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ff54ddb{width:0.697in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6ff74b4e">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-6ff54d26"><p class="cl-6ff543a8"><span class="cl-6ff3d9f0">Fit_Method</span></p></th>
<th rowspan="2" class="cl-6ff54d30"><p class="cl-6ff543a8"><span class="cl-6ff3d9f0">Block</span></p></th>
<th class="cl-6ff54d31"><p class="cl-6ff543bc"><span class="cl-6ff3d9f0"></span></p></th>
<th colspan="3" class="cl-6ff54d3a"><p class="cl-6ff543bd"><span class="cl-6ff3d9f0">Constant</span></p></th>
<th class="cl-6ff54d31"><p class="cl-6ff543bc"><span class="cl-6ff3d9f0"></span></p></th>
<th colspan="3" class="cl-6ff54d3a"><p class="cl-6ff543bd"><span class="cl-6ff3d9f0">Varied</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6ff54d4f"><p class="cl-6ff543c6"><span class="cl-6ff3d9f0"></span></p></th>
<th class="cl-6ff54d50"><p class="cl-6ff543bd"><span class="cl-6ff3d9f0">ALM</span></p></th>
<th class="cl-6ff54d4f"><p class="cl-6ff543c6"><span class="cl-6ff3d9f0"></span></p></th>
<th class="cl-6ff54d58"><p class="cl-6ff543bd"><span class="cl-6ff3d9f0">EXAM</span></p></th>
<th class="cl-6ff54d4f"><p class="cl-6ff543c6"><span class="cl-6ff3d9f0"></span></p></th>
<th class="cl-6ff54d50"><p class="cl-6ff543bd"><span class="cl-6ff3d9f0">ALM</span></p></th>
<th class="cl-6ff54d4f"><p class="cl-6ff543c6"><span class="cl-6ff3d9f0"></span></p></th>
<th class="cl-6ff54d50"><p class="cl-6ff543bd"><span class="cl-6ff3d9f0">EXAM</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6ff54d62"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">Test</span></p></td>
<td class="cl-6ff54d63"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">1</span></p></td>
<td class="cl-6ff54d6c"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d76"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">876.2</span></p></td>
<td class="cl-6ff54d6c"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d77"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">980.6</span></p></td>
<td class="cl-6ff54d6c"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d76"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">1,838.5</span></p></td>
<td class="cl-6ff54d6c"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d76"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">1,248.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ff54d8a"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">2</span></p></td>
<td class="cl-6ff54d8b"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d94"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">1,001.5</span></p></td>
<td class="cl-6ff54d8b"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d9e"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">720.6</span></p></td>
<td class="cl-6ff54d8b"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d94"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">7,073.9</span></p></td>
<td class="cl-6ff54d8b"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d94"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">1,139.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ff54d63"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">3</span></p></td>
<td class="cl-6ff54d6c"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d76"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">714.1</span></p></td>
<td class="cl-6ff54d6c"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d77"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">442.5</span></p></td>
<td class="cl-6ff54d6c"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d76"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">1,022.6</span></p></td>
<td class="cl-6ff54d6c"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54d76"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">772.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6ff54d9f"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">Test_Train</span></p></td>
<td class="cl-6ff54da8"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">1</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">294.8</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dbc"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">296.8</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">393.2</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">411.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ff54da8"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">2</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">202.9</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dbc"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">205.8</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">307.6</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">309.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ff54da8"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">3</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">191.9</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dbc"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">198.3</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">277.9</span></p></td>
<td class="cl-6ff54db2"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54db3"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">277.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-6ff54dbd"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">Train</span></p></td>
<td class="cl-6ff54dc6"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">1</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dc8"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">272.3</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dd0"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">272.1</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dc8"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">355.6</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dc8"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">355.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ff54dc6"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">2</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dc8"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">193.6</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dd0"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">193.4</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dc8"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">289.1</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dc8"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">289.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ff54dd2"><p class="cl-6ff543c7"><span class="cl-6ff3d9f0">3</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dda"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">183.0</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54ddb"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">183.1</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dda"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">265.3</span></p></td>
<td class="cl-6ff54dc7"><p class="cl-6ff543d0"><span class="cl-6ff3d9f0"></span></p></td>
<td class="cl-6ff54dda"><p class="cl-6ff543da"><span class="cl-6ff3d9f0">266.1</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_indices</span> <span class="op">&lt;-</span> <span class="va">pt_train</span><span class="op">$</span><span class="va">block_pred_full_x</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">nest</span><span class="op">(</span>data <span class="op">=</span> <span class="op">-</span><span class="va">condit</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>indices <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span><span class="op">{</span></span>
<span>    <span class="va">.x</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">y</span>, <span class="op">-</span><span class="va">pred</span>, <span class="op">-</span><span class="va">mean_error</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Model</span>, values_from <span class="op">=</span> <span class="va">best</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">select</span><span class="op">(</span><span class="va">ALM</span>, <span class="va">EXAM</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">pmap</span><span class="op">(</span>.f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">ALM</span>, <span class="va">EXAM</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ALM</span>, <span class="va">EXAM</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">condit</span>, <span class="va">indices</span><span class="op">)</span></span>
<span>   </span>
<span></span>
<span></span>
<span><span class="va">pt_train</span><span class="op">$</span><span class="va">block_pred_full_x</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">condit</span><span class="op">==</span><span class="st">"Varied"</span>,<span class="op">!</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Block"</span>,<span class="st">"x"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span>, </span>
<span>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span>                       `Predicted` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>,</span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">apply_best_formatting</span><span class="op">(</span><span class="va">.</span>,<span class="fu">pull</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">best_indices</span>,<span class="va">condit</span><span class="op">==</span><span class="st">"Varied"</span><span class="op">)</span>,<span class="va">indices</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Vared Train Predictions"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-7013ca3a{}.cl-700fff7c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-700fff86{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:rgba(245, 222, 179, 1.00);}.cl-70118432{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7011843c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-70118446{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-70118447{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-70118448{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-70118450{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-7011845a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-70118e5a{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e5b{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e64{width:0.646in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e6e{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e6f{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e78{width:0.646in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e82{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e83{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e8c{width:0.646in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e8d{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e96{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118e97{width:0.646in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ea0{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118eaa{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118eab{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118eac{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118eb4{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ebe{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ebf{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ec0{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ec8{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ed2{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ed3{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ed4{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118edc{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ee6{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ee7{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ee8{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118ef0{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118efa{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f04{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f05{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f0e{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f0f{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f18{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f19{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f22{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f23{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f2c{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f2d{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f36{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f37{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f38{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f40{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f4a{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f4b{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f54{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f55{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-70118f56{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-7013ca3a">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-70118e5a"><p class="cl-70118432"><span class="cl-700fff7c">Fit_Method</span></p></th>
<th rowspan="2" class="cl-70118e5b"><p class="cl-70118432"><span class="cl-700fff7c">Block</span></p></th>
<th rowspan="2" class="cl-70118e64"><p class="cl-70118432"><span class="cl-700fff7c">x</span></p></th>
<th class="cl-70118e6e"><p class="cl-7011843c"><span class="cl-700fff7c"></span></p></th>
<th colspan="2" class="cl-70118e6f"><p class="cl-70118446"><span class="cl-700fff7c">ALM</span></p></th>
<th class="cl-70118e6e"><p class="cl-7011843c"><span class="cl-700fff7c"></span></p></th>
<th colspan="2" class="cl-70118e6f"><p class="cl-70118446"><span class="cl-700fff7c">EXAM</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-70118e8d"><p class="cl-70118447"><span class="cl-700fff7c"></span></p></th>
<th class="cl-70118e96"><p class="cl-70118446"><span class="cl-700fff7c">Predicted</span></p></th>
<th class="cl-70118e97"><p class="cl-70118446"><span class="cl-700fff7c">ME</span></p></th>
<th class="cl-70118e8d"><p class="cl-70118447"><span class="cl-700fff7c"></span></p></th>
<th class="cl-70118e96"><p class="cl-70118446"><span class="cl-700fff7c">Predicted</span></p></th>
<th class="cl-70118e97"><p class="cl-70118446"><span class="cl-700fff7c">ME</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="9" class="cl-70118ea0"><p class="cl-70118448"><span class="cl-700fff7c">Test_Train</span></p></td>
<td rowspan="3" class="cl-70118eaa"><p class="cl-70118448"><span class="cl-700fff7c">1</span></p></td>
<td class="cl-70118eab"><p class="cl-70118448"><span class="cl-700fff7c">800</span></p></td>
<td class="cl-70118eac"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118eb4"><p class="cl-7011845a"><span class="cl-700fff7c">845.3</span></p></td>
<td class="cl-70118ebe"><p class="cl-7011845a"><span class="cl-700fff86">356.8</span></p></td>
<td class="cl-70118eac"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118eb4"><p class="cl-7011845a"><span class="cl-700fff7c">849.0</span></p></td>
<td class="cl-70118ebe"><p class="cl-7011845a"><span class="cl-700fff7c">375.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118ec8"><p class="cl-70118448"><span class="cl-700fff7c">1,000</span></p></td>
<td class="cl-70118ed2"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ed3"><p class="cl-7011845a"><span class="cl-700fff7c">875.0</span></p></td>
<td class="cl-70118ed4"><p class="cl-7011845a"><span class="cl-700fff86">387.1</span></p></td>
<td class="cl-70118ed2"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ed3"><p class="cl-7011845a"><span class="cl-700fff7c">868.9</span></p></td>
<td class="cl-70118ed4"><p class="cl-7011845a"><span class="cl-700fff7c">404.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118ee7"><p class="cl-70118448"><span class="cl-700fff7c">1,200</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ef0"><p class="cl-7011845a"><span class="cl-700fff7c">898.1</span></p></td>
<td class="cl-70118efa"><p class="cl-7011845a"><span class="cl-700fff86">423.9</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ef0"><p class="cl-7011845a"><span class="cl-700fff7c">879.2</span></p></td>
<td class="cl-70118efa"><p class="cl-7011845a"><span class="cl-700fff7c">440.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-70118eaa"><p class="cl-70118448"><span class="cl-700fff7c">2</span></p></td>
<td class="cl-70118eab"><p class="cl-70118448"><span class="cl-700fff7c">800</span></p></td>
<td class="cl-70118eac"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118eb4"><p class="cl-7011845a"><span class="cl-700fff7c">940.2</span></p></td>
<td class="cl-70118ebe"><p class="cl-7011845a"><span class="cl-700fff86">291.3</span></p></td>
<td class="cl-70118eac"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118eb4"><p class="cl-7011845a"><span class="cl-700fff7c">960.6</span></p></td>
<td class="cl-70118ebe"><p class="cl-7011845a"><span class="cl-700fff7c">292.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118ec8"><p class="cl-70118448"><span class="cl-700fff7c">1,000</span></p></td>
<td class="cl-70118ed2"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ed3"><p class="cl-7011845a"><span class="cl-700fff7c">984.0</span></p></td>
<td class="cl-70118ed4"><p class="cl-7011845a"><span class="cl-700fff86">291.7</span></p></td>
<td class="cl-70118ed2"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ed3"><p class="cl-7011845a"><span class="cl-700fff7c">992.2</span></p></td>
<td class="cl-70118ed4"><p class="cl-7011845a"><span class="cl-700fff7c">293.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118ee7"><p class="cl-70118448"><span class="cl-700fff7c">1,200</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ef0"><p class="cl-7011845a"><span class="cl-700fff7c">1,019.2</span></p></td>
<td class="cl-70118efa"><p class="cl-7011845a"><span class="cl-700fff86">339.7</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ef0"><p class="cl-7011845a"><span class="cl-700fff7c">1,015.3</span></p></td>
<td class="cl-70118efa"><p class="cl-7011845a"><span class="cl-700fff7c">341.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-70118eaa"><p class="cl-70118448"><span class="cl-700fff7c">3</span></p></td>
<td class="cl-70118eab"><p class="cl-70118448"><span class="cl-700fff7c">800</span></p></td>
<td class="cl-70118eac"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118eb4"><p class="cl-7011845a"><span class="cl-700fff7c">960.2</span></p></td>
<td class="cl-70118ebe"><p class="cl-7011845a"><span class="cl-700fff86">261.2</span></p></td>
<td class="cl-70118eac"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118eb4"><p class="cl-7011845a"><span class="cl-700fff7c">973.8</span></p></td>
<td class="cl-70118ebe"><p class="cl-7011845a"><span class="cl-700fff7c">267.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118f0e"><p class="cl-70118448"><span class="cl-700fff7c">1,000</span></p></td>
<td class="cl-70118f0f"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f18"><p class="cl-7011845a"><span class="cl-700fff7c">1,009.0</span></p></td>
<td class="cl-70118f19"><p class="cl-7011845a"><span class="cl-700fff86">259.7</span></p></td>
<td class="cl-70118f0f"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f18"><p class="cl-7011845a"><span class="cl-700fff7c">1,026.3</span></p></td>
<td class="cl-70118f19"><p class="cl-7011845a"><span class="cl-700fff7c">260.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118f0e"><p class="cl-70118448"><span class="cl-700fff7c">1,200</span></p></td>
<td class="cl-70118f0f"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f18"><p class="cl-7011845a"><span class="cl-700fff7c">1,054.8</span></p></td>
<td class="cl-70118f19"><p class="cl-7011845a"><span class="cl-700fff7c">308.0</span></p></td>
<td class="cl-70118f0f"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f18"><p class="cl-7011845a"><span class="cl-700fff7c">1,060.3</span></p></td>
<td class="cl-70118f19"><p class="cl-7011845a"><span class="cl-700fff86">300.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="9" class="cl-70118f22"><p class="cl-70118448"><span class="cl-700fff7c">Train</span></p></td>
<td rowspan="3" class="cl-70118f23"><p class="cl-70118448"><span class="cl-700fff7c">1</span></p></td>
<td class="cl-70118f2c"><p class="cl-70118448"><span class="cl-700fff7c">800</span></p></td>
<td class="cl-70118f2d"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f36"><p class="cl-7011845a"><span class="cl-700fff7c">892.3</span></p></td>
<td class="cl-70118f37"><p class="cl-7011845a"><span class="cl-700fff7c">321.8</span></p></td>
<td class="cl-70118f2d"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f36"><p class="cl-7011845a"><span class="cl-700fff7c">887.0</span></p></td>
<td class="cl-70118f37"><p class="cl-7011845a"><span class="cl-700fff86">319.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118ec8"><p class="cl-70118448"><span class="cl-700fff7c">1,000</span></p></td>
<td class="cl-70118ed2"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ed3"><p class="cl-7011845a"><span class="cl-700fff7c">923.4</span></p></td>
<td class="cl-70118ed4"><p class="cl-7011845a"><span class="cl-700fff86">355.1</span></p></td>
<td class="cl-70118ed2"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ed3"><p class="cl-7011845a"><span class="cl-700fff7c">918.1</span></p></td>
<td class="cl-70118ed4"><p class="cl-7011845a"><span class="cl-700fff7c">355.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118ee7"><p class="cl-70118448"><span class="cl-700fff7c">1,200</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ef0"><p class="cl-7011845a"><span class="cl-700fff7c">947.3</span></p></td>
<td class="cl-70118efa"><p class="cl-7011845a"><span class="cl-700fff86">378.0</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ef0"><p class="cl-7011845a"><span class="cl-700fff7c">941.6</span></p></td>
<td class="cl-70118efa"><p class="cl-7011845a"><span class="cl-700fff7c">379.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-70118f23"><p class="cl-70118448"><span class="cl-700fff7c">2</span></p></td>
<td class="cl-70118f2c"><p class="cl-70118448"><span class="cl-700fff7c">800</span></p></td>
<td class="cl-70118f2d"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f36"><p class="cl-7011845a"><span class="cl-700fff7c">979.9</span></p></td>
<td class="cl-70118f37"><p class="cl-7011845a"><span class="cl-700fff86">269.3</span></p></td>
<td class="cl-70118f2d"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f36"><p class="cl-7011845a"><span class="cl-700fff7c">975.1</span></p></td>
<td class="cl-70118f37"><p class="cl-7011845a"><span class="cl-700fff7c">269.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118ec8"><p class="cl-70118448"><span class="cl-700fff7c">1,000</span></p></td>
<td class="cl-70118ed2"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ed3"><p class="cl-7011845a"><span class="cl-700fff7c">1,001.0</span></p></td>
<td class="cl-70118ed4"><p class="cl-7011845a"><span class="cl-700fff86">281.0</span></p></td>
<td class="cl-70118ed2"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ed3"><p class="cl-7011845a"><span class="cl-700fff7c">997.7</span></p></td>
<td class="cl-70118ed4"><p class="cl-7011845a"><span class="cl-700fff7c">282.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118f0e"><p class="cl-70118448"><span class="cl-700fff7c">1,200</span></p></td>
<td class="cl-70118f0f"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f18"><p class="cl-7011845a"><span class="cl-700fff7c">1,035.6</span></p></td>
<td class="cl-70118f19"><p class="cl-7011845a"><span class="cl-700fff86">316.4</span></p></td>
<td class="cl-70118f0f"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f18"><p class="cl-7011845a"><span class="cl-700fff7c">1,033.5</span></p></td>
<td class="cl-70118f19"><p class="cl-7011845a"><span class="cl-700fff7c">316.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-70118f40"><p class="cl-70118448"><span class="cl-700fff7c">3</span></p></td>
<td class="cl-70118f2c"><p class="cl-70118448"><span class="cl-700fff7c">800</span></p></td>
<td class="cl-70118f2d"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f36"><p class="cl-7011845a"><span class="cl-700fff7c">992.9</span></p></td>
<td class="cl-70118f37"><p class="cl-7011845a"><span class="cl-700fff86">253.4</span></p></td>
<td class="cl-70118f2d"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f36"><p class="cl-7011845a"><span class="cl-700fff7c">989.2</span></p></td>
<td class="cl-70118f37"><p class="cl-7011845a"><span class="cl-700fff7c">255.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118ee7"><p class="cl-70118448"><span class="cl-700fff7c">1,000</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ef0"><p class="cl-7011845a"><span class="cl-700fff7c">1,017.2</span></p></td>
<td class="cl-70118efa"><p class="cl-7011845a"><span class="cl-700fff86">247.3</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118ef0"><p class="cl-7011845a"><span class="cl-700fff7c">1,017.3</span></p></td>
<td class="cl-70118efa"><p class="cl-7011845a"><span class="cl-700fff7c">247.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-70118f54"><p class="cl-70118448"><span class="cl-700fff7c">1,200</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f55"><p class="cl-7011845a"><span class="cl-700fff7c">1,055.9</span></p></td>
<td class="cl-70118f56"><p class="cl-7011845a"><span class="cl-700fff86">291.5</span></p></td>
<td class="cl-70118ee8"><p class="cl-70118450"><span class="cl-700fff7c"></span></p></td>
<td class="cl-70118f55"><p class="cl-7011845a"><span class="cl-700fff7c">1,053.9</span></p></td>
<td class="cl-70118f56"><p class="cl-7011845a"><span class="cl-700fff7c">291.9</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pt_train</span><span class="op">$</span><span class="va">block_pred_full_x</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">condit</span><span class="op">==</span><span class="st">"Constant"</span>,<span class="op">!</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/tabulator.html">tabulator</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fit_Method"</span>,<span class="st">"Block"</span>,<span class="st">"x"</span><span class="op">)</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span>, </span>
<span>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span>                       `Predicted` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>,</span>
<span>                       `ME` <span class="op">=</span> <span class="fu">as_paragraph</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">as_flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">apply_best_formatting</span><span class="op">(</span><span class="va">.</span>,<span class="fu">pull</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">best_indices</span>,<span class="va">condit</span><span class="op">==</span><span class="st">"Constant"</span><span class="op">)</span>,<span class="va">indices</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Constant Train Predictions"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-7029afda{}.cl-70265e8e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-70265ea2{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:rgba(245, 222, 179, 1.00);}.cl-7027d660{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7027d66a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-7027d674{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7027d675{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-7027d688{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7027d689{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-7027d692{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7027df5c{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df5d{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df66{width:0.519in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df67{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df70{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df7a{width:0.646in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df7b{width:1.028in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df84{width:0.638in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df85{width:0.519in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df8e{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df98{width:0.909in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027df99{width:0.646in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfa2{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfac{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfad{width:0.519in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfb6{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfc0{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfc1{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfca{width:0.519in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfcb{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfd4{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfd5{width:0.519in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfd6{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfde{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfe8{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dfe9{width:1.028in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dff2{width:0.638in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dff3{width:0.519in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dff4{width:0.909in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7027dff5{width:0.646in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-7029afda">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-7027df5c"><p class="cl-7027d660"><span class="cl-70265e8e">Fit_Method</span></p></th>
<th rowspan="2" class="cl-7027df5d"><p class="cl-7027d660"><span class="cl-70265e8e">Block</span></p></th>
<th rowspan="2" class="cl-7027df66"><p class="cl-7027d660"><span class="cl-70265e8e">x</span></p></th>
<th class="cl-7027df67"><p class="cl-7027d66a"><span class="cl-70265e8e"></span></p></th>
<th colspan="2" class="cl-7027df70"><p class="cl-7027d674"><span class="cl-70265e8e">ALM</span></p></th>
<th class="cl-7027df67"><p class="cl-7027d66a"><span class="cl-70265e8e"></span></p></th>
<th colspan="2" class="cl-7027df70"><p class="cl-7027d674"><span class="cl-70265e8e">EXAM</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-7027df8e"><p class="cl-7027d675"><span class="cl-70265e8e"></span></p></th>
<th class="cl-7027df98"><p class="cl-7027d674"><span class="cl-70265e8e">Predicted</span></p></th>
<th class="cl-7027df99"><p class="cl-7027d674"><span class="cl-70265e8e">ME</span></p></th>
<th class="cl-7027df8e"><p class="cl-7027d675"><span class="cl-70265e8e"></span></p></th>
<th class="cl-7027df98"><p class="cl-7027d674"><span class="cl-70265e8e">Predicted</span></p></th>
<th class="cl-7027df99"><p class="cl-7027d674"><span class="cl-70265e8e">ME</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-7027dfa2"><p class="cl-7027d688"><span class="cl-70265e8e">Test_Train</span></p></td>
<td class="cl-7027dfac"><p class="cl-7027d688"><span class="cl-70265e8e">1</span></p></td>
<td rowspan="6" class="cl-7027dfad"><p class="cl-7027d688"><span class="cl-70265e8e">800</span></p></td>
<td class="cl-7027dfb6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfc0"><p class="cl-7027d692"><span class="cl-70265e8e">820.8</span></p></td>
<td class="cl-7027dfc1"><p class="cl-7027d692"><span class="cl-70265ea2">294.3</span></p></td>
<td class="cl-7027dfb6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfc0"><p class="cl-7027d692"><span class="cl-70265e8e">832.5</span></p></td>
<td class="cl-7027dfc1"><p class="cl-7027d692"><span class="cl-70265e8e">296.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-7027dfac"><p class="cl-7027d688"><span class="cl-70265e8e">2</span></p></td>
<td class="cl-7027dfb6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfc0"><p class="cl-7027d692"><span class="cl-70265e8e">886.0</span></p></td>
<td class="cl-7027dfc1"><p class="cl-7027d692"><span class="cl-70265ea2">202.5</span></p></td>
<td class="cl-7027dfb6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfc0"><p class="cl-7027d692"><span class="cl-70265e8e">902.6</span></p></td>
<td class="cl-7027dfc1"><p class="cl-7027d692"><span class="cl-70265e8e">205.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-7027dfac"><p class="cl-7027d688"><span class="cl-70265e8e">3</span></p></td>
<td class="cl-7027dfb6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfc0"><p class="cl-7027d692"><span class="cl-70265e8e">887.7</span></p></td>
<td class="cl-7027dfc1"><p class="cl-7027d692"><span class="cl-70265ea2">191.1</span></p></td>
<td class="cl-7027dfb6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfc0"><p class="cl-7027d692"><span class="cl-70265e8e">902.8</span></p></td>
<td class="cl-7027dfc1"><p class="cl-7027d692"><span class="cl-70265e8e">197.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td rowspan="3" class="cl-7027dfcb"><p class="cl-7027d688"><span class="cl-70265e8e">Train</span></p></td>
<td class="cl-7027dfd4"><p class="cl-7027d688"><span class="cl-70265e8e">1</span></p></td>
<td class="cl-7027dfd6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfde"><p class="cl-7027d692"><span class="cl-70265e8e">830.7</span></p></td>
<td class="cl-7027dfe8"><p class="cl-7027d692"><span class="cl-70265e8e">271.6</span></p></td>
<td class="cl-7027dfd6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfde"><p class="cl-7027d692"><span class="cl-70265e8e">831.6</span></p></td>
<td class="cl-7027dfe8"><p class="cl-7027d692"><span class="cl-70265ea2">271.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-7027dfd4"><p class="cl-7027d688"><span class="cl-70265e8e">2</span></p></td>
<td class="cl-7027dfd6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfde"><p class="cl-7027d692"><span class="cl-70265e8e">889.9</span></p></td>
<td class="cl-7027dfe8"><p class="cl-7027d692"><span class="cl-70265e8e">193.4</span></p></td>
<td class="cl-7027dfd6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dfde"><p class="cl-7027d692"><span class="cl-70265e8e">890.3</span></p></td>
<td class="cl-7027dfe8"><p class="cl-7027d692"><span class="cl-70265ea2">193.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-7027dff2"><p class="cl-7027d688"><span class="cl-70265e8e">3</span></p></td>
<td class="cl-7027dfd6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dff4"><p class="cl-7027d692"><span class="cl-70265e8e">890.6</span></p></td>
<td class="cl-7027dff5"><p class="cl-7027d692"><span class="cl-70265ea2">182.3</span></p></td>
<td class="cl-7027dfd6"><p class="cl-7027d689"><span class="cl-70265e8e"></span></p></td>
<td class="cl-7027dff4"><p class="cl-7027d692"><span class="cl-70265e8e">890.4</span></p></td>
<td class="cl-7027dff5"><p class="cl-7027d692"><span class="cl-70265ea2">182.3</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># pull(filter(best_indices,condit=="Varied"),indices) %&gt;% .[[1]] </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="posterior-predictive" class="level2"><h2 class="anchored" data-anchor-id="posterior-predictive">Posterior Predictive:</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">group_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">testAvg</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">vx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">vb</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">rank</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">rank</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span>data<span class="op">=</span><span class="va">post_dat_avg</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">x</span>,ncol<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Model</span><span class="op">==</span><span class="st">"EXAM"</span>,<span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span>data<span class="op">=</span><span class="va">post_dat_avg</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">x</span>,ncol<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Model</span><span class="op">==</span><span class="st">"ALM"</span>,<span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span>data<span class="op">=</span><span class="va">post_dat_avg</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">x</span>,ncol<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span>data<span class="op">=</span><span class="va">post_dat_avg</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"black"</span>,alpha<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">x</span>,ncol<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-6-6.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span>data<span class="op">=</span><span class="va">post_dat_avg</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"black"</span>,alpha<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">x</span>,ncol<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-6-7.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Train"</span>,<span class="va">pred</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="va">pred</span><span class="op">&lt;</span><span class="fl">2000</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span>data<span class="op">=</span><span class="va">post_dat_avg</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"black"</span>,alpha<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">x</span>,ncol<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-6-8.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<section id="alt-grouping-of-posterior-predictive" class="level3"><h3 class="anchored" data-anchor-id="alt-grouping-of-posterior-predictive">Alt grouping of Posterior Predictive</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="fu">group_predictive_plots2</span><span class="op">(</span><span class="va">post_dat_l</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">error</span>, fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">stat_bar</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">Fit_Method</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Resituals - full posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_avg</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">rank</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">error</span>, fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">stat_bar</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">Fit_Method</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Model Residuals - best parameters"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_indv_posterior</span><span class="op">(</span><span class="va">ind_fits_df</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>Group<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_indv_posterior</span><span class="op">(</span><span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">rank</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>Group<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot join density of c and lr</span></span>
<span><span class="co"># post_dat |&gt; filter(rank==1, c&lt;.001) |&gt; </span></span>
<span><span class="co">#   ggplot(aes(x=c, y=lr, color=condit)) + geom_point() + facet_wrap(~Model+Fit_Method)</span></span>
<span></span>
<span><span class="va">post_dat</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">c</span><span class="op">&lt;</span><span class="fl">.001</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">c</span>,y<span class="op">=</span><span class="va">condit</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_boxploth</span><span class="op">(</span>width<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Model</span><span class="op">+</span><span class="va">Fit_Method</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dist</span> <span class="op">&lt;-</span> <span class="va">post_dat_avg</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">slice_head</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Make sure to remove the grouping by rank before the next group_by</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">c</span><span class="op">:</span><span class="va">lr</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span>, se <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">'keep'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_dist</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">c_mean</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>gmean <span class="op">=</span> <span class="va">mean</span>, gsd <span class="op">=</span> <span class="va">sd</span>, gse <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">'keep'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">c_mean</span><span class="op">&lt;</span><span class="op">(</span><span class="va">c_mean_gmean</span><span class="op">+</span><span class="op">(</span><span class="fl">.5</span><span class="op">*</span><span class="va">c_mean_gse</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">id</span>, x <span class="op">=</span> <span class="va">c_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_pointinterval</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">condit</span><span class="op">~</span><span class="va">Model</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dist</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">c_mean</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>gmean <span class="op">=</span> <span class="va">median</span>, gsd <span class="op">=</span> <span class="va">sd</span>, gse <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">'keep'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">c_mean</span><span class="op">&lt;</span><span class="op">(</span><span class="va">c_mean_gmean</span><span class="op">+</span><span class="op">(</span><span class="fl">.5</span><span class="op">*</span><span class="va">c_mean_gse</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span> x <span class="op">=</span> <span class="va">c_mean</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">Model</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dist</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">c_mean</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>gmean <span class="op">=</span> <span class="va">median</span>, gsd <span class="op">=</span> <span class="va">sd</span>, gse <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">'keep'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">c_mean</span><span class="op">&lt;</span><span class="op">(</span><span class="va">c_mean_gmean</span><span class="op">+</span><span class="op">(</span><span class="fl">.5</span><span class="op">*</span><span class="va">c_mean_gse</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span> x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">c_mean</span><span class="op">)</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">Model</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="va">post_dat_avg</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">slice_head</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span> x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">Model</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-7.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="va">post_dat_avg</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">slice_head</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">Fit_Method</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span>,col<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_pointinterval</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Model</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-8.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="va">post_dat_avg</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>, <span class="va">Fit_Method</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">slice_head</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">Fit_Method</span>, x <span class="op">=</span> <span class="va">lr</span>,col<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_pointinterval</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Model</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-9-9.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># post_dat_avg %&gt;%</span></span>
<span><span class="co">#     group_by(id, condit, Model, Fit_Method, rank) %&gt;%</span></span>
<span><span class="co">#     slice_head(n = 1) |&gt;</span></span>
<span><span class="co">#     ggplot(aes(y=Fit_Method, x = (lr),fill=condit)) + </span></span>
<span><span class="co">#     stat_halfeye(position=position_dodge(.2)) +</span></span>
<span><span class="co">#     ggh4x::facet_nested_wrap(~Model,scales="free")   </span></span>
<span><span class="co">#   </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="model-comparison" class="level2"><h2 class="anchored" data-anchor-id="model-comparison">Model Comparison:</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">indv_best_plots</span><span class="op">(</span><span class="va">post_dat_l</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_l</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span>,<span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">summarise</span><span class="op">(</span>mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span>, n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">rank</span>,y<span class="op">=</span><span class="va">mean_error</span>,fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Fit_Method</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_l</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span>,<span class="va">rank</span>,<span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">summarise</span><span class="op">(</span>mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span>, n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">rank</span>,y<span class="op">=</span><span class="va">mean_error</span>,fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">facet_wrap</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">x</span>,ncol<span class="op">=</span><span class="fl">6</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">group_best_plots</span><span class="op">(</span><span class="va">post_dat_l</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section><section id="individual-predictive-plots" class="level2"><h2 class="anchored" data-anchor-id="individual-predictive-plots">Individual Predictive Plots</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">indv_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">ids2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">indv_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">idsBad</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
<section id="subject-1" class="level3"><h3 class="anchored" data-anchor-id="subject-1">Subject 1</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">indv_predictive_dist</span><span class="op">(</span><span class="op">(</span><span class="va">post_dat_l</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">rank</span><span class="op">&lt;=</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span>,<span class="va">ind_fits_df</span>, sbj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">abc_tables</span><span class="op">(</span><span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">agg_full</span> <span class="op">|&gt;</span> <span class="fu">flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-8269ae7a{}.cl-82667f20{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8267d096{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8267d0a0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8267d852{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8267d85c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8267d85d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8267d866{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8267d867{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8267d870{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-8269ae7a">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-8267d852"><p class="cl-8267d096"><span class="cl-82667f20">condit</span></p></th>
<th class="cl-8267d852"><p class="cl-8267d096"><span class="cl-82667f20">Model</span></p></th>
<th class="cl-8267d852"><p class="cl-8267d096"><span class="cl-82667f20">Fit_Method</span></p></th>
<th class="cl-8267d85c"><p class="cl-8267d0a0"><span class="cl-82667f20">mean_error</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Varied</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">ALM</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Test</span></p></td>
<td class="cl-8267d866"><p class="cl-8267d0a0"><span class="cl-82667f20">239.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Varied</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">ALM</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Test_Train</span></p></td>
<td class="cl-8267d866"><p class="cl-8267d0a0"><span class="cl-82667f20">291.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Varied</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">ALM</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Train</span></p></td>
<td class="cl-8267d866"><p class="cl-8267d0a0"><span class="cl-82667f20">297.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Varied</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">EXAM</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Test</span></p></td>
<td class="cl-8267d866"><p class="cl-8267d0a0"><span class="cl-82667f20">219.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Varied</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">EXAM</span></p></td>
<td class="cl-8267d85d"><p class="cl-8267d096"><span class="cl-82667f20">Test_Train</span></p></td>
<td class="cl-8267d866"><p class="cl-8267d0a0"><span class="cl-82667f20">276.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8267d867"><p class="cl-8267d096"><span class="cl-82667f20">Varied</span></p></td>
<td class="cl-8267d867"><p class="cl-8267d096"><span class="cl-82667f20">EXAM</span></p></td>
<td class="cl-8267d867"><p class="cl-8267d096"><span class="cl-82667f20">Train</span></p></td>
<td class="cl-8267d870"><p class="cl-8267d0a0"><span class="cl-82667f20">297.7</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">abc_tables</span><span class="op">(</span><span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">agg_best</span> <span class="op">|&gt;</span> <span class="fu">flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from best parameters"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-8281cf00{}.cl-827ee1aa{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-828027fe{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-82802808{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-82802fa6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82802fb0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82802fba{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82802fc4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82802fc5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82802fce{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-8281cf00">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-82802fa6"><p class="cl-828027fe"><span class="cl-827ee1aa">condit</span></p></th>
<th class="cl-82802fa6"><p class="cl-828027fe"><span class="cl-827ee1aa">Model</span></p></th>
<th class="cl-82802fa6"><p class="cl-828027fe"><span class="cl-827ee1aa">Fit_Method</span></p></th>
<th class="cl-82802fb0"><p class="cl-82802808"><span class="cl-827ee1aa">mean_error</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Varied</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">ALM</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Test</span></p></td>
<td class="cl-82802fc4"><p class="cl-82802808"><span class="cl-827ee1aa">237.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Varied</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">ALM</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Test_Train</span></p></td>
<td class="cl-82802fc4"><p class="cl-82802808"><span class="cl-827ee1aa">276.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Varied</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">ALM</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Train</span></p></td>
<td class="cl-82802fc4"><p class="cl-82802808"><span class="cl-827ee1aa">296.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Varied</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">EXAM</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Test</span></p></td>
<td class="cl-82802fc4"><p class="cl-82802808"><span class="cl-827ee1aa">219.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Varied</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">EXAM</span></p></td>
<td class="cl-82802fba"><p class="cl-828027fe"><span class="cl-827ee1aa">Test_Train</span></p></td>
<td class="cl-82802fc4"><p class="cl-82802808"><span class="cl-827ee1aa">269.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-82802fc5"><p class="cl-828027fe"><span class="cl-827ee1aa">Varied</span></p></td>
<td class="cl-82802fc5"><p class="cl-828027fe"><span class="cl-827ee1aa">EXAM</span></p></td>
<td class="cl-82802fc5"><p class="cl-828027fe"><span class="cl-827ee1aa">Train</span></p></td>
<td class="cl-82802fce"><p class="cl-82802808"><span class="cl-827ee1aa">296.0</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat_l</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span>,<span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">summarise</span><span class="op">(</span>mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span>, n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">rank</span>,y<span class="op">=</span><span class="va">mean_error</span>,fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Fit_Method</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot_indv_posterior(ind_fits_df |&gt; filter(id==1))</span></span>
<span><span class="co"># ind_fits_df |&gt; filter(id==1, Fit_Method=="Test Only", Model=="EXAM") |&gt; pull(c) |&gt; unique()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="subject-36" class="level3"><h3 class="anchored" data-anchor-id="subject-36">Subject 36</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">indv_predictive_dist</span><span class="op">(</span><span class="va">post_dat_l</span>,<span class="va">ind_fits_df</span>, sbj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">36</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#abc_tables(post_dat_l |&gt; filter(id==36))$et_sum |&gt; gt::gt()</span></span>
<span></span>
<span><span class="fu">abc_tables</span><span class="op">(</span><span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span><span class="op">==</span><span class="fl">36</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">agg_full</span> <span class="op">|&gt;</span> <span class="fu">flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from full posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-837cd5f8{}.cl-8375cc7c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-837abf48{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-837abf52{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-837ac72c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-837ac736{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-837ac737{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-837ac740{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-837ac741{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-837ac742{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-837cd5f8">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-837ac72c"><p class="cl-837abf48"><span class="cl-8375cc7c">condit</span></p></th>
<th class="cl-837ac72c"><p class="cl-837abf48"><span class="cl-8375cc7c">Model</span></p></th>
<th class="cl-837ac72c"><p class="cl-837abf48"><span class="cl-8375cc7c">Fit_Method</span></p></th>
<th class="cl-837ac736"><p class="cl-837abf52"><span class="cl-8375cc7c">mean_error</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Varied</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">ALM</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Test</span></p></td>
<td class="cl-837ac740"><p class="cl-837abf52"><span class="cl-8375cc7c">221.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Varied</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">ALM</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Test_Train</span></p></td>
<td class="cl-837ac740"><p class="cl-837abf52"><span class="cl-8375cc7c">316.3</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Varied</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">ALM</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Train</span></p></td>
<td class="cl-837ac740"><p class="cl-837abf52"><span class="cl-8375cc7c">268.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Varied</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">EXAM</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Test</span></p></td>
<td class="cl-837ac740"><p class="cl-837abf52"><span class="cl-8375cc7c">214.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Varied</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">EXAM</span></p></td>
<td class="cl-837ac737"><p class="cl-837abf48"><span class="cl-8375cc7c">Test_Train</span></p></td>
<td class="cl-837ac740"><p class="cl-837abf52"><span class="cl-8375cc7c">305.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-837ac741"><p class="cl-837abf48"><span class="cl-8375cc7c">Varied</span></p></td>
<td class="cl-837ac741"><p class="cl-837abf48"><span class="cl-8375cc7c">EXAM</span></p></td>
<td class="cl-837ac741"><p class="cl-837abf48"><span class="cl-8375cc7c">Train</span></p></td>
<td class="cl-837ac742"><p class="cl-837abf52"><span class="cl-8375cc7c">269.3</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">abc_tables</span><span class="op">(</span><span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span><span class="op">==</span><span class="fl">36</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">agg_best</span> <span class="op">|&gt;</span> <span class="fu">flextable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">set_caption</span><span class="op">(</span><span class="st">"Mean from best parameters"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-8395c892{}.cl-83929d66{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-83940e3a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-83940e44{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8394163c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8394163d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83941646{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83941647{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83941650{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83941651{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-8395c892">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-8394163c"><p class="cl-83940e3a"><span class="cl-83929d66">condit</span></p></th>
<th class="cl-8394163c"><p class="cl-83940e3a"><span class="cl-83929d66">Model</span></p></th>
<th class="cl-8394163c"><p class="cl-83940e3a"><span class="cl-83929d66">Fit_Method</span></p></th>
<th class="cl-8394163d"><p class="cl-83940e44"><span class="cl-83929d66">mean_error</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Varied</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">ALM</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Test</span></p></td>
<td class="cl-83941647"><p class="cl-83940e44"><span class="cl-83929d66">216.3</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Varied</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">ALM</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Test_Train</span></p></td>
<td class="cl-83941647"><p class="cl-83940e44"><span class="cl-83929d66">315.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Varied</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">ALM</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Train</span></p></td>
<td class="cl-83941647"><p class="cl-83940e44"><span class="cl-83929d66">261.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Varied</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">EXAM</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Test</span></p></td>
<td class="cl-83941647"><p class="cl-83940e44"><span class="cl-83929d66">210.7</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Varied</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">EXAM</span></p></td>
<td class="cl-83941646"><p class="cl-83940e3a"><span class="cl-83929d66">Test_Train</span></p></td>
<td class="cl-83941647"><p class="cl-83940e44"><span class="cl-83929d66">296.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-83941650"><p class="cl-83940e3a"><span class="cl-83929d66">Varied</span></p></td>
<td class="cl-83941650"><p class="cl-83940e3a"><span class="cl-83929d66">EXAM</span></p></td>
<td class="cl-83941650"><p class="cl-83940e3a"><span class="cl-83929d66">Train</span></p></td>
<td class="cl-83941651"><p class="cl-83940e44"><span class="cl-83929d66">268.4</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot_indv_posterior(ind_fits_df |&gt; filter(id==1))</span></span>
<span><span class="co"># ind_fits_df |&gt; filter(id==1, Fit_Method=="Test Only", Model=="EXAM") |&gt; pull(c) |&gt; unique()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="more-comparisons" class="level2"><h2 class="anchored" data-anchor-id="more-comparisons">More Comparisons</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_id_x</span> <span class="op">&lt;-</span> <span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Model</span>,<span class="va">Fit_Method</span>,<span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>e2<span class="op">=</span><span class="op">(</span><span class="va">y</span><span class="op">-</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, pred<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>, mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">e2</span><span class="op">)</span>,abs_me<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>best<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">Model</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>n_best<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">best</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">best_id</span> <span class="op">&lt;-</span> <span class="va">best_id_x</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">Model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>, n_best<span class="op">=</span><span class="fu">first</span><span class="op">(</span><span class="va">n_best</span><span class="op">)</span>,abs_me<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">lowest_error_model</span> <span class="op">&lt;-</span> <span class="va">best_id</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>Best_Model <span class="op">=</span> <span class="va">Model</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">]</span>,</span>
<span>            n_best <span class="op">=</span> <span class="va">n_best</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">]</span>,</span>
<span>            Lowest_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>,</span>
<span>            differential <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">error_difference</span> <span class="op">&lt;-</span> <span class="va">best_id</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">condit</span>, <span class="va">Model</span>,<span class="va">Fit_Method</span>, <span class="va">mean_error</span>,<span class="va">abs_me</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Model</span>, values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">abs_me</span>,<span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Error_difference <span class="op">=</span> <span class="op">(</span><span class="va">mean_error_ALM</span> <span class="op">-</span> <span class="va">mean_error_EXAM</span><span class="op">)</span>, abs_error_dif <span class="op">=</span> <span class="op">(</span><span class="va">abs_me_ALM</span> <span class="op">-</span> <span class="va">abs_me_EXAM</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_comparison</span> <span class="op">&lt;-</span> <span class="va">lowest_error_model</span> <span class="op">|&gt;</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">error_difference</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"condit"</span>,<span class="st">"Fit_Method"</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">Best_Model</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>nGrp<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>, model_rank <span class="op">=</span> <span class="va">nGrp</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">Error_difference</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Fit_Method</span>,<span class="op">-</span><span class="va">Error_difference</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">best_id</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">id</span>,x<span class="op">=</span><span class="va">mean_error</span>,fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_grid2.html">facet_grid2</a></span><span class="op">(</span><span class="op">~</span><span class="va">condit</span>,axes<span class="op">=</span><span class="st">"all"</span>,scales<span class="op">=</span><span class="st">"free_y"</span>, independent <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_id</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">abs_me</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">id</span>,x<span class="op">=</span><span class="va">abs_me</span>,fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_grid2.html">facet_grid2</a></span><span class="op">(</span><span class="op">~</span><span class="va">condit</span>,axes<span class="op">=</span><span class="st">"all"</span>,scales<span class="op">=</span><span class="st">"free_y"</span>, independent <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">abs_error_dif</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">id</span>,x<span class="op">=</span><span class="va">abs_error_dif</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_grid2.html">facet_grid2</a></span><span class="op">(</span><span class="op">~</span><span class="va">condit</span>,axes<span class="op">=</span><span class="st">"all"</span>,scales<span class="op">=</span><span class="st">"free_y"</span>, independent <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">Error_difference</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">id</span>,x<span class="op">=</span><span class="va">Error_difference</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_grid2.html">facet_grid2</a></span><span class="op">(</span><span class="op">~</span><span class="va">condit</span>,axes<span class="op">=</span><span class="st">"all"</span>,scales<span class="op">=</span><span class="st">"free_y"</span>, independent <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-14-4.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">testAvg</span> <span class="op">|&gt;</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">full_comparison</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"condit"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">vb</span>,y<span class="op">=</span><span class="va">dist</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">stat_bar</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">Best_Model</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-14-5.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">Best_Model</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>nGrp2<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">Error_difference</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">vb</span>,y<span class="op">=</span><span class="va">dist</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">stat_bar</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">Best_Model</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-14-6.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">Best_Model</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">tally</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   condit, Fit_Method [2]
  condit   Fit_Method Best_Model     n
  &lt;fct&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;
1 Constant Test_Train ALM           31
2 Constant Test_Train EXAM          49
3 Varied   Test_Train ALM           46
4 Varied   Test_Train EXAM          30</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>,<span class="va">Fit_Method</span>,<span class="va">Best_Model</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">Error_difference</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tally</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   condit, Fit_Method [2]
  condit   Fit_Method Best_Model     n
  &lt;fct&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;
1 Constant Test_Train ALM           11
2 Constant Test_Train EXAM          35
3 Varied   Test_Train ALM           31
4 Varied   Test_Train EXAM          16</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">bandInt</span><span class="op">==</span><span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">condit</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">summarise</span><span class="op">(</span>m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Error_difference</span><span class="op">)</span>, </span>
<span>                                              sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Error_difference</span><span class="op">)</span>, </span>
<span>                                              n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,se<span class="op">=</span><span class="va">sd</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
# Groups:   condit [2]
  condit   Fit_Method     m    sd     n    se
  &lt;fct&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Constant Test_Train 27.6   59.3    80  6.63
2 Varied   Test_Train -8.98  54.6    76  6.27</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># head(map_id,2)</span></span>
<span><span class="co"># # A tibble: 2 × 13</span></span>
<span><span class="co"># # Groups:   id, condit, Model, Fit_Method [2]</span></span>
<span><span class="co">#   id    condit Fit_Method Model          c    lr mean_error  rank nTest nTrain nTotal     n   BIC</span></span>
<span><span class="co">#   &lt;fct&gt; &lt;fct&gt;  &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;</span></span>
<span><span class="co"># 1 1     Varied Test       ALM   0.00000165  5.32       238.     1    63     86    149    63 -6.80</span></span>
<span><span class="co"># 2 1     Varied Test_Train ALM   0.0000634   5.60       276.     1    63     86    149   149 -6.24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#full_comparison |&gt; round_tibble(1) |&gt; reactable(filterable=T,defaultPageSize=15)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">full_comparison</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Best_Model</span>, fill <span class="op">=</span> <span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Fit_Method</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Subjects Best Fit by Model"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Model with Lowest Error"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Count of Subjects"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Scatter plot showing the differential in mean error</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">full_comparison</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Error_difference</span>, y <span class="op">=</span> <span class="va">condit</span>, color <span class="op">=</span> <span class="va">Best_Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_pointinterval</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Fit_Method</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Differential in Mean Error Between Models"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Error Difference (ALM - EXAM)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ggplot(full_comparison, aes(x = Error_difference)) +</span></span>
<span><span class="co">#   geom_histogram(aes(fill=Best_Model),bins = 40, alpha = 0.7) +</span></span>
<span><span class="co">#   geom_vline(aes(xintercept = mean(Error_difference)), color = "red", linetype = "dashed", size = 1) +</span></span>
<span><span class="co">#   facet_wrap(~Fit_Method)+</span></span>
<span><span class="co">#   labs(</span></span>
<span><span class="co">#     title = "Distribution of Error Differential (ALM - EXAM)",</span></span>
<span><span class="co">#     x = "Error Differential",</span></span>
<span><span class="co">#     y = "Frequency"</span></span>
<span><span class="co">#   ) +</span></span>
<span><span class="co">#   theme_minimal()</span></span>
<span></span>
<span></span>
<span><span class="va">best_exam</span> <span class="op">&lt;-</span> <span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Best_Model</span><span class="op">==</span><span class="st">"EXAM"</span><span class="op">)</span> </span>
<span><span class="va">best_alm</span> <span class="op">&lt;-</span> <span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Best_Model</span><span class="op">==</span><span class="st">"ALM"</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">testAvg</span> <span class="op">|&gt;</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">full_comparison</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"condit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">vb</span>,y<span class="op">=</span><span class="va">dist</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">stat_bar</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">Best_Model</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">Error_difference</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">vb</span>,y<span class="op">=</span><span class="va">dist</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">stat_bar</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">Best_Model</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">vb</span>,y<span class="op">=</span><span class="va">vx</span>,fill<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">stat_bar</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">Best_Model</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-15-5.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Error_difference</span>,y<span class="op">=</span><span class="va">dist</span>,col<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">vb</span>,scales<span class="op">=</span><span class="st">"free"</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-15-6.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span>,<span class="va">condit</span>,<span class="va">Fit_Method</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">summarise</span><span class="op">(</span>Error_difference<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Error_difference</span><span class="op">)</span>,dist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Error_difference</span>,y<span class="op">=</span><span class="va">dist</span>,col<span class="op">=</span><span class="va">condit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Fit_Method</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-15-7.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ds |&gt; filter(expMode2=="Test", id %in% best_exam$id) |&gt; </span></span>
<span><span class="co">#   group_by(id,condit,x) |&gt; summarise(y=mean(y), dist=mean(abs(x-y))) |&gt;</span></span>
<span><span class="co">#   mutate(x=as.factor(x)) |&gt;</span></span>
<span><span class="co">#   ggplot(aes(x=x,y=dist,fill=condit)) + stat_bar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="best-test---exam-fits" class="level2"><h2 class="anchored" data-anchor-id="best-test---exam-fits">Best Test - EXAM Fits</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">strong_fits</span> <span class="op">&lt;-</span> <span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model_rank</span><span class="op">&lt;=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">strong_fits</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span>,<span class="va">Best_Model</span><span class="op">==</span><span class="st">"EXAM"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">indv_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">.</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
</section><section id="best-test---alm-fits" class="level2"><h2 class="anchored" data-anchor-id="best-test---alm-fits">Best Test - ALM Fits</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">strong_fits</span> <span class="op">&lt;-</span> <span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model_rank</span><span class="op">&lt;=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">strong_fits</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test"</span>,<span class="va">Best_Model</span><span class="op">==</span><span class="st">"ALM"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">indv_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">.</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
</section><section id="best-test_train---exam-fits" class="level2"><h2 class="anchored" data-anchor-id="best-test_train---exam-fits">Best Test_Train - EXAM Fits</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">strong_fits</span> <span class="op">&lt;-</span> <span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model_rank</span><span class="op">&lt;</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">strong_fits</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span>,<span class="va">Best_Model</span><span class="op">==</span><span class="st">"EXAM"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">indv_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">.</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
</section><section id="best-test_train---alm-fits" class="level2"><h2 class="anchored" data-anchor-id="best-test_train---alm-fits">Best Test_Train - ALM Fits</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">strong_fits</span> <span class="op">&lt;-</span> <span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model_rank</span><span class="op">&lt;=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">strong_fits</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Test_Train"</span>,<span class="va">Best_Model</span><span class="op">==</span><span class="st">"ALM"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">indv_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">.</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
</section><section id="best-train---exam-fits" class="level2"><h2 class="anchored" data-anchor-id="best-train---exam-fits">Best Train - EXAM Fits</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">strong_fits</span> <span class="op">&lt;-</span> <span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model_rank</span><span class="op">&lt;=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">strong_fits</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Train"</span>,<span class="va">Best_Model</span><span class="op">==</span><span class="st">"EXAM"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">indv_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">.</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
</section><section id="best-train---alm-fits" class="level2"><h2 class="anchored" data-anchor-id="best-train---alm-fits">Best Train - ALM Fits</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">strong_fits</span> <span class="op">&lt;-</span> <span class="va">full_comparison</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model_rank</span><span class="op">&lt;=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">strong_fits</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Train"</span>,<span class="va">Best_Model</span><span class="op">==</span><span class="st">"ALM"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">indv_predictive_plots</span><span class="op">(</span><span class="va">post_dat_l</span>, <span class="va">.</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
</section><section id="learning-curves" class="level2"><h2 class="anchored" data-anchor-id="learning-curves">Learning Curves</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pd_train_l</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Block</span>,y<span class="op">=</span><span class="va">dist</span>,col<span class="op">=</span><span class="va">Resp</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span> stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span> geom <span class="op">=</span> <span class="st">"line"</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>geom<span class="op">=</span><span class="st">"errorbar"</span>,fun.data<span class="op">=</span><span class="va">mean_se</span>,width<span class="op">=</span><span class="fl">.1</span>,alpha<span class="op">=</span><span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#facet_wrap(condit~x,scales="free")</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">condit</span><span class="op">~</span><span class="va">x</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#coord_cartesian(ylim = c(600, 1300)) +</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Full Posterior"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="1056"></p>
<figcaption>Learning Curves</figcaption></figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pd_train_l</span> <span class="op">|&gt;</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">rank</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Block</span>,y<span class="op">=</span><span class="va">val</span>,col<span class="op">=</span><span class="va">Resp</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span> stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span> geom <span class="op">=</span> <span class="st">"line"</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>geom<span class="op">=</span><span class="st">"errorbar"</span>,fun.data<span class="op">=</span><span class="va">mean_se</span>,width<span class="op">=</span><span class="fl">.1</span>,alpha<span class="op">=</span><span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#facet_wrap(condit~x,scales="free")</span></span>
<span>  <span class="fu">ggh4x</span><span class="fu">::</span><span class="fu"><a href="https://teunbrand.github.io/ggh4x/reference/facet_nested_wrap.html">facet_nested_wrap</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">~</span><span class="va">condit</span><span class="op">~</span><span class="va">x</span>,scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">1300</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Best Parameters"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="1056"></p>
<figcaption>Learning Curves</figcaption></figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pd_train_l</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Fit_Method</span><span class="op">==</span><span class="st">"Train"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, Resp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span>, Block<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Block</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">val</span>,fill<span class="op">=</span><span class="va">Block</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">stat_bar</span> <span class="op">+</span></span>
<span>  <span class="co">#facet_wrap(condit~x,scales="free")</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">Resp</span>,scales<span class="op">=</span><span class="st">"free"</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">1300</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid figure-img" width="1056"></p>
<figcaption>Learning Curves</figcaption></figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># pd_train_l |&gt; filter(id %in% c(1,33,66, 36,76), Fit_Method=="Train") |&gt; </span></span>
<span><span class="co">#   ggplot(aes(x=Block,y=val,col=Resp))+</span></span>
<span><span class="co">#   geom_point( stat = "summary", fun = mean) + </span></span>
<span><span class="co">#   stat_summary( geom = "line", fun = mean) +</span></span>
<span><span class="co">#   stat_summary(geom="errorbar",fun.data=mean_se,width=.1,alpha=.4) +</span></span>
<span><span class="co">#   #facet_wrap(condit~x,scales="free")</span></span>
<span><span class="co">#   facet_wrap(id~x,scales="free",ncol=3) +</span></span>
<span><span class="co">#   coord_cartesian(ylim = c(600, 1300))</span></span>
<span></span>
<span></span>
<span><span class="va">pd_train_l</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">#filter(id %in% c(1,33,66, 36,76), Fit_Method=="Train") |&gt; </span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, Resp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span>, Block<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Block</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">dist</span>,fill<span class="op">=</span><span class="va">Block</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">stat_bar</span> <span class="op">+</span></span>
<span>  <span class="co">#facet_wrap(condit~x,scales="free")</span></span>
<span>   <span class="co">#coord_cartesian(ylim = c(600, 1300)) +</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">id</span><span class="op">~</span><span class="va">Resp</span>,scales<span class="op">=</span><span class="st">"free"</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="e1_model_appendix_files/figure-html/unnamed-chunk-22-4.png" class="img-fluid figure-img" width="1056"></p>
<figcaption>Learning Curves</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Model</span>,y<span class="op">=</span><span class="va">mean_error</span>,fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Fit_Method</span><span class="op">)</span></span>
<span><span class="va">post_dat</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Model</span>,y<span class="op">=</span><span class="va">mean_error</span>,fill<span class="op">=</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">facet_wrap</span><span class="op">(</span><span class="va">condit</span><span class="op">~</span><span class="va">Fit_Method</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># post_tabs &lt;- map(post_tabs, ~cbind(.x,run_info) |&gt; mutate(fn=file_name))</span></span>
<span><span class="co"># post_tabs$agg_pred_full_train &lt;- pt_train$agg_pred_full</span></span>
<span><span class="co"># post_tabs$block_pred_full &lt;- pt_train$block_pred_full</span></span>
<span><span class="co"># post_tabs$block_pred_full_x &lt;- pt_train$block_pred_full_x</span></span>
<span></span>
<span><span class="co"># # path1 = "../../../data/abc_tabs"</span></span>
<span><span class="co"># saveRDS(post_tabs, paste0(path1, "/", tools::file_path_sans_ext(basename(file_name)),"_post_tab", ".rds"))</span></span>
<span><span class="co"># saveRDS(post_tabs, paste0(tools::file_path_sans_ext(basename(file_name)),"_post_tab", ".rds"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.tegorman13.github.io/htw\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../Misc/benchmarks.html" class="pagination-link" aria-label="Benchmarking">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Benchmarking</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb98" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> ABC-rejection models</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Thomas Gorman</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,purrr,tidyr,ggplot2, data.table, here, patchwork, conflicted, </span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>               stringr,future,furrr, knitr, reactable, flextable,ggstance, htmltools)</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer_all</span>(<span class="st">"dplyr"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(<span class="fu">c</span>(<span class="st">"Display_Functions"</span>,<span class="st">"fun_alm"</span>,<span class="st">"fun_indv_fit"</span>,<span class="st">"fun_model"</span>), <span class="sc">~</span> <span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"Functions/"</span>, .x, <span class="st">".R"</span>))))</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/e1_md_11-06-23.rds"</span>))  <span class="sc">|&gt;</span> <span class="fu">as.data.table</span>()</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data/e1_08-21-23.rds"</span>))</span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> fd <span class="sc">|&gt;</span> <span class="fu">filter</span>(expMode2 <span class="sc">==</span> <span class="st">"Test"</span>) </span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>testAvg <span class="ot">&lt;-</span> test <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id, condit, vb, bandInt,bandType,tOrder) <span class="sc">%&gt;%</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nHits=</span><span class="fu">sum</span>(dist<span class="sc">==</span><span class="dv">0</span>),<span class="at">vx=</span><span class="fu">mean</span>(vx),<span class="at">dist=</span><span class="fu">mean</span>(dist),<span class="at">sdist=</span><span class="fu">mean</span>(sdist),<span class="at">n=</span><span class="fu">n</span>(),<span class="at">Percent_Hit=</span>nHits<span class="sc">/</span>n)</span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>nbins<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>trainAvg <span class="ot">&lt;-</span> fd <span class="sc">|&gt;</span> <span class="fu">filter</span>(expMode2 <span class="sc">==</span> <span class="st">"Train"</span>) <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id) <span class="sc">|&gt;</span> </span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tr=</span>trial,<span class="at">x=</span>vb,<span class="at">Block=</span><span class="fu">case_when</span>(expMode2<span class="sc">==</span><span class="st">"Train"</span> <span class="sc">~</span> <span class="fu">cut</span>(tr,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">max</span>(tr), <span class="at">length.out=</span>nbins<span class="sc">+</span><span class="dv">1</span>),<span class="at">include.lowest=</span><span class="cn">TRUE</span>,<span class="at">labels=</span><span class="cn">FALSE</span>),</span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>                                         expMode2<span class="sc">==</span><span class="st">"Test"</span> <span class="sc">~</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id,condit,vb,x,Block) <span class="sc">|&gt;</span> </span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">dist=</span><span class="fu">mean</span>(dist),<span class="at">y=</span><span class="fu">mean</span>(vx))</span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a><span class="co"># df with trial count columns for each level of expMode, for each id</span></span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a>id_n <span class="ot">&lt;-</span> ds <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,condit) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">nTest=</span><span class="fu">n_distinct</span>(tr[expMode2<span class="sc">==</span><span class="st">"Test"</span>]),</span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">nTrain=</span><span class="fu">n_distinct</span>(tr[expMode2<span class="sc">==</span><span class="st">"Train"</span>])) <span class="sc">|&gt;</span></span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nTotal=</span>nTest<span class="sc">+</span>nTrain)</span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>testAvg <span class="ot">&lt;-</span> test <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id, condit, vb, bandInt,bandType,tOrder) <span class="sc">%&gt;%</span></span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nHits=</span><span class="fu">sum</span>(dist<span class="sc">==</span><span class="dv">0</span>),<span class="at">vx=</span><span class="fu">mean</span>(vx),<span class="at">dist=</span><span class="fu">mean</span>(dist),<span class="at">sdist=</span><span class="fu">mean</span>(sdist),<span class="at">n=</span><span class="fu">n</span>(),<span class="at">Percent_Hit=</span>nHits<span class="sc">/</span>n)</span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a>input_layer <span class="ot">&lt;&lt;-</span> output_layer <span class="ot">&lt;&lt;-</span>  <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">350</span>,<span class="dv">600</span>,<span class="dv">800</span>,<span class="dv">1000</span>,<span class="dv">1200</span>)</span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>)</span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a>ids2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">66</span>,<span class="dv">36</span>)</span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a>ids3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">71</span>,<span class="dv">101</span>,<span class="dv">4</span>,<span class="dv">76</span>,<span class="dv">192</span>)</span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a>idsBad <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">76</span>,<span class="dv">192</span>, <span class="dv">101</span>)</span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a><span class="co">#file_name &lt;- "n_iter_300_ntry_3000_0800"</span></span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a><span class="co">#file_name &lt;- "n_iter_100_ntry_200_4509"</span></span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">"n_iter_100_ntry_400_3247"</span></span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">"n_iter_200_ntry_300_5354"</span></span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a><span class="co"># list.files(here('data/abc_reject'))</span></span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a><span class="co"># (grep("Train",list.files(here(paste0('data/abc_reject/',file_name)),</span></span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            pattern="EXAM_Test",full.names = TRUE),</span></span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 invert=TRUE, value=TRUE))</span></span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a>ind_fits <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">list.files</span>(<span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">'data/abc_reject/'</span>),file_name),<span class="at">full.names=</span><span class="cn">TRUE</span>), readRDS)</span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a><span class="co"># ind_fits &lt;- map(list.files(here('data/abc_reject/n_iter_2000_ntry_10_2918'),full.names=TRUE), readRDS)</span></span>
<span id="cb98-69"><a href="#cb98-69" aria-hidden="true" tabindex="-1"></a>ind_fits_df <span class="ot">&lt;-</span> ind_fits <span class="sc">|&gt;</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">list</span>(<span class="at">dat=</span>.x[[<span class="dv">1</span>]], <span class="at">Model =</span> .x[[<span class="st">"Model"</span>]], <span class="at">Fit_Method=</span>.x[[<span class="st">"Fit_Method"</span>]]))</span>
<span id="cb98-70"><a href="#cb98-70" aria-hidden="true" tabindex="-1"></a>ind_fits_df <span class="ot">&lt;-</span> ind_fits_df <span class="sc">|&gt;</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">rbindlist</span>(.x<span class="sc">$</span>dat) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Model =</span> .x<span class="sc">$</span>Model, <span class="at">Fit_Method =</span> .x<span class="sc">$</span>Fit_Method)) <span class="sc">|&gt;</span> <span class="fu">rbindlist</span>() </span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a>avg_samples <span class="ot">&lt;-</span> ind_fits_df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,condit,Model,Fit_Method) <span class="sc">|&gt;</span> </span>
<span id="cb98-74"><a href="#cb98-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">inc=</span><span class="fu">max</span>(inc_count),<span class="at">iter_sum=</span><span class="fu">sum</span>(iter_count))</span>
<span id="cb98-75"><a href="#cb98-75" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(avg_samples<span class="sc">$</span>iter_sum)</span>
<span id="cb98-76"><a href="#cb98-76" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(avg_samples<span class="sc">$</span>iter_sum)</span>
<span id="cb98-77"><a href="#cb98-77" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(avg_samples<span class="sc">$</span>iter_sum)</span>
<span id="cb98-78"><a href="#cb98-78" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(avg_samples<span class="sc">$</span>iter_sum)</span>
<span id="cb98-79"><a href="#cb98-79" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(avg_samples<span class="sc">$</span>iter_sum)</span>
<span id="cb98-80"><a href="#cb98-80" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(avg_samples<span class="sc">$</span>iter_sum)</span>
<span id="cb98-81"><a href="#cb98-81" aria-hidden="true" tabindex="-1"></a>avg_samples <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Model,Fit_Method) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(inc),<span class="fu">mean</span>(iter_sum))</span>
<span id="cb98-82"><a href="#cb98-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-83"><a href="#cb98-83" aria-hidden="true" tabindex="-1"></a><span class="co">#run_params &lt;- tibble::lst(file_name,cMean=ind_fits[[1]]$cMean, cSig=ind_fits[[1]]$cSig, </span></span>
<span id="cb98-84"><a href="#cb98-84" aria-hidden="true" tabindex="-1"></a>                          </span>
<span id="cb98-85"><a href="#cb98-85" aria-hidden="true" tabindex="-1"></a>run_params <span class="ot">&lt;-</span> <span class="fu">keep</span>(ind_fits[[<span class="dv">1</span>]], <span class="sc">~</span><span class="fu">any</span>(<span class="fu">class</span>(.x) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"character"</span>, <span class="st">"numeric"</span>)))</span>
<span id="cb98-86"><a href="#cb98-86" aria-hidden="true" tabindex="-1"></a>run_params <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="sc">!!!</span>run_params) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>Model,<span class="sc">-</span>Fit_Method)</span>
<span id="cb98-87"><a href="#cb98-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-88"><a href="#cb98-88" aria-hidden="true" tabindex="-1"></a>extract_info <span class="ot">&lt;-</span> <span class="cf">function</span>(raw_names, run_params) {</span>
<span id="cb98-89"><a href="#cb98-89" aria-hidden="true" tabindex="-1"></a>  fname <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">file_path_sans_ext</span>(<span class="fu">basename</span>(raw_names))</span>
<span id="cb98-90"><a href="#cb98-90" aria-hidden="true" tabindex="-1"></a>  n_samp <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(raw_names, <span class="st">"(?&lt;=_)</span><span class="sc">\\</span><span class="st">d+(?=_)"</span>)</span>
<span id="cb98-91"><a href="#cb98-91" aria-hidden="true" tabindex="-1"></a>  ntry_ <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(raw_names, <span class="st">"(?&lt;=ntry_)</span><span class="sc">\\</span><span class="st">d+"</span>)</span>
<span id="cb98-92"><a href="#cb98-92" aria-hidden="true" tabindex="-1"></a>  type <span class="ot">&lt;-</span> <span class="st">'ss'</span></span>
<span id="cb98-93"><a href="#cb98-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(run_params, n_samp, ntry_, type, fname)</span>
<span id="cb98-94"><a href="#cb98-94" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-95"><a href="#cb98-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-96"><a href="#cb98-96" aria-hidden="true" tabindex="-1"></a>run_info <span class="ot">&lt;-</span> <span class="fu">extract_info</span>(file_name,run_params)</span>
<span id="cb98-97"><a href="#cb98-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-98"><a href="#cb98-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-99"><a href="#cb98-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-100"><a href="#cb98-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-103"><a href="#cb98-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-104"><a href="#cb98-104" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(Model, post_samples, data, <span class="at">num_samples =</span> <span class="dv">1</span>, <span class="at">return_dat =</span> <span class="st">"train_data, test_data"</span>) {</span>
<span id="cb98-105"><a href="#cb98-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data for the specific id without invalidating selfref</span></span>
<span id="cb98-106"><a href="#cb98-106" aria-hidden="true" tabindex="-1"></a>  sbj_data <span class="ot">&lt;-</span> <span class="fu">copy</span>(data[id <span class="sc">==</span> post_samples<span class="sc">$</span>id[<span class="dv">1</span>]])</span>
<span id="cb98-107"><a href="#cb98-107" aria-hidden="true" tabindex="-1"></a>  simulation_function <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Model <span class="sc">==</span> <span class="st">"EXAM"</span>, full_sim_exam, full_sim_alm)</span>
<span id="cb98-108"><a href="#cb98-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-109"><a href="#cb98-109" aria-hidden="true" tabindex="-1"></a>  target_data <span class="ot">&lt;-</span> <span class="cf">switch</span>(return_dat,</span>
<span id="cb98-110"><a href="#cb98-110" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"test_data"</span> <span class="ot">=</span> <span class="fu">copy</span>(sbj_data[expMode2 <span class="sc">==</span> <span class="st">"Test"</span>]),</span>
<span id="cb98-111"><a href="#cb98-111" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"train_data"</span> <span class="ot">=</span> <span class="fu">copy</span>(sbj_data[expMode2 <span class="sc">==</span> <span class="st">"Train"</span>]),</span>
<span id="cb98-112"><a href="#cb98-112" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"train_data, test_data"</span> <span class="ot">=</span> <span class="fu">copy</span>(sbj_data[expMode2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Test"</span>, <span class="st">"Train"</span>)]))</span>
<span id="cb98-113"><a href="#cb98-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-114"><a href="#cb98-114" aria-hidden="true" tabindex="-1"></a>  post_samples <span class="ot">&lt;-</span> post_samples[<span class="fu">order</span>(mean_error)][<span class="dv">1</span><span class="sc">:</span>num_samples, .(c, lr, mean_error, <span class="at">rank =</span> .I)]</span>
<span id="cb98-115"><a href="#cb98-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-116"><a href="#cb98-116" aria-hidden="true" tabindex="-1"></a>  simulated_data_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(post_samples), <span class="cf">function</span>(i) {</span>
<span id="cb98-117"><a href="#cb98-117" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">&lt;-</span> post_samples[i]</span>
<span id="cb98-118"><a href="#cb98-118" aria-hidden="true" tabindex="-1"></a>    sim_data <span class="ot">&lt;-</span> <span class="fu">simulation_function</span>(sbj_data, params<span class="sc">$</span>c, params<span class="sc">$</span>lr, <span class="at">input_layer =</span> input_layer, </span>
<span id="cb98-119"><a href="#cb98-119" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">output_layer =</span> output_layer, <span class="at">return_dat =</span> return_dat)</span>
<span id="cb98-120"><a href="#cb98-120" aria-hidden="true" tabindex="-1"></a>    sim_data_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">id =</span> sbj_data<span class="sc">$</span>id[<span class="dv">1</span>], <span class="at">condit =</span> sbj_data<span class="sc">$</span>condit[<span class="dv">1</span>], </span>
<span id="cb98-121"><a href="#cb98-121" aria-hidden="true" tabindex="-1"></a>                              <span class="at">expMode2 =</span> target_data<span class="sc">$</span>expMode2, <span class="at">Model =</span> Model,<span class="at">tr=</span>target_data<span class="sc">$</span>tr,</span>
<span id="cb98-122"><a href="#cb98-122" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> target_data<span class="sc">$</span>y, <span class="at">x =</span> target_data<span class="sc">$</span>x, <span class="at">c =</span> params<span class="sc">$</span>c, </span>
<span id="cb98-123"><a href="#cb98-123" aria-hidden="true" tabindex="-1"></a>                              <span class="at">lr =</span> params<span class="sc">$</span>lr, <span class="at">mean_error =</span> params<span class="sc">$</span>mean_error, <span class="at">rank =</span> i,</span>
<span id="cb98-124"><a href="#cb98-124" aria-hidden="true" tabindex="-1"></a>                              <span class="at">pred =</span> sim_data)</span>
<span id="cb98-125"><a href="#cb98-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(sim_data_dt)</span>
<span id="cb98-126"><a href="#cb98-126" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb98-127"><a href="#cb98-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-128"><a href="#cb98-128" aria-hidden="true" tabindex="-1"></a>  result_dt <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(simulated_data_list)</span>
<span id="cb98-129"><a href="#cb98-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setcolorder</span>(result_dt, <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"condit"</span>, <span class="st">"expMode2"</span>,<span class="st">"tr"</span>, <span class="st">"c"</span>, <span class="st">"lr"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"pred"</span>))</span>
<span id="cb98-130"><a href="#cb98-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result_dt)</span>
<span id="cb98-131"><a href="#cb98-131" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-132"><a href="#cb98-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-133"><a href="#cb98-133" aria-hidden="true" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(multisession)</span>
<span id="cb98-134"><a href="#cb98-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-135"><a href="#cb98-135" aria-hidden="true" tabindex="-1"></a>nestSbjModelFit <span class="ot">&lt;-</span> ind_fits_df <span class="sc">%&gt;%</span> <span class="fu">nest</span>(<span class="at">.by=</span><span class="fu">c</span>(id,Model,Fit_Method))</span>
<span id="cb98-136"><a href="#cb98-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-137"><a href="#cb98-137" aria-hidden="true" tabindex="-1"></a><span class="co"># organize test data predictions</span></span>
<span id="cb98-138"><a href="#cb98-138" aria-hidden="true" tabindex="-1"></a>post_dat <span class="ot">&lt;-</span> nestSbjModelFit <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">pp=</span>furrr<span class="sc">::</span><span class="fu">future_pmap</span>(<span class="fu">list</span>(id,Model,Fit_Method,data), <span class="sc">~</span>{</span>
<span id="cb98-139"><a href="#cb98-139" aria-hidden="true" tabindex="-1"></a>   <span class="fu">generate_data</span>(..<span class="dv">2</span>, ..<span class="dv">4</span> <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">id=</span>..<span class="dv">1</span>), ds, <span class="at">num_samples =</span> <span class="dv">20</span>, <span class="at">return_dat=</span><span class="st">"test_data"</span>)</span>
<span id="cb98-140"><a href="#cb98-140" aria-hidden="true" tabindex="-1"></a>   })) <span class="sc">|&gt;</span> </span>
<span id="cb98-141"><a href="#cb98-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Fit_Method,pp,<span class="sc">-</span>data) <span class="sc">|&gt;</span>  </span>
<span id="cb98-142"><a href="#cb98-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pp) <span class="sc">|&gt;</span>  <span class="fu">filter</span>(expMode2<span class="sc">==</span><span class="st">"Test"</span>) <span class="sc">|&gt;</span> <span class="fu">as.data.table</span>()</span>
<span id="cb98-143"><a href="#cb98-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-144"><a href="#cb98-144" aria-hidden="true" tabindex="-1"></a>post_dat_avg <span class="ot">&lt;-</span> post_dat <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id, condit, Model, Fit_Method, x, c, lr, rank) <span class="sc">|&gt;</span> </span>
<span id="cb98-145"><a href="#cb98-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y =</span> <span class="fu">mean</span>(y), <span class="at">pred =</span> <span class="fu">mean</span>(pred), <span class="at">error =</span> y <span class="sc">-</span> pred) <span class="sc">|&gt;</span> <span class="fu">as.data.table</span>() </span>
<span id="cb98-146"><a href="#cb98-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-147"><a href="#cb98-147" aria-hidden="true" tabindex="-1"></a>post_dat_avg2 <span class="ot">&lt;-</span> post_dat_avg <span class="sc">|&gt;</span></span>
<span id="cb98-148"><a href="#cb98-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id, condit, Model, Fit_Method, c, lr, rank) <span class="sc">|&gt;</span> </span>
<span id="cb98-149"><a href="#cb98-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y =</span> <span class="fu">mean</span>(y), <span class="at">pred =</span> <span class="fu">mean</span>(pred), <span class="at">error =</span> y <span class="sc">-</span> pred) <span class="sc">|&gt;</span> <span class="fu">as.data.table</span>() <span class="sc">|&gt;</span> <span class="fu">arrange</span>(rank)</span>
<span id="cb98-150"><a href="#cb98-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-151"><a href="#cb98-151" aria-hidden="true" tabindex="-1"></a>map_id <span class="ot">&lt;-</span> post_dat <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id, condit, Model, Fit_Method) <span class="sc">|&gt;</span> </span>
<span id="cb98-152"><a href="#cb98-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(id,condit,Fit_Method,Model,c,lr,mean_error,rank) <span class="sc">|&gt;</span></span>
<span id="cb98-153"><a href="#cb98-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_n,<span class="at">by=</span>(<span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"condit"</span>)))</span>
<span id="cb98-154"><a href="#cb98-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-155"><a href="#cb98-155" aria-hidden="true" tabindex="-1"></a><span class="co"># compute BIC for each row of map_id; p=2 for c and lr</span></span>
<span id="cb98-156"><a href="#cb98-156" aria-hidden="true" tabindex="-1"></a>map_id <span class="ot">&lt;-</span> map_id <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">fifelse</span>(Fit_Method <span class="sc">==</span> <span class="st">"Test"</span>, nTest, <span class="fu">fifelse</span>(Fit_Method <span class="sc">==</span> <span class="st">"Train"</span>, nTrain, nTotal)),<span class="at">BIC =</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(mean_error) <span class="sc">+</span> <span class="fu">log</span>(n)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb98-157"><a href="#cb98-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-158"><a href="#cb98-158" aria-hidden="true" tabindex="-1"></a>bic_id <span class="ot">&lt;-</span> map_id <span class="sc">%&gt;%</span></span>
<span id="cb98-159"><a href="#cb98-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id, Fit_Method) <span class="sc">%&gt;%</span></span>
<span id="cb98-160"><a href="#cb98-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Model) <span class="sc">%&gt;%</span></span>
<span id="cb98-161"><a href="#cb98-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">BIC_diff =</span> <span class="fu">diff</span>(BIC),</span>
<span id="cb98-162"><a href="#cb98-162" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-163"><a href="#cb98-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(map_id, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"Fit_Method"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb98-164"><a href="#cb98-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, Fit_Method, Model, BIC, BIC_diff)</span>
<span id="cb98-165"><a href="#cb98-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-166"><a href="#cb98-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-167"><a href="#cb98-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-168"><a href="#cb98-168" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(post_dat_avg, id, x, rank)</span>
<span id="cb98-169"><a href="#cb98-169" aria-hidden="true" tabindex="-1"></a>post_dat_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(post_dat_avg, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"condit"</span>, <span class="st">"Model"</span>, <span class="st">"Fit_Method"</span>, <span class="st">"x"</span>, <span class="st">"c"</span>, <span class="st">"lr"</span>, <span class="st">"rank"</span>,<span class="st">"error"</span>),</span>
<span id="cb98-170"><a href="#cb98-170" aria-hidden="true" tabindex="-1"></a>                   <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"pred"</span>, <span class="st">"y"</span>), <span class="at">variable.name =</span> <span class="st">"Resp"</span>, <span class="at">value.name =</span> <span class="st">"val"</span>)</span>
<span id="cb98-171"><a href="#cb98-171" aria-hidden="true" tabindex="-1"></a>post_dat_l[, Resp <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(Resp <span class="sc">==</span> <span class="st">"y"</span>, <span class="st">"Observed"</span>,</span>
<span id="cb98-172"><a href="#cb98-172" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">fifelse</span>(Model <span class="sc">==</span> <span class="st">"ALM"</span>, <span class="st">"ALM"</span>, <span class="st">"EXAM"</span>))]</span>
<span id="cb98-173"><a href="#cb98-173" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(post_dat_l, id, Resp)</span>
<span id="cb98-174"><a href="#cb98-174" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(post_dat_avg)</span></span>
<span id="cb98-175"><a href="#cb98-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-176"><a href="#cb98-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-177"><a href="#cb98-177" aria-hidden="true" tabindex="-1"></a><span class="co"># organize training data predictions</span></span>
<span id="cb98-178"><a href="#cb98-178" aria-hidden="true" tabindex="-1"></a>pd_train <span class="ot">&lt;-</span> nestSbjModelFit <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">pp=</span>furrr<span class="sc">::</span><span class="fu">future_pmap</span>(<span class="fu">list</span>(id,Model,Fit_Method,data), <span class="sc">~</span>{</span>
<span id="cb98-179"><a href="#cb98-179" aria-hidden="true" tabindex="-1"></a>   <span class="fu">generate_data</span>(..<span class="dv">2</span>, ..<span class="dv">4</span> <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">id=</span>..<span class="dv">1</span>), ds, <span class="at">num_samples =</span> <span class="dv">20</span>, <span class="at">return_dat=</span><span class="st">"train_data"</span>)</span>
<span id="cb98-180"><a href="#cb98-180" aria-hidden="true" tabindex="-1"></a>   })) <span class="sc">|&gt;</span></span>
<span id="cb98-181"><a href="#cb98-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Fit_Method,pp,<span class="sc">-</span>data) <span class="sc">|&gt;</span></span>
<span id="cb98-182"><a href="#cb98-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pp) <span class="sc">|&gt;</span> <span class="fu">as.data.table</span>() <span class="sc">|&gt;</span> <span class="fu">filter</span>(expMode2<span class="sc">==</span><span class="st">"Train"</span>)</span>
<span id="cb98-183"><a href="#cb98-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-184"><a href="#cb98-184" aria-hidden="true" tabindex="-1"></a>nbins <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb98-185"><a href="#cb98-185" aria-hidden="true" tabindex="-1"></a>pd_train <span class="ot">&lt;-</span> pd_train <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,condit,Model,Fit_Method) <span class="sc">|&gt;</span></span>
<span id="cb98-186"><a href="#cb98-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Block=</span><span class="fu">cut</span>(tr,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">max</span>(tr), <span class="at">length.out=</span>nbins<span class="sc">+</span><span class="dv">1</span>),<span class="at">include.lowest=</span><span class="cn">TRUE</span>,<span class="at">labels=</span><span class="cn">FALSE</span>))</span>
<span id="cb98-187"><a href="#cb98-187" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(pd_train, id, x,Block, rank)</span>
<span id="cb98-188"><a href="#cb98-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-189"><a href="#cb98-189" aria-hidden="true" tabindex="-1"></a>pd_train_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(pd_train, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"condit"</span>, <span class="st">"Model"</span>,<span class="st">"Block"</span>, <span class="st">"Fit_Method"</span>, <span class="st">"x"</span>, <span class="st">"c"</span>, <span class="st">"lr"</span>, <span class="st">"rank"</span>),</span>
<span id="cb98-190"><a href="#cb98-190" aria-hidden="true" tabindex="-1"></a>                   <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"pred"</span>, <span class="st">"y"</span>), <span class="at">variable.name =</span> <span class="st">"Resp"</span>, <span class="at">value.name =</span> <span class="st">"val"</span>) <span class="sc">|&gt;</span> <span class="fu">as.data.table</span>()</span>
<span id="cb98-191"><a href="#cb98-191" aria-hidden="true" tabindex="-1"></a>pd_train_l[, Resp <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(Resp <span class="sc">==</span> <span class="st">"y"</span>, <span class="st">"Observed"</span>,</span>
<span id="cb98-192"><a href="#cb98-192" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">fifelse</span>(Model <span class="sc">==</span> <span class="st">"ALM"</span>, <span class="st">"ALM"</span>, <span class="st">"EXAM"</span>))] </span>
<span id="cb98-193"><a href="#cb98-193" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(pd_train_l, id,Block, Resp) </span>
<span id="cb98-194"><a href="#cb98-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-195"><a href="#cb98-195" aria-hidden="true" tabindex="-1"></a>pd_train_l <span class="ot">&lt;-</span> pd_train_l <span class="sc">|&gt;</span></span>
<span id="cb98-196"><a href="#cb98-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist =</span> <span class="fu">case_when</span>(</span>
<span id="cb98-197"><a href="#cb98-197" aria-hidden="true" tabindex="-1"></a>    val <span class="sc">&gt;=</span> x <span class="sc">&amp;</span> val <span class="sc">&lt;=</span> x <span class="sc">+</span> <span class="dv">200</span> <span class="sc">~</span> <span class="dv">0</span>,                 </span>
<span id="cb98-198"><a href="#cb98-198" aria-hidden="true" tabindex="-1"></a>    val <span class="sc">&lt;</span> x <span class="sc">~</span> <span class="fu">abs</span>(x <span class="sc">-</span> val),                       </span>
<span id="cb98-199"><a href="#cb98-199" aria-hidden="true" tabindex="-1"></a>    val <span class="sc">&gt;</span> x <span class="sc">+</span> <span class="dv">200</span> <span class="sc">~</span> <span class="fu">abs</span>(val <span class="sc">-</span> (x <span class="sc">+</span> <span class="dv">200</span>)),           </span>
<span id="cb98-200"><a href="#cb98-200" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>                                 </span>
<span id="cb98-201"><a href="#cb98-201" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb98-202"><a href="#cb98-202" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span>
<span id="cb98-203"><a href="#cb98-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-204"><a href="#cb98-204" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span>
<span id="cb98-205"><a href="#cb98-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-206"><a href="#cb98-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-207"><a href="#cb98-207" aria-hidden="true" tabindex="-1"></a><span class="co"># theta_map &lt;- post_dat_avg |&gt; group_by(condit,Model,Fit_Method) |&gt; summarize(c=median(c),lr=median(lr))</span></span>
<span id="cb98-208"><a href="#cb98-208" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb98-209"><a href="#cb98-209" aria-hidden="true" tabindex="-1"></a><span class="co"># map &lt;- simulation_function(sbj_data &lt;- ds |&gt; theta_map$c[1], , params$lr, input_layer = input_layer, </span></span>
<span id="cb98-210"><a href="#cb98-210" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     output_layer = output_layer, return_dat = return_dat)</span></span>
<span id="cb98-211"><a href="#cb98-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-212"><a href="#cb98-212" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC and BIC</span></span>
<span id="cb98-213"><a href="#cb98-213" aria-hidden="true" tabindex="-1"></a><span class="co"># mc2 &lt;- post_dat |&gt; filter(rank==1) |&gt;</span></span>
<span id="cb98-214"><a href="#cb98-214" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(id,condit,Model,Fit_Method) |&gt;</span></span>
<span id="cb98-215"><a href="#cb98-215" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(e2=abs(y-pred),n=n(),k=2) |&gt;</span></span>
<span id="cb98-216"><a href="#cb98-216" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(id,condit,Model,Fit_Method,x) |&gt;</span></span>
<span id="cb98-217"><a href="#cb98-217" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(y=mean(y), pred=mean(pred), e2=mean(e2), mean_error=first(mean_error),n=first(n),k=first(k)) |&gt;</span></span>
<span id="cb98-218"><a href="#cb98-218" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(id,condit,Model,Fit_Method) |&gt;</span></span>
<span id="cb98-219"><a href="#cb98-219" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(e2=mean(e2), mean_error=first(mean_error),n=first(n),k=first(k)) |&gt;</span></span>
<span id="cb98-220"><a href="#cb98-220" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(AIC=2*k+n*mean_error, BIC=log(n)*k+n*mean_error)</span></span>
<span id="cb98-221"><a href="#cb98-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-222"><a href="#cb98-222" aria-hidden="true" tabindex="-1"></a><span class="co"># Single run extraction:</span></span>
<span id="cb98-223"><a href="#cb98-223" aria-hidden="true" tabindex="-1"></a><span class="co"># exam_test &lt;- ind_fits_df |&gt; filter(Model == "EXAM", Fit_Method == "Test")</span></span>
<span id="cb98-224"><a href="#cb98-224" aria-hidden="true" tabindex="-1"></a><span class="co"># post_dat_trial &lt;- exam_test %&gt;% split(f =c(.$id), drop=TRUE) |&gt; </span></span>
<span id="cb98-225"><a href="#cb98-225" aria-hidden="true" tabindex="-1"></a><span class="co">#   map(~generate_data(.x$Model, .x, ds, num_samples = 15, return_dat="train_data, test_data")) |&gt; </span></span>
<span id="cb98-226"><a href="#cb98-226" aria-hidden="true" tabindex="-1"></a><span class="co">#   rbindlist() |&gt; </span></span>
<span id="cb98-227"><a href="#cb98-227" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(expMode2=="Test")</span></span>
<span id="cb98-228"><a href="#cb98-228" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb98-229"><a href="#cb98-229" aria-hidden="true" tabindex="-1"></a><span class="co"># post_dat_avg &lt;- post_dat_trial |&gt; group_by(id,condit,x,c,lr,rank) |&gt; </span></span>
<span id="cb98-230"><a href="#cb98-230" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(y = mean(y),pred = mean(pred)) |&gt; arrange(id,x,rank)</span></span>
<span id="cb98-231"><a href="#cb98-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-232"><a href="#cb98-232" aria-hidden="true" tabindex="-1"></a><span class="co">#post_dat_l |&gt; filter(Model == "EXAM", Fit_Method == "Test",id==1) |&gt; arrange(rank)</span></span>
<span id="cb98-233"><a href="#cb98-233" aria-hidden="true" tabindex="-1"></a><span class="co"># head(post_dat_l)</span></span>
<span id="cb98-234"><a href="#cb98-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-235"><a href="#cb98-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-236"><a href="#cb98-236" aria-hidden="true" tabindex="-1"></a>bestTestEXAM <span class="ot">&lt;-</span> post_dat_l <span class="sc">|&gt;</span> </span>
<span id="cb98-237"><a href="#cb98-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Fit_Method<span class="sc">==</span><span class="st">"Test"</span>, rank<span class="sc">==</span><span class="dv">1</span>, Resp<span class="sc">==</span><span class="st">"EXAM"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-238"><a href="#cb98-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id,condit,Model,Fit_Method) <span class="sc">|&gt;</span></span>
<span id="cb98-239"><a href="#cb98-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mae=</span><span class="fu">mean</span>(<span class="fu">abs</span>(error))) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mae) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-240"><a href="#cb98-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_rank =</span> <span class="fu">row_number</span>(),<span class="at">.by=</span><span class="fu">c</span>(condit))</span>
<span id="cb98-241"><a href="#cb98-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-242"><a href="#cb98-242" aria-hidden="true" tabindex="-1"></a>bestTestALM<span class="ot">&lt;-</span> post_dat_l <span class="sc">|&gt;</span> </span>
<span id="cb98-243"><a href="#cb98-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Fit_Method<span class="sc">==</span><span class="st">"Test"</span>, rank<span class="sc">==</span><span class="dv">1</span>, Resp<span class="sc">==</span><span class="st">"ALM"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-244"><a href="#cb98-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id,condit,Model,Fit_Method) <span class="sc">|&gt;</span></span>
<span id="cb98-245"><a href="#cb98-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mae=</span><span class="fu">mean</span>(<span class="fu">abs</span>(error))) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mae) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-246"><a href="#cb98-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_rank =</span> <span class="fu">row_number</span>(),<span class="at">.by=</span><span class="fu">c</span>(condit))</span>
<span id="cb98-247"><a href="#cb98-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-248"><a href="#cb98-248" aria-hidden="true" tabindex="-1"></a>bestTrainALM<span class="ot">&lt;-</span> post_dat_l <span class="sc">|&gt;</span> </span>
<span id="cb98-249"><a href="#cb98-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Fit_Method<span class="sc">==</span><span class="st">"Train"</span>, rank<span class="sc">==</span><span class="dv">1</span>, Resp<span class="sc">==</span><span class="st">"ALM"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-250"><a href="#cb98-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id,condit,Model,Fit_Method) <span class="sc">|&gt;</span></span>
<span id="cb98-251"><a href="#cb98-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mae=</span><span class="fu">mean</span>(<span class="fu">abs</span>(error))) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mae) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-252"><a href="#cb98-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_rank =</span> <span class="fu">row_number</span>(),<span class="at">.by=</span><span class="fu">c</span>(condit))</span>
<span id="cb98-253"><a href="#cb98-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-254"><a href="#cb98-254" aria-hidden="true" tabindex="-1"></a>bestTrainEXAM<span class="ot">&lt;-</span> post_dat_l <span class="sc">|&gt;</span> </span>
<span id="cb98-255"><a href="#cb98-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Fit_Method<span class="sc">==</span><span class="st">"Train"</span>, rank<span class="sc">==</span><span class="dv">1</span>, Resp<span class="sc">==</span><span class="st">"EXAM"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-256"><a href="#cb98-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id,condit,Model,Fit_Method) <span class="sc">|&gt;</span></span>
<span id="cb98-257"><a href="#cb98-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mae=</span><span class="fu">mean</span>(<span class="fu">abs</span>(error))) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mae) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-258"><a href="#cb98-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_rank =</span> <span class="fu">row_number</span>(),<span class="at">.by=</span><span class="fu">c</span>(condit))</span>
<span id="cb98-259"><a href="#cb98-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-260"><a href="#cb98-260" aria-hidden="true" tabindex="-1"></a>bestTtEXAM <span class="ot">&lt;-</span> post_dat_l <span class="sc">|&gt;</span> </span>
<span id="cb98-261"><a href="#cb98-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Fit_Method<span class="sc">==</span><span class="st">"Test_Train"</span>, rank<span class="sc">==</span><span class="dv">1</span>, Resp<span class="sc">==</span><span class="st">"EXAM"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-262"><a href="#cb98-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id,condit,Model,Fit_Method) <span class="sc">|&gt;</span></span>
<span id="cb98-263"><a href="#cb98-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mae=</span><span class="fu">mean</span>(<span class="fu">abs</span>(error))) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mae) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-264"><a href="#cb98-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_rank =</span> <span class="fu">row_number</span>(),<span class="at">.by=</span><span class="fu">c</span>(condit))</span>
<span id="cb98-265"><a href="#cb98-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-266"><a href="#cb98-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-267"><a href="#cb98-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-268"><a href="#cb98-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-269"><a href="#cb98-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-270"><a href="#cb98-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-271"><a href="#cb98-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-272"><a href="#cb98-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-273"><a href="#cb98-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-274"><a href="#cb98-274" aria-hidden="true" tabindex="-1"></a><span class="fu">#### </span></span>
<span id="cb98-275"><a href="#cb98-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-276"><a href="#cb98-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-277"><a href="#cb98-277" aria-hidden="true" tabindex="-1"></a><span class="fu">##  Posterior Average Table </span></span>
<span id="cb98-278"><a href="#cb98-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=12, fig.height=17}</span></span>
<span id="cb98-279"><a href="#cb98-279" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb98-280"><a href="#cb98-280" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "Posterior Distribution"</span></span>
<span id="cb98-281"><a href="#cb98-281" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-subcap: </span></span>
<span id="cb98-282"><a href="#cb98-282" aria-hidden="true" tabindex="-1"></a><span class="in">#| - "Full Posterior"</span></span>
<span id="cb98-283"><a href="#cb98-283" aria-hidden="true" tabindex="-1"></a><span class="in">#| - "Best Posterior"</span></span>
<span id="cb98-284"><a href="#cb98-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-285"><a href="#cb98-285" aria-hidden="true" tabindex="-1"></a><span class="in"># post_tabs &lt;- abc_tables(post_dat_l)</span></span>
<span id="cb98-286"><a href="#cb98-286" aria-hidden="true" tabindex="-1"></a><span class="in"># post_tabs$et_sum |&gt; gt::gt()</span></span>
<span id="cb98-287"><a href="#cb98-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-288"><a href="#cb98-288" aria-hidden="true" tabindex="-1"></a><span class="in">post_tabs &lt;- abc_tables(post_dat,post_dat_l)</span></span>
<span id="cb98-289"><a href="#cb98-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-290"><a href="#cb98-290" aria-hidden="true" tabindex="-1"></a><span class="in"># tables with fit error</span></span>
<span id="cb98-291"><a href="#cb98-291" aria-hidden="true" tabindex="-1"></a><span class="in"># post_tabs$agg_full |&gt; flextable::tabulator(rows=c("Fit_Method","Model"), columns=c("condit"), </span></span>
<span id="cb98-292"><a href="#cb98-292" aria-hidden="true" tabindex="-1"></a><span class="in">#                        `ME` = as_paragraph(mean_error)) |&gt; as_flextable() |&gt;</span></span>
<span id="cb98-293"><a href="#cb98-293" aria-hidden="true" tabindex="-1"></a><span class="in">#   set_caption("Mean from full_posterior") </span></span>
<span id="cb98-294"><a href="#cb98-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-295"><a href="#cb98-295" aria-hidden="true" tabindex="-1"></a><span class="in"># post_tabs$agg_best |&gt; flextable::tabulator(rows=c("Fit_Method","Model"), columns=c("condit"), </span></span>
<span id="cb98-296"><a href="#cb98-296" aria-hidden="true" tabindex="-1"></a><span class="in">#                        `ME` = as_paragraph(mean_error)) |&gt; as_flextable() |&gt;</span></span>
<span id="cb98-297"><a href="#cb98-297" aria-hidden="true" tabindex="-1"></a><span class="in">#   set_caption("Mean from best parameters") </span></span>
<span id="cb98-298"><a href="#cb98-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-299"><a href="#cb98-299" aria-hidden="true" tabindex="-1"></a><span class="in">post_tabs$agg_pred_full |&gt; flextable::tabulator(rows=c("Fit_Method","Model"), columns=c("condit"), </span></span>
<span id="cb98-300"><a href="#cb98-300" aria-hidden="true" tabindex="-1"></a><span class="in">                       `ME` = as_paragraph(mean_error)) |&gt; as_flextable() |&gt;</span></span>
<span id="cb98-301"><a href="#cb98-301" aria-hidden="true" tabindex="-1"></a><span class="in">  set_caption("Mean from full_posterior") </span></span>
<span id="cb98-302"><a href="#cb98-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-303"><a href="#cb98-303" aria-hidden="true" tabindex="-1"></a><span class="in">post_tabs$agg_pred_best |&gt; flextable::tabulator(rows=c("Fit_Method","Model"), columns=c("condit"), </span></span>
<span id="cb98-304"><a href="#cb98-304" aria-hidden="true" tabindex="-1"></a><span class="in">                       `ME` = as_paragraph(mean_error)) |&gt; as_flextable() |&gt;</span></span>
<span id="cb98-305"><a href="#cb98-305" aria-hidden="true" tabindex="-1"></a><span class="in">  set_caption("Mean from full_posterior") </span></span>
<span id="cb98-306"><a href="#cb98-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-307"><a href="#cb98-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-308"><a href="#cb98-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-309"><a href="#cb98-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-310"><a href="#cb98-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-311"><a href="#cb98-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interactive Test Predictions Table</span></span>
<span id="cb98-314"><a href="#cb98-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-315"><a href="#cb98-315" aria-hidden="true" tabindex="-1"></a>tags<span class="sc">$</span><span class="fu">select</span>(</span>
<span id="cb98-316"><a href="#cb98-316" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">option</span>(<span class="at">value =</span> <span class="st">""</span>, <span class="st">"All"</span>),</span>
<span id="cb98-317"><a href="#cb98-317" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="fu">unique</span>(post_tabs<span class="sc">$</span>agg_x_full<span class="sc">$</span>condit), tags<span class="sc">$</span>option),</span>
<span id="cb98-318"><a href="#cb98-318" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map</span>(<span class="fu">unique</span>(post_tabs<span class="sc">$</span>agg_x_full<span class="sc">$</span>Model), tags<span class="sc">$</span>option),</span>
<span id="cb98-319"><a href="#cb98-319" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map</span>(<span class="fu">unique</span>(post_tabs<span class="sc">$</span>agg_x_full<span class="sc">$</span>Fit_Method), tags<span class="sc">$</span>option),</span>
<span id="cb98-320"><a href="#cb98-320" aria-hidden="true" tabindex="-1"></a>   purrr<span class="sc">::</span><span class="fu">map</span>(<span class="fu">unique</span>(post_tabs<span class="sc">$</span>agg_x_full<span class="sc">$</span>x), tags<span class="sc">$</span>option)</span>
<span id="cb98-321"><a href="#cb98-321" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-322"><a href="#cb98-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-323"><a href="#cb98-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-324"><a href="#cb98-324" aria-hidden="true" tabindex="-1"></a>selectFilter <span class="ot">&lt;-</span> <span class="cf">function</span>(tableId, <span class="at">style =</span> <span class="st">"width: 100%; height: 100%;"</span>) {</span>
<span id="cb98-325"><a href="#cb98-325" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(values, name) {</span>
<span id="cb98-326"><a href="#cb98-326" aria-hidden="true" tabindex="-1"></a>    tags<span class="sc">$</span><span class="fu">select</span>(</span>
<span id="cb98-327"><a href="#cb98-327" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Set to undefined to clear the filter</span></span>
<span id="cb98-328"><a href="#cb98-328" aria-hidden="true" tabindex="-1"></a>      <span class="at">onchange =</span> <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb98-329"><a href="#cb98-329" aria-hidden="true" tabindex="-1"></a><span class="st">        const value = event.target.value</span></span>
<span id="cb98-330"><a href="#cb98-330" aria-hidden="true" tabindex="-1"></a><span class="st">        Reactable.setFilter('%s', '%s', value === '__ALL__' ? undefined : value)</span></span>
<span id="cb98-331"><a href="#cb98-331" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>, tableId, name),</span>
<span id="cb98-332"><a href="#cb98-332" aria-hidden="true" tabindex="-1"></a>      <span class="co"># "All" has a special value to clear the filter, and is the default option</span></span>
<span id="cb98-333"><a href="#cb98-333" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">option</span>(<span class="at">value =</span> <span class="st">"__ALL__"</span>, <span class="st">"All"</span>),</span>
<span id="cb98-334"><a href="#cb98-334" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lapply</span>(<span class="fu">unique</span>(values), tags<span class="sc">$</span>option),</span>
<span id="cb98-335"><a href="#cb98-335" aria-hidden="true" tabindex="-1"></a>      <span class="st">"aria-label"</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"Filter %s"</span>, name),</span>
<span id="cb98-336"><a href="#cb98-336" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> style</span>
<span id="cb98-337"><a href="#cb98-337" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb98-338"><a href="#cb98-338" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb98-339"><a href="#cb98-339" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-340"><a href="#cb98-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-341"><a href="#cb98-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-342"><a href="#cb98-342" aria-hidden="true" tabindex="-1"></a>post_tabs<span class="sc">$</span>agg_x_full <span class="sc">|&gt;</span> </span>
<span id="cb98-343"><a href="#cb98-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(post_tabs<span class="sc">$</span>agg_x_best <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="st">"best_error"</span><span class="ot">=</span>mean_error,<span class="st">"best_pred"</span><span class="ot">=</span>pred), </span>
<span id="cb98-344"><a href="#cb98-344" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="fu">c</span>(<span class="st">"condit"</span>,<span class="st">"Model"</span>,<span class="st">"Fit_Method"</span>,<span class="st">"x"</span>,<span class="st">"y"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb98-345"><a href="#cb98-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(condit),x,Fit_Method) <span class="sc">|&gt;</span></span>
<span id="cb98-346"><a href="#cb98-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x=</span><span class="fu">as.character</span>(x)) <span class="sc">|&gt;</span></span>
<span id="cb98-347"><a href="#cb98-347" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(</span>
<span id="cb98-348"><a href="#cb98-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">list</span>(<span class="at">condit=</span><span class="fu">colDef</span>(<span class="at">name=</span><span class="st">"Condit"</span>,<span class="at">filterInput=</span><span class="fu">selectFilter</span>(<span class="st">"my-tbl"</span>)),</span>
<span id="cb98-349"><a href="#cb98-349" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Model=</span><span class="fu">colDef</span>(<span class="at">name=</span><span class="st">"Model"</span>,<span class="at">filterInput=</span><span class="fu">selectFilter</span>(<span class="st">"my-tbl"</span>)),</span>
<span id="cb98-350"><a href="#cb98-350" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Fit_Method=</span><span class="fu">colDef</span>(<span class="at">name=</span><span class="st">"Fit_Method"</span>,<span class="at">filterInput=</span><span class="fu">selectFilter</span>(<span class="st">"my-tbl"</span>),</span>
<span id="cb98-351"><a href="#cb98-351" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">filterMethod =</span> <span class="fu">JS</span>(<span class="st">"(rows, columnId, filterValue) =&gt; {</span></span>
<span id="cb98-352"><a href="#cb98-352" aria-hidden="true" tabindex="-1"></a><span class="st">        return rows.filter(row =&gt; row.values[columnId] === filterValue)</span></span>
<span id="cb98-353"><a href="#cb98-353" aria-hidden="true" tabindex="-1"></a><span class="st">      }"</span>)),</span>
<span id="cb98-354"><a href="#cb98-354" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="fu">colDef</span>(<span class="at">name=</span><span class="st">"x"</span>,<span class="at">filterInput=</span><span class="fu">selectFilter</span>(<span class="st">"my-tbl"</span>),</span>
<span id="cb98-355"><a href="#cb98-355" aria-hidden="true" tabindex="-1"></a>               <span class="at">filterMethod =</span> <span class="fu">JS</span>(<span class="st">"(rows, columnId, filterValue) =&gt; {</span></span>
<span id="cb98-356"><a href="#cb98-356" aria-hidden="true" tabindex="-1"></a><span class="st">        return rows.filter(row =&gt; row.values[columnId] === filterValue)</span></span>
<span id="cb98-357"><a href="#cb98-357" aria-hidden="true" tabindex="-1"></a><span class="st">      }"</span>))),</span>
<span id="cb98-358"><a href="#cb98-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">elementId =</span> <span class="st">"my-tbl"</span>,</span>
<span id="cb98-359"><a href="#cb98-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">defaultPageSize=</span><span class="dv">15</span>,</span>
<span id="cb98-360"><a href="#cb98-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterable=</span><span class="cn">TRUE</span>) </span>
<span id="cb98-361"><a href="#cb98-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-362"><a href="#cb98-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-363"><a href="#cb98-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-364"><a href="#cb98-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-365"><a href="#cb98-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-366"><a href="#cb98-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-367"><a href="#cb98-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-368"><a href="#cb98-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-369"><a href="#cb98-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-370"><a href="#cb98-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-371"><a href="#cb98-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-372"><a href="#cb98-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-373"><a href="#cb98-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-374"><a href="#cb98-374" aria-hidden="true" tabindex="-1"></a><span class="fu">## Train Predictions</span></span>
<span id="cb98-377"><a href="#cb98-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-378"><a href="#cb98-378" aria-hidden="true" tabindex="-1"></a>pt_train <span class="ot">&lt;-</span> <span class="fu">abc_train_tables</span>(pd_train,pd_train_l)</span>
<span id="cb98-379"><a href="#cb98-379" aria-hidden="true" tabindex="-1"></a>pt_train<span class="sc">$</span>agg_pred_full <span class="sc">|&gt;</span> flextable<span class="sc">::</span><span class="fu">tabulator</span>(<span class="at">rows=</span><span class="fu">c</span>(<span class="st">"Fit_Method"</span>,<span class="st">"Model"</span>), <span class="at">columns=</span><span class="fu">c</span>(<span class="st">"condit"</span>), </span>
<span id="cb98-380"><a href="#cb98-380" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">ME</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(mean_error)) <span class="sc">|&gt;</span> <span class="fu">as_flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-381"><a href="#cb98-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Mean from full_posterior"</span>)</span>
<span id="cb98-382"><a href="#cb98-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-383"><a href="#cb98-383" aria-hidden="true" tabindex="-1"></a>pt_train<span class="sc">$</span>block_pred_full <span class="sc">|&gt;</span> </span>
<span id="cb98-384"><a href="#cb98-384" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">tabulator</span>(<span class="at">rows=</span><span class="fu">c</span>(<span class="st">"Fit_Method"</span>,<span class="st">"Model"</span>,<span class="st">"Block"</span>), <span class="at">columns=</span><span class="fu">c</span>(<span class="st">"condit"</span>), </span>
<span id="cb98-385"><a href="#cb98-385" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">Observed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(y), </span>
<span id="cb98-386"><a href="#cb98-386" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">Predicted</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(pred),</span>
<span id="cb98-387"><a href="#cb98-387" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">ME</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(mean_error)) <span class="sc">|&gt;</span> <span class="fu">as_flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-388"><a href="#cb98-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Mean from full_posterior"</span>)</span>
<span id="cb98-389"><a href="#cb98-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-390"><a href="#cb98-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-391"><a href="#cb98-391" aria-hidden="true" tabindex="-1"></a>pt_train<span class="sc">$</span>block_pred_full <span class="sc">|&gt;</span> <span class="fu">filter</span>(condit<span class="sc">==</span><span class="st">"Varied"</span>) <span class="sc">|&gt;</span></span>
<span id="cb98-392"><a href="#cb98-392" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">tabulator</span>(<span class="at">rows=</span><span class="fu">c</span>(<span class="st">"Fit_Method"</span>,<span class="st">"Block"</span>), <span class="at">columns=</span><span class="fu">c</span>(<span class="st">"Model"</span>), </span>
<span id="cb98-393"><a href="#cb98-393" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span id="cb98-394"><a href="#cb98-394" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">Predicted</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(pred),</span>
<span id="cb98-395"><a href="#cb98-395" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">ME</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(mean_error)) <span class="sc">|&gt;</span> <span class="fu">as_flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-396"><a href="#cb98-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Mean from full_posterior"</span>)</span>
<span id="cb98-397"><a href="#cb98-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-398"><a href="#cb98-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-399"><a href="#cb98-399" aria-hidden="true" tabindex="-1"></a>pt_train<span class="sc">$</span>block_pred_full <span class="sc">|&gt;</span></span>
<span id="cb98-400"><a href="#cb98-400" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">tabulator</span>(<span class="at">rows=</span><span class="fu">c</span>(<span class="st">"Fit_Method"</span>,<span class="st">"Block"</span>), <span class="at">columns=</span><span class="fu">c</span>(<span class="st">"condit"</span>,<span class="st">"Model"</span>), </span>
<span id="cb98-401"><a href="#cb98-401" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span id="cb98-402"><a href="#cb98-402" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">Predicted</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(pred),</span>
<span id="cb98-403"><a href="#cb98-403" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">ME</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(mean_error)) <span class="sc">|&gt;</span> <span class="fu">as_flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-404"><a href="#cb98-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Mean from full_posterior"</span>)</span>
<span id="cb98-405"><a href="#cb98-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-406"><a href="#cb98-406" aria-hidden="true" tabindex="-1"></a>pt_train<span class="sc">$</span>block_pred_full <span class="sc">|&gt;</span></span>
<span id="cb98-407"><a href="#cb98-407" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">tabulator</span>(<span class="at">rows=</span><span class="fu">c</span>(<span class="st">"Fit_Method"</span>,<span class="st">"Block"</span>), <span class="at">columns=</span><span class="fu">c</span>(<span class="st">"condit"</span>,<span class="st">"Model"</span>), </span>
<span id="cb98-408"><a href="#cb98-408" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span id="cb98-409"><a href="#cb98-409" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">ME</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(mean_error)) <span class="sc">|&gt;</span> <span class="fu">as_flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-410"><a href="#cb98-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Mean from full_posterior"</span>)</span>
<span id="cb98-411"><a href="#cb98-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-412"><a href="#cb98-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-413"><a href="#cb98-413" aria-hidden="true" tabindex="-1"></a>best_indices <span class="ot">&lt;-</span> pt_train<span class="sc">$</span>block_pred_full_x <span class="sc">%&gt;%</span></span>
<span id="cb98-414"><a href="#cb98-414" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>(Fit_Method<span class="sc">==</span><span class="st">"Test"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb98-415"><a href="#cb98-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">-</span>condit) <span class="sc">%&gt;%</span></span>
<span id="cb98-416"><a href="#cb98-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indices =</span> <span class="fu">map</span>(data, <span class="sc">~</span>{</span>
<span id="cb98-417"><a href="#cb98-417" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">%&gt;%</span></span>
<span id="cb98-418"><a href="#cb98-418" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>y, <span class="sc">-</span>pred, <span class="sc">-</span>mean_error) <span class="sc">%&gt;%</span></span>
<span id="cb98-419"><a href="#cb98-419" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Model, <span class="at">values_from =</span> best) <span class="sc">%&gt;%</span></span>
<span id="cb98-420"><a href="#cb98-420" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb98-421"><a href="#cb98-421" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(ALM, EXAM) <span class="sc">%&gt;%</span></span>
<span id="cb98-422"><a href="#cb98-422" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pmap</span>(<span class="at">.f =</span> <span class="cf">function</span>(ALM, EXAM) {</span>
<span id="cb98-423"><a href="#cb98-423" aria-hidden="true" tabindex="-1"></a>        <span class="fu">which</span>(<span class="fu">c</span>(ALM, EXAM) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb98-424"><a href="#cb98-424" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb98-425"><a href="#cb98-425" aria-hidden="true" tabindex="-1"></a>  })) <span class="sc">%&gt;%</span></span>
<span id="cb98-426"><a href="#cb98-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(condit, indices)</span>
<span id="cb98-427"><a href="#cb98-427" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb98-428"><a href="#cb98-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-429"><a href="#cb98-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-430"><a href="#cb98-430" aria-hidden="true" tabindex="-1"></a>pt_train<span class="sc">$</span>block_pred_full_x <span class="sc">|&gt;</span> <span class="fu">filter</span>(condit<span class="sc">==</span><span class="st">"Varied"</span>,<span class="sc">!</span>(Fit_Method<span class="sc">==</span><span class="st">"Test"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb98-431"><a href="#cb98-431" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">tabulator</span>(<span class="at">rows=</span><span class="fu">c</span>(<span class="st">"Fit_Method"</span>,<span class="st">"Block"</span>,<span class="st">"x"</span>), <span class="at">columns=</span><span class="fu">c</span>(<span class="st">"Model"</span>), </span>
<span id="cb98-432"><a href="#cb98-432" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span id="cb98-433"><a href="#cb98-433" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">Predicted</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(pred),</span>
<span id="cb98-434"><a href="#cb98-434" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">ME</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(mean_error)) <span class="sc">|&gt;</span> </span>
<span id="cb98-435"><a href="#cb98-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_flextable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb98-436"><a href="#cb98-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply_best_formatting</span>(.,<span class="fu">pull</span>(<span class="fu">filter</span>(best_indices,condit<span class="sc">==</span><span class="st">"Varied"</span>),indices) <span class="sc">%&gt;%</span> .[[<span class="dv">1</span>]]) <span class="sc">|&gt;</span> </span>
<span id="cb98-437"><a href="#cb98-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Vared Train Predictions"</span>)</span>
<span id="cb98-438"><a href="#cb98-438" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb98-439"><a href="#cb98-439" aria-hidden="true" tabindex="-1"></a>pt_train<span class="sc">$</span>block_pred_full_x <span class="sc">|&gt;</span> <span class="fu">filter</span>(condit<span class="sc">==</span><span class="st">"Constant"</span>,<span class="sc">!</span>(Fit_Method<span class="sc">==</span><span class="st">"Test"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb98-440"><a href="#cb98-440" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">tabulator</span>(<span class="at">rows=</span><span class="fu">c</span>(<span class="st">"Fit_Method"</span>,<span class="st">"Block"</span>,<span class="st">"x"</span>), <span class="at">columns=</span><span class="fu">c</span>(<span class="st">"Model"</span>), </span>
<span id="cb98-441"><a href="#cb98-441" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># `Observed` = as_paragraph(y), </span></span>
<span id="cb98-442"><a href="#cb98-442" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">Predicted</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(pred),</span>
<span id="cb98-443"><a href="#cb98-443" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">ME</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_paragraph</span>(mean_error)) <span class="sc">|&gt;</span> </span>
<span id="cb98-444"><a href="#cb98-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_flextable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb98-445"><a href="#cb98-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply_best_formatting</span>(.,<span class="fu">pull</span>(<span class="fu">filter</span>(best_indices,condit<span class="sc">==</span><span class="st">"Constant"</span>),indices) <span class="sc">%&gt;%</span> .[[<span class="dv">1</span>]]) <span class="sc">|&gt;</span> </span>
<span id="cb98-446"><a href="#cb98-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Constant Train Predictions"</span>)</span>
<span id="cb98-447"><a href="#cb98-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-448"><a href="#cb98-448" aria-hidden="true" tabindex="-1"></a><span class="co"># pull(filter(best_indices,condit=="Varied"),indices) %&gt;% .[[1]] </span></span>
<span id="cb98-449"><a href="#cb98-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-450"><a href="#cb98-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-451"><a href="#cb98-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-452"><a href="#cb98-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-453"><a href="#cb98-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-454"><a href="#cb98-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## Posterior Predictive: </span></span>
<span id="cb98-455"><a href="#cb98-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=12, fig.height=15}</span></span>
<span id="cb98-456"><a href="#cb98-456" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb98-457"><a href="#cb98-457" aria-hidden="true" tabindex="-1"></a><span class="in">group_predictive_plots(post_dat_l) </span></span>
<span id="cb98-458"><a href="#cb98-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-459"><a href="#cb98-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-460"><a href="#cb98-460" aria-hidden="true" tabindex="-1"></a><span class="in">testAvg |&gt; ggplot(aes(x=vx)) + geom_density() + facet_wrap(~vb) +</span></span>
<span id="cb98-461"><a href="#cb98-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-462"><a href="#cb98-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-463"><a href="#cb98-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-464"><a href="#cb98-464" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_avg |&gt; filter(rank==1) |&gt; ggplot(aes(x=pred)) + geom_density() + facet_wrap(~x)</span></span>
<span id="cb98-465"><a href="#cb98-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-466"><a href="#cb98-466" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_avg |&gt; filter(rank==1) |&gt; ggplot(aes(x=pred)) + </span></span>
<span id="cb98-467"><a href="#cb98-467" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density() + geom_density(data=post_dat_avg, aes(x=y), color="red") +</span></span>
<span id="cb98-468"><a href="#cb98-468" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(condit~x,ncol=6)</span></span>
<span id="cb98-469"><a href="#cb98-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-470"><a href="#cb98-470" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_avg |&gt; filter(Model=="EXAM",Fit_Method=="Test") |&gt; ggplot(aes(x=pred)) + </span></span>
<span id="cb98-471"><a href="#cb98-471" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density() + geom_density(data=post_dat_avg, aes(x=y), color="red") +</span></span>
<span id="cb98-472"><a href="#cb98-472" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(condit~x,ncol=6)</span></span>
<span id="cb98-473"><a href="#cb98-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-474"><a href="#cb98-474" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_avg |&gt; filter(Model=="ALM",Fit_Method=="Test") |&gt; ggplot(aes(x=pred)) + </span></span>
<span id="cb98-475"><a href="#cb98-475" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density() + geom_density(data=post_dat_avg, aes(x=y), color="red") +</span></span>
<span id="cb98-476"><a href="#cb98-476" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(condit~x,ncol=6)</span></span>
<span id="cb98-477"><a href="#cb98-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-478"><a href="#cb98-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-479"><a href="#cb98-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-480"><a href="#cb98-480" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_avg |&gt; filter(Fit_Method=="Test") |&gt; ggplot(aes(x=pred)) + </span></span>
<span id="cb98-481"><a href="#cb98-481" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density(aes(fill=Model),alpha=.5) + geom_density(data=post_dat_avg, aes(x=y), color="black",alpha=2) +</span></span>
<span id="cb98-482"><a href="#cb98-482" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(condit~x,ncol=6)</span></span>
<span id="cb98-483"><a href="#cb98-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-484"><a href="#cb98-484" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_avg |&gt; filter(Fit_Method=="Test_Train") |&gt; ggplot(aes(x=pred)) + </span></span>
<span id="cb98-485"><a href="#cb98-485" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density(aes(fill=Model),alpha=.5) + geom_density(data=post_dat_avg, aes(x=y), color="black",alpha=2) +</span></span>
<span id="cb98-486"><a href="#cb98-486" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(condit~x,ncol=6)</span></span>
<span id="cb98-487"><a href="#cb98-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-488"><a href="#cb98-488" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_avg |&gt; filter(Fit_Method=="Train",pred&gt;0,pred&lt;2000) |&gt; ggplot(aes(x=pred)) + </span></span>
<span id="cb98-489"><a href="#cb98-489" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density(aes(fill=Model),alpha=.5) + geom_density(data=post_dat_avg, aes(x=y), color="black",alpha=2) +</span></span>
<span id="cb98-490"><a href="#cb98-490" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(condit~x,ncol=6)</span></span>
<span id="cb98-491"><a href="#cb98-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-492"><a href="#cb98-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-493"><a href="#cb98-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-494"><a href="#cb98-494" aria-hidden="true" tabindex="-1"></a><span class="fu">### Alt grouping of Posterior Predictive</span></span>
<span id="cb98-495"><a href="#cb98-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=12, fig.height=15}</span></span>
<span id="cb98-496"><a href="#cb98-496" aria-hidden="true" tabindex="-1"></a><span class="in"> group_predictive_plots2(post_dat_l) </span></span>
<span id="cb98-497"><a href="#cb98-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-498"><a href="#cb98-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-499"><a href="#cb98-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-502"><a href="#cb98-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-503"><a href="#cb98-503" aria-hidden="true" tabindex="-1"></a>post_dat_avg <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,condit,Fit_Method,x) <span class="sc">|&gt;</span></span>
<span id="cb98-504"><a href="#cb98-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> error, <span class="at">fill=</span>Model)) <span class="sc">+</span> </span>
<span id="cb98-505"><a href="#cb98-505" aria-hidden="true" tabindex="-1"></a>  stat_bar <span class="sc">+</span> </span>
<span id="cb98-506"><a href="#cb98-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(condit<span class="sc">~</span>Fit_Method, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb98-507"><a href="#cb98-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Resituals - full posterior"</span>)</span>
<span id="cb98-508"><a href="#cb98-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-509"><a href="#cb98-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-510"><a href="#cb98-510" aria-hidden="true" tabindex="-1"></a>post_dat_avg <span class="sc">|&gt;</span> <span class="fu">group_by</span>(id,condit,Fit_Method,x) <span class="sc">|&gt;</span></span>
<span id="cb98-511"><a href="#cb98-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-512"><a href="#cb98-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> error, <span class="at">fill=</span>Model)) <span class="sc">+</span> </span>
<span id="cb98-513"><a href="#cb98-513" aria-hidden="true" tabindex="-1"></a>  stat_bar <span class="sc">+</span> </span>
<span id="cb98-514"><a href="#cb98-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(condit<span class="sc">~</span>Fit_Method, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb98-515"><a href="#cb98-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Residuals - best parameters"</span>)</span>
<span id="cb98-516"><a href="#cb98-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-517"><a href="#cb98-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-518"><a href="#cb98-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-519"><a href="#cb98-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-520"><a href="#cb98-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-521"><a href="#cb98-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-522"><a href="#cb98-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-523"><a href="#cb98-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-524"><a href="#cb98-524" aria-hidden="true" tabindex="-1"></a><span class="in">plot_indv_posterior(ind_fits_df |&gt; mutate(Group=condit))</span></span>
<span id="cb98-525"><a href="#cb98-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-526"><a href="#cb98-526" aria-hidden="true" tabindex="-1"></a><span class="in">plot_indv_posterior(post_dat |&gt; filter(rank==1) |&gt; mutate(Group=condit))</span></span>
<span id="cb98-527"><a href="#cb98-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-528"><a href="#cb98-528" aria-hidden="true" tabindex="-1"></a><span class="in"># plot join density of c and lr</span></span>
<span id="cb98-529"><a href="#cb98-529" aria-hidden="true" tabindex="-1"></a><span class="in"># post_dat |&gt; filter(rank==1, c&lt;.001) |&gt; </span></span>
<span id="cb98-530"><a href="#cb98-530" aria-hidden="true" tabindex="-1"></a><span class="in">#   ggplot(aes(x=c, y=lr, color=condit)) + geom_point() + facet_wrap(~Model+Fit_Method)</span></span>
<span id="cb98-531"><a href="#cb98-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-532"><a href="#cb98-532" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat |&gt;  filter(c&lt;.001) |&gt; ggplot(aes(x=c,y=condit,fill=condit)) + geom_boxploth(width=.5) + facet_wrap(~Model+Fit_Method,scales="free")</span></span>
<span id="cb98-533"><a href="#cb98-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-534"><a href="#cb98-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-535"><a href="#cb98-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-536"><a href="#cb98-536" aria-hidden="true" tabindex="-1"></a><span class="in">post_dist &lt;- post_dat_avg %&gt;%</span></span>
<span id="cb98-537"><a href="#cb98-537" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(id, condit, Model, Fit_Method, rank) %&gt;%</span></span>
<span id="cb98-538"><a href="#cb98-538" aria-hidden="true" tabindex="-1"></a><span class="in">  slice_head(n = 1) %&gt;%</span></span>
<span id="cb98-539"><a href="#cb98-539" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;% # Make sure to remove the grouping by rank before the next group_by</span></span>
<span id="cb98-540"><a href="#cb98-540" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(id, condit, Model, Fit_Method) %&gt;%</span></span>
<span id="cb98-541"><a href="#cb98-541" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(across(c:lr, list(mean = mean, sd = sd, se = ~sd(.)/sqrt(n()))), .groups = 'keep')</span></span>
<span id="cb98-542"><a href="#cb98-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-543"><a href="#cb98-543" aria-hidden="true" tabindex="-1"></a><span class="in">post_dist |&gt; </span></span>
<span id="cb98-544"><a href="#cb98-544" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(condit, Model, Fit_Method) %&gt;%</span></span>
<span id="cb98-545"><a href="#cb98-545" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c_mean, list(gmean = mean, gsd = sd, gse = ~sd(.)/sqrt(n()))), .groups = 'keep') |&gt;</span></span>
<span id="cb98-546"><a href="#cb98-546" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(c_mean&lt;(c_mean_gmean+(.5*c_mean_gse))) |&gt;</span></span>
<span id="cb98-547"><a href="#cb98-547" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=id, x = c_mean)) + </span></span>
<span id="cb98-548"><a href="#cb98-548" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_pointinterval() + </span></span>
<span id="cb98-549"><a href="#cb98-549" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_nested_wrap(Fit_Method~condit~Model,scales="free")</span></span>
<span id="cb98-550"><a href="#cb98-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-551"><a href="#cb98-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-552"><a href="#cb98-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-553"><a href="#cb98-553" aria-hidden="true" tabindex="-1"></a><span class="in">post_dist |&gt; </span></span>
<span id="cb98-554"><a href="#cb98-554" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(condit, Model, Fit_Method) %&gt;%</span></span>
<span id="cb98-555"><a href="#cb98-555" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c_mean, list(gmean = median, gsd = sd, gse = ~sd(.)/sqrt(n()))), .groups = 'keep') |&gt;</span></span>
<span id="cb98-556"><a href="#cb98-556" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(c_mean&lt;(c_mean_gmean+(.5*c_mean_gse))) |&gt;</span></span>
<span id="cb98-557"><a href="#cb98-557" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes( x = c_mean,fill=condit)) + geom_density() +</span></span>
<span id="cb98-558"><a href="#cb98-558" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_nested_wrap(Fit_Method~Model,scales="free")</span></span>
<span id="cb98-559"><a href="#cb98-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-560"><a href="#cb98-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-561"><a href="#cb98-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-562"><a href="#cb98-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-563"><a href="#cb98-563" aria-hidden="true" tabindex="-1"></a><span class="in">post_dist |&gt; </span></span>
<span id="cb98-564"><a href="#cb98-564" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(condit, Model, Fit_Method) %&gt;%</span></span>
<span id="cb98-565"><a href="#cb98-565" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c_mean, list(gmean = median, gsd = sd, gse = ~sd(.)/sqrt(n()))), .groups = 'keep') |&gt;</span></span>
<span id="cb98-566"><a href="#cb98-566" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(c_mean&lt;(c_mean_gmean+(.5*c_mean_gse))) |&gt;</span></span>
<span id="cb98-567"><a href="#cb98-567" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes( x = log(c_mean),fill=condit)) + geom_density() +</span></span>
<span id="cb98-568"><a href="#cb98-568" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_nested_wrap(Fit_Method~Model,scales="free")</span></span>
<span id="cb98-569"><a href="#cb98-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-570"><a href="#cb98-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-571"><a href="#cb98-571" aria-hidden="true" tabindex="-1"></a><span class="in"> post_dat_avg %&gt;%</span></span>
<span id="cb98-572"><a href="#cb98-572" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(id, condit, Model, Fit_Method, rank) %&gt;%</span></span>
<span id="cb98-573"><a href="#cb98-573" aria-hidden="true" tabindex="-1"></a><span class="in">    slice_head(n = 1) |&gt;</span></span>
<span id="cb98-574"><a href="#cb98-574" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes( x = log(c),fill=condit)) + geom_density() +</span></span>
<span id="cb98-575"><a href="#cb98-575" aria-hidden="true" tabindex="-1"></a><span class="in">    ggh4x::facet_nested_wrap(Fit_Method~Model,scales="free")</span></span>
<span id="cb98-576"><a href="#cb98-576" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb98-577"><a href="#cb98-577" aria-hidden="true" tabindex="-1"></a><span class="in"> post_dat_avg %&gt;%</span></span>
<span id="cb98-578"><a href="#cb98-578" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(id, condit, Model, Fit_Method, rank) %&gt;%</span></span>
<span id="cb98-579"><a href="#cb98-579" aria-hidden="true" tabindex="-1"></a><span class="in">    slice_head(n = 1) |&gt;</span></span>
<span id="cb98-580"><a href="#cb98-580" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(y=Fit_Method, x = log(c),col=condit)) + stat_pointinterval(position=position_dodge(.2)) +</span></span>
<span id="cb98-581"><a href="#cb98-581" aria-hidden="true" tabindex="-1"></a><span class="in">    ggh4x::facet_nested_wrap(~Model,scales="free")</span></span>
<span id="cb98-582"><a href="#cb98-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-583"><a href="#cb98-583" aria-hidden="true" tabindex="-1"></a><span class="in"> post_dat_avg %&gt;%</span></span>
<span id="cb98-584"><a href="#cb98-584" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(id, condit, Model, Fit_Method, rank) %&gt;%</span></span>
<span id="cb98-585"><a href="#cb98-585" aria-hidden="true" tabindex="-1"></a><span class="in">    slice_head(n = 1) |&gt;</span></span>
<span id="cb98-586"><a href="#cb98-586" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(y=Fit_Method, x = lr,col=condit)) + stat_pointinterval(position=position_dodge(.2)) +</span></span>
<span id="cb98-587"><a href="#cb98-587" aria-hidden="true" tabindex="-1"></a><span class="in">    ggh4x::facet_nested_wrap(~Model,scales="free")</span></span>
<span id="cb98-588"><a href="#cb98-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-589"><a href="#cb98-589" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb98-590"><a href="#cb98-590" aria-hidden="true" tabindex="-1"></a><span class="in"># post_dat_avg %&gt;%</span></span>
<span id="cb98-591"><a href="#cb98-591" aria-hidden="true" tabindex="-1"></a><span class="in">#     group_by(id, condit, Model, Fit_Method, rank) %&gt;%</span></span>
<span id="cb98-592"><a href="#cb98-592" aria-hidden="true" tabindex="-1"></a><span class="in">#     slice_head(n = 1) |&gt;</span></span>
<span id="cb98-593"><a href="#cb98-593" aria-hidden="true" tabindex="-1"></a><span class="in">#     ggplot(aes(y=Fit_Method, x = (lr),fill=condit)) + </span></span>
<span id="cb98-594"><a href="#cb98-594" aria-hidden="true" tabindex="-1"></a><span class="in">#     stat_halfeye(position=position_dodge(.2)) +</span></span>
<span id="cb98-595"><a href="#cb98-595" aria-hidden="true" tabindex="-1"></a><span class="in">#     ggh4x::facet_nested_wrap(~Model,scales="free")   </span></span>
<span id="cb98-596"><a href="#cb98-596" aria-hidden="true" tabindex="-1"></a><span class="in">#   </span></span>
<span id="cb98-597"><a href="#cb98-597" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb98-598"><a href="#cb98-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-599"><a href="#cb98-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-600"><a href="#cb98-600" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Comparison:</span></span>
<span id="cb98-601"><a href="#cb98-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=12, fig.height=13}</span></span>
<span id="cb98-602"><a href="#cb98-602" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb98-603"><a href="#cb98-603" aria-hidden="true" tabindex="-1"></a><span class="in">indv_best_plots(post_dat_l)</span></span>
<span id="cb98-604"><a href="#cb98-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-605"><a href="#cb98-605" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_l |&gt; group_by(condit,Model,Fit_Method,rank) |&gt; </span></span>
<span id="cb98-606"><a href="#cb98-606" aria-hidden="true" tabindex="-1"></a><span class="in">   summarise(mean_error=mean(abs(error)), n=n()) |&gt; </span></span>
<span id="cb98-607"><a href="#cb98-607" aria-hidden="true" tabindex="-1"></a><span class="in">   ggplot(aes(x=rank,y=mean_error,fill=Model))+geom_col()+facet_wrap(~Fit_Method,scales="free")</span></span>
<span id="cb98-608"><a href="#cb98-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-609"><a href="#cb98-609" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_l |&gt; group_by(condit,Model,Fit_Method,rank,x) |&gt; </span></span>
<span id="cb98-610"><a href="#cb98-610" aria-hidden="true" tabindex="-1"></a><span class="in">   summarise(mean_error=mean(abs(error)), n=n()) |&gt; </span></span>
<span id="cb98-611"><a href="#cb98-611" aria-hidden="true" tabindex="-1"></a><span class="in">   ggplot(aes(x=rank,y=mean_error,fill=Model))+geom_col()+facet_wrap(Fit_Method~x,ncol=6,scales="free")</span></span>
<span id="cb98-612"><a href="#cb98-612" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb98-613"><a href="#cb98-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-614"><a href="#cb98-614" aria-hidden="true" tabindex="-1"></a><span class="in">group_best_plots(post_dat_l)</span></span>
<span id="cb98-615"><a href="#cb98-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-616"><a href="#cb98-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-617"><a href="#cb98-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-618"><a href="#cb98-618" aria-hidden="true" tabindex="-1"></a><span class="fu">## Individual Predictive Plots</span></span>
<span id="cb98-619"><a href="#cb98-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-620"><a href="#cb98-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-621"><a href="#cb98-621" aria-hidden="true" tabindex="-1"></a><span class="in">indv_predictive_plots(post_dat_l, ids2)</span></span>
<span id="cb98-622"><a href="#cb98-622" aria-hidden="true" tabindex="-1"></a><span class="in">indv_predictive_plots(post_dat_l, idsBad)</span></span>
<span id="cb98-623"><a href="#cb98-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-624"><a href="#cb98-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-625"><a href="#cb98-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-626"><a href="#cb98-626" aria-hidden="true" tabindex="-1"></a><span class="fu">### Subject 1</span></span>
<span id="cb98-627"><a href="#cb98-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-628"><a href="#cb98-628" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb98-629"><a href="#cb98-629" aria-hidden="true" tabindex="-1"></a><span class="in">indv_predictive_dist((post_dat_l |&gt; filter(rank&lt;=200)),ind_fits_df, sbj=list(1))</span></span>
<span id="cb98-630"><a href="#cb98-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-631"><a href="#cb98-631" aria-hidden="true" tabindex="-1"></a><span class="in">abc_tables(post_dat |&gt; filter(id==1))$agg_full |&gt; flextable() |&gt; set_caption("Mean from full posterior")</span></span>
<span id="cb98-632"><a href="#cb98-632" aria-hidden="true" tabindex="-1"></a><span class="in">abc_tables(post_dat |&gt; filter(id==1))$agg_best |&gt; flextable() |&gt; set_caption("Mean from best parameters")</span></span>
<span id="cb98-633"><a href="#cb98-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-634"><a href="#cb98-634" aria-hidden="true" tabindex="-1"></a><span class="in">post_dat_l |&gt; filter(id==1) |&gt; group_by(condit,Model,Fit_Method,rank) |&gt; </span></span>
<span id="cb98-635"><a href="#cb98-635" aria-hidden="true" tabindex="-1"></a><span class="in">   summarise(mean_error=mean(abs(error)), n=n()) |&gt; </span></span>
<span id="cb98-636"><a href="#cb98-636" aria-hidden="true" tabindex="-1"></a><span class="in">   ggplot(aes(x=rank,y=mean_error,fill=Model))+geom_col()+facet_wrap(~Fit_Method)</span></span>
<span id="cb98-637"><a href="#cb98-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-638"><a href="#cb98-638" aria-hidden="true" tabindex="-1"></a><span class="in"># plot_indv_posterior(ind_fits_df |&gt; filter(id==1))</span></span>
<span id="cb98-639"><a href="#cb98-639" aria-hidden="true" tabindex="-1"></a><span class="in"># ind_fits_df |&gt; filter(id==1, Fit_Method=="Test Only", Model=="EXAM") |&gt; pull(c) |&gt; unique()</span></span>
<span id="cb98-640"><a href="#cb98-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-641"><a href="#cb98-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-642"><a href="#cb98-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-643"><a href="#cb98-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-644"><a href="#cb98-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-645"><a href="#cb98-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-646"><a href="#cb98-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-647"><a href="#cb98-647" aria-hidden="true" tabindex="-1"></a><span class="fu">### Subject 36</span></span>
<span id="cb98-648"><a href="#cb98-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-649"><a href="#cb98-649" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb98-650"><a href="#cb98-650" aria-hidden="true" tabindex="-1"></a><span class="in">indv_predictive_dist(post_dat_l,ind_fits_df, sbj=list(36))</span></span>
<span id="cb98-651"><a href="#cb98-651" aria-hidden="true" tabindex="-1"></a><span class="in">#abc_tables(post_dat_l |&gt; filter(id==36))$et_sum |&gt; gt::gt()</span></span>
<span id="cb98-652"><a href="#cb98-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-653"><a href="#cb98-653" aria-hidden="true" tabindex="-1"></a><span class="in">abc_tables(post_dat |&gt; filter(id==36))$agg_full |&gt; flextable() |&gt; set_caption("Mean from full posterior")</span></span>
<span id="cb98-654"><a href="#cb98-654" aria-hidden="true" tabindex="-1"></a><span class="in">abc_tables(post_dat |&gt; filter(id==36))$agg_best |&gt; flextable() |&gt; set_caption("Mean from best parameters")</span></span>
<span id="cb98-655"><a href="#cb98-655" aria-hidden="true" tabindex="-1"></a><span class="in"># plot_indv_posterior(ind_fits_df |&gt; filter(id==1))</span></span>
<span id="cb98-656"><a href="#cb98-656" aria-hidden="true" tabindex="-1"></a><span class="in"># ind_fits_df |&gt; filter(id==1, Fit_Method=="Test Only", Model=="EXAM") |&gt; pull(c) |&gt; unique()</span></span>
<span id="cb98-657"><a href="#cb98-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-658"><a href="#cb98-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-659"><a href="#cb98-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-660"><a href="#cb98-660" aria-hidden="true" tabindex="-1"></a><span class="fu">## More Comparisons</span></span>
<span id="cb98-661"><a href="#cb98-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-662"><a href="#cb98-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-663"><a href="#cb98-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-664"><a href="#cb98-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-665"><a href="#cb98-665" aria-hidden="true" tabindex="-1"></a><span class="in">best_id_x &lt;- post_dat |&gt; group_by(id,condit,Model,Fit_Method,x) |&gt;</span></span>
<span id="cb98-666"><a href="#cb98-666" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(e2=(y-pred)) |&gt;</span></span>
<span id="cb98-667"><a href="#cb98-667" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(y=mean(y), pred=mean(pred), mean_error=mean(e2),abs_me=abs(mean_error)) |&gt;</span></span>
<span id="cb98-668"><a href="#cb98-668" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(id,condit,Fit_Method,x) |&gt; mutate(best=ifelse(mean_error==min(mean_error),1,0)) |&gt;</span></span>
<span id="cb98-669"><a href="#cb98-669" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(id,condit,Fit_Method,Model) |&gt; mutate(n_best=sum(best)) </span></span>
<span id="cb98-670"><a href="#cb98-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-671"><a href="#cb98-671" aria-hidden="true" tabindex="-1"></a><span class="in">best_id &lt;- best_id_x |&gt; group_by(id,condit,Fit_Method,Model) |&gt;</span></span>
<span id="cb98-672"><a href="#cb98-672" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(mean_error=mean(mean_error), n_best=first(n_best),abs_me=mean(abs(mean_error)))</span></span>
<span id="cb98-673"><a href="#cb98-673" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb98-674"><a href="#cb98-674" aria-hidden="true" tabindex="-1"></a><span class="in">lowest_error_model &lt;- best_id %&gt;%</span></span>
<span id="cb98-675"><a href="#cb98-675" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(id, condit,Fit_Method) %&gt;%</span></span>
<span id="cb98-676"><a href="#cb98-676" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(Best_Model = Model[which.min(mean_error)],</span></span>
<span id="cb98-677"><a href="#cb98-677" aria-hidden="true" tabindex="-1"></a><span class="in">            n_best = n_best[which.min(mean_error)],</span></span>
<span id="cb98-678"><a href="#cb98-678" aria-hidden="true" tabindex="-1"></a><span class="in">            Lowest_error = min(mean_error),</span></span>
<span id="cb98-679"><a href="#cb98-679" aria-hidden="true" tabindex="-1"></a><span class="in">            differential = min(mean_error) - max(mean_error)) %&gt;%</span></span>
<span id="cb98-680"><a href="#cb98-680" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup()</span></span>
<span id="cb98-681"><a href="#cb98-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-682"><a href="#cb98-682" aria-hidden="true" tabindex="-1"></a><span class="in">error_difference &lt;- best_id %&gt;%</span></span>
<span id="cb98-683"><a href="#cb98-683" aria-hidden="true" tabindex="-1"></a><span class="in">  select(id, condit, Model,Fit_Method, mean_error,abs_me) %&gt;%</span></span>
<span id="cb98-684"><a href="#cb98-684" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = Model, values_from = c(abs_me,mean_error)) %&gt;%</span></span>
<span id="cb98-685"><a href="#cb98-685" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Error_difference = (mean_error_ALM - mean_error_EXAM), abs_error_dif = (abs_me_ALM - abs_me_EXAM))</span></span>
<span id="cb98-686"><a href="#cb98-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-687"><a href="#cb98-687" aria-hidden="true" tabindex="-1"></a><span class="in">full_comparison &lt;- lowest_error_model |&gt; left_join(error_difference, by=c("id","condit","Fit_Method"))  |&gt; </span></span>
<span id="cb98-688"><a href="#cb98-688" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(condit,Fit_Method,Best_Model) |&gt; mutate(nGrp=n(), model_rank = nGrp - rank(Error_difference) ) |&gt; </span></span>
<span id="cb98-689"><a href="#cb98-689" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(Fit_Method,-Error_difference)</span></span>
<span id="cb98-690"><a href="#cb98-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-691"><a href="#cb98-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-692"><a href="#cb98-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-693"><a href="#cb98-693" aria-hidden="true" tabindex="-1"></a><span class="in">best_id |&gt; filter(Fit_Method=="Test_Train") |&gt; </span></span>
<span id="cb98-694"><a href="#cb98-694" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(mean_error) |&gt;</span></span>
<span id="cb98-695"><a href="#cb98-695" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() |&gt;</span></span>
<span id="cb98-696"><a href="#cb98-696" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(id = reorder(id, mean_error)) %&gt;%</span></span>
<span id="cb98-697"><a href="#cb98-697" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=id,x=mean_error,fill=Model))+</span></span>
<span id="cb98-698"><a href="#cb98-698" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col()+</span></span>
<span id="cb98-699"><a href="#cb98-699" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_grid2(~condit,axes="all",scales="free_y", independent = "y")</span></span>
<span id="cb98-700"><a href="#cb98-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-701"><a href="#cb98-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-702"><a href="#cb98-702" aria-hidden="true" tabindex="-1"></a><span class="in">best_id |&gt; filter(Fit_Method=="Test_Train") |&gt; </span></span>
<span id="cb98-703"><a href="#cb98-703" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() |&gt;</span></span>
<span id="cb98-704"><a href="#cb98-704" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(id = reorder(id, abs_me)) %&gt;%</span></span>
<span id="cb98-705"><a href="#cb98-705" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=id,x=abs_me,fill=Model))+</span></span>
<span id="cb98-706"><a href="#cb98-706" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col()+</span></span>
<span id="cb98-707"><a href="#cb98-707" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_grid2(~condit,axes="all",scales="free_y", independent = "y")</span></span>
<span id="cb98-708"><a href="#cb98-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-709"><a href="#cb98-709" aria-hidden="true" tabindex="-1"></a><span class="in">full_comparison |&gt; filter(Fit_Method=="Test_Train") |&gt; </span></span>
<span id="cb98-710"><a href="#cb98-710" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() |&gt;</span></span>
<span id="cb98-711"><a href="#cb98-711" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(id = reorder(id, abs_error_dif)) %&gt;%</span></span>
<span id="cb98-712"><a href="#cb98-712" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=id,x=abs_error_dif))+</span></span>
<span id="cb98-713"><a href="#cb98-713" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col()+</span></span>
<span id="cb98-714"><a href="#cb98-714" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_grid2(~condit,axes="all",scales="free_y", independent = "y")</span></span>
<span id="cb98-715"><a href="#cb98-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-716"><a href="#cb98-716" aria-hidden="true" tabindex="-1"></a><span class="in">full_comparison |&gt; filter(Fit_Method=="Test_Train") |&gt; </span></span>
<span id="cb98-717"><a href="#cb98-717" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() |&gt;</span></span>
<span id="cb98-718"><a href="#cb98-718" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(id = reorder(id, Error_difference)) %&gt;%</span></span>
<span id="cb98-719"><a href="#cb98-719" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=id,x=Error_difference))+</span></span>
<span id="cb98-720"><a href="#cb98-720" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col()+</span></span>
<span id="cb98-721"><a href="#cb98-721" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_grid2(~condit,axes="all",scales="free_y", independent = "y")</span></span>
<span id="cb98-722"><a href="#cb98-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-723"><a href="#cb98-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-724"><a href="#cb98-724" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- testAvg |&gt; left_join(full_comparison, by=c("id","condit")) |&gt; filter(Fit_Method=="Test_Train")</span></span>
<span id="cb98-725"><a href="#cb98-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-726"><a href="#cb98-726" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; ggplot(aes(x=vb,y=dist,fill=condit)) + stat_bar + facet_wrap(Fit_Method~Best_Model,ncol=2)</span></span>
<span id="cb98-727"><a href="#cb98-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-728"><a href="#cb98-728" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb98-729"><a href="#cb98-729" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(condit,Fit_Method,Best_Model) |&gt; </span></span>
<span id="cb98-730"><a href="#cb98-730" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(nGrp2=n()) |&gt;</span></span>
<span id="cb98-731"><a href="#cb98-731" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(abs(Error_difference)&gt;15) |&gt; </span></span>
<span id="cb98-732"><a href="#cb98-732" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=vb,y=dist,fill=condit)) + </span></span>
<span id="cb98-733"><a href="#cb98-733" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_bar + facet_wrap(Fit_Method~Best_Model,ncol=2)</span></span>
<span id="cb98-734"><a href="#cb98-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-735"><a href="#cb98-735" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; group_by(condit,Fit_Method,Best_Model) %&gt;% tally() |&gt; mutate(n=n/6)</span></span>
<span id="cb98-736"><a href="#cb98-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-737"><a href="#cb98-737" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; group_by(condit,Fit_Method,Best_Model) |&gt; filter(abs(Error_difference)&gt;15) |&gt; tally() |&gt; mutate(n=n/6)</span></span>
<span id="cb98-738"><a href="#cb98-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-739"><a href="#cb98-739" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; filter(bandInt==100) |&gt; group_by(condit,Fit_Method) |&gt; summarise(m=mean(Error_difference), </span></span>
<span id="cb98-740"><a href="#cb98-740" aria-hidden="true" tabindex="-1"></a><span class="in">                                              sd=sd(Error_difference), </span></span>
<span id="cb98-741"><a href="#cb98-741" aria-hidden="true" tabindex="-1"></a><span class="in">                                              n=n(),se=sd/sqrt(n))</span></span>
<span id="cb98-742"><a href="#cb98-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-743"><a href="#cb98-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-744"><a href="#cb98-744" aria-hidden="true" tabindex="-1"></a><span class="in"># head(map_id,2)</span></span>
<span id="cb98-745"><a href="#cb98-745" aria-hidden="true" tabindex="-1"></a><span class="in"># # A tibble: 2 × 13</span></span>
<span id="cb98-746"><a href="#cb98-746" aria-hidden="true" tabindex="-1"></a><span class="in"># # Groups:   id, condit, Model, Fit_Method [2]</span></span>
<span id="cb98-747"><a href="#cb98-747" aria-hidden="true" tabindex="-1"></a><span class="in">#   id    condit Fit_Method Model          c    lr mean_error  rank nTest nTrain nTotal     n   BIC</span></span>
<span id="cb98-748"><a href="#cb98-748" aria-hidden="true" tabindex="-1"></a><span class="in">#   &lt;fct&gt; &lt;fct&gt;  &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb98-749"><a href="#cb98-749" aria-hidden="true" tabindex="-1"></a><span class="in"># 1 1     Varied Test       ALM   0.00000165  5.32       238.     1    63     86    149    63 -6.80</span></span>
<span id="cb98-750"><a href="#cb98-750" aria-hidden="true" tabindex="-1"></a><span class="in"># 2 1     Varied Test_Train ALM   0.0000634   5.60       276.     1    63     86    149   149 -6.24</span></span>
<span id="cb98-751"><a href="#cb98-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-752"><a href="#cb98-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-753"><a href="#cb98-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-754"><a href="#cb98-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-755"><a href="#cb98-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-756"><a href="#cb98-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-757"><a href="#cb98-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-758"><a href="#cb98-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-759"><a href="#cb98-759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-760"><a href="#cb98-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-761"><a href="#cb98-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-762"><a href="#cb98-762" aria-hidden="true" tabindex="-1"></a><span class="in">#full_comparison |&gt; round_tibble(1) |&gt; reactable(filterable=T,defaultPageSize=15)</span></span>
<span id="cb98-763"><a href="#cb98-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-764"><a href="#cb98-764" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(full_comparison, aes(x = Best_Model, fill = condit)) +</span></span>
<span id="cb98-765"><a href="#cb98-765" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(position = "dodge") +</span></span>
<span id="cb98-766"><a href="#cb98-766" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~Fit_Method)+</span></span>
<span id="cb98-767"><a href="#cb98-767" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Distribution of Subjects Best Fit by Model",</span></span>
<span id="cb98-768"><a href="#cb98-768" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Model with Lowest Error",</span></span>
<span id="cb98-769"><a href="#cb98-769" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Count of Subjects") +</span></span>
<span id="cb98-770"><a href="#cb98-770" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb98-771"><a href="#cb98-771" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_brewer(palette = "Set1")</span></span>
<span id="cb98-772"><a href="#cb98-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-773"><a href="#cb98-773" aria-hidden="true" tabindex="-1"></a><span class="in"># Scatter plot showing the differential in mean error</span></span>
<span id="cb98-774"><a href="#cb98-774" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(full_comparison, aes(x = Error_difference, y = condit, color = Best_Model)) +</span></span>
<span id="cb98-775"><a href="#cb98-775" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha=.5) +</span></span>
<span id="cb98-776"><a href="#cb98-776" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_pointinterval()+</span></span>
<span id="cb98-777"><a href="#cb98-777" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~Fit_Method)+</span></span>
<span id="cb98-778"><a href="#cb98-778" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Differential in Mean Error Between Models",</span></span>
<span id="cb98-779"><a href="#cb98-779" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Error Difference (ALM - EXAM)",</span></span>
<span id="cb98-780"><a href="#cb98-780" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Condition") +</span></span>
<span id="cb98-781"><a href="#cb98-781" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb98-782"><a href="#cb98-782" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_brewer(palette = "Set1")</span></span>
<span id="cb98-783"><a href="#cb98-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-784"><a href="#cb98-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-785"><a href="#cb98-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-786"><a href="#cb98-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-787"><a href="#cb98-787" aria-hidden="true" tabindex="-1"></a><span class="in"># ggplot(full_comparison, aes(x = Error_difference)) +</span></span>
<span id="cb98-788"><a href="#cb98-788" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_histogram(aes(fill=Best_Model),bins = 40, alpha = 0.7) +</span></span>
<span id="cb98-789"><a href="#cb98-789" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_vline(aes(xintercept = mean(Error_difference)), color = "red", linetype = "dashed", size = 1) +</span></span>
<span id="cb98-790"><a href="#cb98-790" aria-hidden="true" tabindex="-1"></a><span class="in">#   facet_wrap(~Fit_Method)+</span></span>
<span id="cb98-791"><a href="#cb98-791" aria-hidden="true" tabindex="-1"></a><span class="in">#   labs(</span></span>
<span id="cb98-792"><a href="#cb98-792" aria-hidden="true" tabindex="-1"></a><span class="in">#     title = "Distribution of Error Differential (ALM - EXAM)",</span></span>
<span id="cb98-793"><a href="#cb98-793" aria-hidden="true" tabindex="-1"></a><span class="in">#     x = "Error Differential",</span></span>
<span id="cb98-794"><a href="#cb98-794" aria-hidden="true" tabindex="-1"></a><span class="in">#     y = "Frequency"</span></span>
<span id="cb98-795"><a href="#cb98-795" aria-hidden="true" tabindex="-1"></a><span class="in">#   ) +</span></span>
<span id="cb98-796"><a href="#cb98-796" aria-hidden="true" tabindex="-1"></a><span class="in">#   theme_minimal()</span></span>
<span id="cb98-797"><a href="#cb98-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-798"><a href="#cb98-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-799"><a href="#cb98-799" aria-hidden="true" tabindex="-1"></a><span class="in">best_exam &lt;- full_comparison |&gt; filter(Best_Model=="EXAM") </span></span>
<span id="cb98-800"><a href="#cb98-800" aria-hidden="true" tabindex="-1"></a><span class="in">best_alm &lt;- full_comparison |&gt; filter(Best_Model=="ALM") </span></span>
<span id="cb98-801"><a href="#cb98-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-802"><a href="#cb98-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-803"><a href="#cb98-803" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- testAvg |&gt; left_join(full_comparison, by=c("id","condit"))</span></span>
<span id="cb98-804"><a href="#cb98-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-805"><a href="#cb98-805" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; ggplot(aes(x=vb,y=dist,fill=condit)) + stat_bar + facet_wrap(Fit_Method~Best_Model,ncol=2)</span></span>
<span id="cb98-806"><a href="#cb98-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-807"><a href="#cb98-807" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; filter(abs(Error_difference)&gt;20) |&gt; </span></span>
<span id="cb98-808"><a href="#cb98-808" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=vb,y=dist,fill=condit)) + </span></span>
<span id="cb98-809"><a href="#cb98-809" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_bar + facet_wrap(Fit_Method~Best_Model,ncol=2)</span></span>
<span id="cb98-810"><a href="#cb98-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-811"><a href="#cb98-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-812"><a href="#cb98-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-813"><a href="#cb98-813" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; ggplot(aes(x=vb,y=vx,fill=condit)) + stat_bar + facet_wrap(Fit_Method~Best_Model,ncol=2)</span></span>
<span id="cb98-814"><a href="#cb98-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-815"><a href="#cb98-815" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; filter(Fit_Method=="Test") |&gt;</span></span>
<span id="cb98-816"><a href="#cb98-816" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=Error_difference,y=dist,col=condit)) + geom_point() + facet_wrap(~vb,scales="free",ncol=2)</span></span>
<span id="cb98-817"><a href="#cb98-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-818"><a href="#cb98-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-819"><a href="#cb98-819" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; group_by(id,condit,Fit_Method) |&gt; summarise(Error_difference=mean(Error_difference),dist=mean(dist)) |&gt; </span></span>
<span id="cb98-820"><a href="#cb98-820" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=Error_difference,y=dist,col=condit)) + geom_point() + facet_wrap(~Fit_Method,scales="free")</span></span>
<span id="cb98-821"><a href="#cb98-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-822"><a href="#cb98-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-823"><a href="#cb98-823" aria-hidden="true" tabindex="-1"></a><span class="in"># ds |&gt; filter(expMode2=="Test", id %in% best_exam$id) |&gt; </span></span>
<span id="cb98-824"><a href="#cb98-824" aria-hidden="true" tabindex="-1"></a><span class="in">#   group_by(id,condit,x) |&gt; summarise(y=mean(y), dist=mean(abs(x-y))) |&gt;</span></span>
<span id="cb98-825"><a href="#cb98-825" aria-hidden="true" tabindex="-1"></a><span class="in">#   mutate(x=as.factor(x)) |&gt;</span></span>
<span id="cb98-826"><a href="#cb98-826" aria-hidden="true" tabindex="-1"></a><span class="in">#   ggplot(aes(x=x,y=dist,fill=condit)) + stat_bar</span></span>
<span id="cb98-827"><a href="#cb98-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-828"><a href="#cb98-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-829"><a href="#cb98-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-830"><a href="#cb98-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-831"><a href="#cb98-831" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Test - EXAM Fits</span></span>
<span id="cb98-832"><a href="#cb98-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-833"><a href="#cb98-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-834"><a href="#cb98-834" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits &lt;- full_comparison |&gt; filter(model_rank&lt;=1)</span></span>
<span id="cb98-835"><a href="#cb98-835" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits |&gt; filter(Fit_Method=="Test",Best_Model=="EXAM") |&gt; pull(id) %&gt;% indv_predictive_plots(post_dat_l, .)</span></span>
<span id="cb98-836"><a href="#cb98-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-837"><a href="#cb98-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-838"><a href="#cb98-838" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Test - ALM Fits</span></span>
<span id="cb98-839"><a href="#cb98-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-840"><a href="#cb98-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-841"><a href="#cb98-841" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits &lt;- full_comparison |&gt; filter(model_rank&lt;=1)</span></span>
<span id="cb98-842"><a href="#cb98-842" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits |&gt; filter(Fit_Method=="Test",Best_Model=="ALM") |&gt; pull(id) %&gt;% indv_predictive_plots(post_dat_l, .)</span></span>
<span id="cb98-843"><a href="#cb98-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-844"><a href="#cb98-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-845"><a href="#cb98-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-846"><a href="#cb98-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-847"><a href="#cb98-847" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Test_Train - EXAM Fits</span></span>
<span id="cb98-848"><a href="#cb98-848" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-849"><a href="#cb98-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-850"><a href="#cb98-850" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits &lt;- full_comparison |&gt; filter(model_rank&lt;1)</span></span>
<span id="cb98-851"><a href="#cb98-851" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits |&gt; filter(Fit_Method=="Test_Train",Best_Model=="EXAM") |&gt; pull(id) %&gt;% indv_predictive_plots(post_dat_l, .)</span></span>
<span id="cb98-852"><a href="#cb98-852" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-853"><a href="#cb98-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-854"><a href="#cb98-854" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Test_Train - ALM Fits</span></span>
<span id="cb98-855"><a href="#cb98-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-856"><a href="#cb98-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-857"><a href="#cb98-857" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits &lt;- full_comparison |&gt; filter(model_rank&lt;=1)</span></span>
<span id="cb98-858"><a href="#cb98-858" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits |&gt; filter(Fit_Method=="Test_Train",Best_Model=="ALM") |&gt; pull(id) %&gt;% indv_predictive_plots(post_dat_l, .)</span></span>
<span id="cb98-859"><a href="#cb98-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-860"><a href="#cb98-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-861"><a href="#cb98-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-862"><a href="#cb98-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-863"><a href="#cb98-863" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Train - EXAM Fits</span></span>
<span id="cb98-864"><a href="#cb98-864" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-865"><a href="#cb98-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-866"><a href="#cb98-866" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits &lt;- full_comparison |&gt; filter(model_rank&lt;=1)</span></span>
<span id="cb98-867"><a href="#cb98-867" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits |&gt; filter(Fit_Method=="Train",Best_Model=="EXAM") |&gt; pull(id) %&gt;% indv_predictive_plots(post_dat_l, .)</span></span>
<span id="cb98-868"><a href="#cb98-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-869"><a href="#cb98-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-870"><a href="#cb98-870" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Train - ALM Fits</span></span>
<span id="cb98-871"><a href="#cb98-871" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=12}</span></span>
<span id="cb98-872"><a href="#cb98-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-873"><a href="#cb98-873" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits &lt;- full_comparison |&gt; filter(model_rank&lt;=1)</span></span>
<span id="cb98-874"><a href="#cb98-874" aria-hidden="true" tabindex="-1"></a><span class="in">strong_fits |&gt; filter(Fit_Method=="Train",Best_Model=="ALM") |&gt; pull(id) %&gt;% indv_predictive_plots(post_dat_l, .)</span></span>
<span id="cb98-875"><a href="#cb98-875" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-876"><a href="#cb98-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-877"><a href="#cb98-877" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Curves</span></span>
<span id="cb98-878"><a href="#cb98-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=16}</span></span>
<span id="cb98-879"><a href="#cb98-879" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Learning Curves"</span></span>
<span id="cb98-880"><a href="#cb98-880" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 11</span></span>
<span id="cb98-881"><a href="#cb98-881" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 13</span></span>
<span id="cb98-882"><a href="#cb98-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-883"><a href="#cb98-883" aria-hidden="true" tabindex="-1"></a><span class="in">pd_train_l |&gt; ggplot(aes(x=Block,y=dist,col=Resp))+</span></span>
<span id="cb98-884"><a href="#cb98-884" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point( stat = "summary", fun = mean) + </span></span>
<span id="cb98-885"><a href="#cb98-885" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_summary( geom = "line", fun = mean) +</span></span>
<span id="cb98-886"><a href="#cb98-886" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_summary(geom="errorbar",fun.data=mean_se,width=.1,alpha=.4) +</span></span>
<span id="cb98-887"><a href="#cb98-887" aria-hidden="true" tabindex="-1"></a><span class="in">  #facet_wrap(condit~x,scales="free")</span></span>
<span id="cb98-888"><a href="#cb98-888" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_nested_wrap(Fit_Method~condit~x,scales="free") +</span></span>
<span id="cb98-889"><a href="#cb98-889" aria-hidden="true" tabindex="-1"></a><span class="in">  #coord_cartesian(ylim = c(600, 1300)) +</span></span>
<span id="cb98-890"><a href="#cb98-890" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title="Full Posterior")</span></span>
<span id="cb98-891"><a href="#cb98-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-892"><a href="#cb98-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-893"><a href="#cb98-893" aria-hidden="true" tabindex="-1"></a><span class="in">pd_train_l |&gt;filter(rank==1) |&gt; ggplot(aes(x=Block,y=val,col=Resp))+</span></span>
<span id="cb98-894"><a href="#cb98-894" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point( stat = "summary", fun = mean) + </span></span>
<span id="cb98-895"><a href="#cb98-895" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_summary( geom = "line", fun = mean) +</span></span>
<span id="cb98-896"><a href="#cb98-896" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_summary(geom="errorbar",fun.data=mean_se,width=.1,alpha=.4) +</span></span>
<span id="cb98-897"><a href="#cb98-897" aria-hidden="true" tabindex="-1"></a><span class="in">  #facet_wrap(condit~x,scales="free")</span></span>
<span id="cb98-898"><a href="#cb98-898" aria-hidden="true" tabindex="-1"></a><span class="in">  ggh4x::facet_nested_wrap(Fit_Method~condit~x,scales="free") +</span></span>
<span id="cb98-899"><a href="#cb98-899" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim = c(600, 1300)) +labs(title="Best Parameters")</span></span>
<span id="cb98-900"><a href="#cb98-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-901"><a href="#cb98-901" aria-hidden="true" tabindex="-1"></a><span class="in">pd_train_l |&gt; filter(Fit_Method=="Train") |&gt; </span></span>
<span id="cb98-902"><a href="#cb98-902" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(x=as.factor(x), Resp=as.factor(Resp), Block=as.factor(Block)) |&gt;</span></span>
<span id="cb98-903"><a href="#cb98-903" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=x,y=val,fill=Block))+</span></span>
<span id="cb98-904"><a href="#cb98-904" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_bar +</span></span>
<span id="cb98-905"><a href="#cb98-905" aria-hidden="true" tabindex="-1"></a><span class="in">  #facet_wrap(condit~x,scales="free")</span></span>
<span id="cb98-906"><a href="#cb98-906" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(condit~Resp,scales="free",ncol=3) +</span></span>
<span id="cb98-907"><a href="#cb98-907" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim = c(600, 1300))</span></span>
<span id="cb98-908"><a href="#cb98-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-909"><a href="#cb98-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-910"><a href="#cb98-910" aria-hidden="true" tabindex="-1"></a><span class="in"># pd_train_l |&gt; filter(id %in% c(1,33,66, 36,76), Fit_Method=="Train") |&gt; </span></span>
<span id="cb98-911"><a href="#cb98-911" aria-hidden="true" tabindex="-1"></a><span class="in">#   ggplot(aes(x=Block,y=val,col=Resp))+</span></span>
<span id="cb98-912"><a href="#cb98-912" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_point( stat = "summary", fun = mean) + </span></span>
<span id="cb98-913"><a href="#cb98-913" aria-hidden="true" tabindex="-1"></a><span class="in">#   stat_summary( geom = "line", fun = mean) +</span></span>
<span id="cb98-914"><a href="#cb98-914" aria-hidden="true" tabindex="-1"></a><span class="in">#   stat_summary(geom="errorbar",fun.data=mean_se,width=.1,alpha=.4) +</span></span>
<span id="cb98-915"><a href="#cb98-915" aria-hidden="true" tabindex="-1"></a><span class="in">#   #facet_wrap(condit~x,scales="free")</span></span>
<span id="cb98-916"><a href="#cb98-916" aria-hidden="true" tabindex="-1"></a><span class="in">#   facet_wrap(id~x,scales="free",ncol=3) +</span></span>
<span id="cb98-917"><a href="#cb98-917" aria-hidden="true" tabindex="-1"></a><span class="in">#   coord_cartesian(ylim = c(600, 1300))</span></span>
<span id="cb98-918"><a href="#cb98-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-919"><a href="#cb98-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-920"><a href="#cb98-920" aria-hidden="true" tabindex="-1"></a><span class="in">pd_train_l |&gt; </span></span>
<span id="cb98-921"><a href="#cb98-921" aria-hidden="true" tabindex="-1"></a><span class="in">  #filter(id %in% c(1,33,66, 36,76), Fit_Method=="Train") |&gt; </span></span>
<span id="cb98-922"><a href="#cb98-922" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(x=as.factor(x), Resp=as.factor(Resp), Block=as.factor(Block)) |&gt;</span></span>
<span id="cb98-923"><a href="#cb98-923" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=x,y=dist,fill=Block))+</span></span>
<span id="cb98-924"><a href="#cb98-924" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_bar +</span></span>
<span id="cb98-925"><a href="#cb98-925" aria-hidden="true" tabindex="-1"></a><span class="in">  #facet_wrap(condit~x,scales="free")</span></span>
<span id="cb98-926"><a href="#cb98-926" aria-hidden="true" tabindex="-1"></a><span class="in">   #coord_cartesian(ylim = c(600, 1300)) +</span></span>
<span id="cb98-927"><a href="#cb98-927" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(id~Resp,scales="free",ncol=3) </span></span>
<span id="cb98-928"><a href="#cb98-928" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb98-929"><a href="#cb98-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-930"><a href="#cb98-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-931"><a href="#cb98-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-932"><a href="#cb98-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-933"><a href="#cb98-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-934"><a href="#cb98-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-937"><a href="#cb98-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-938"><a href="#cb98-938" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb98-939"><a href="#cb98-939" aria-hidden="true" tabindex="-1"></a>post_dat <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Model,<span class="at">y=</span>mean_error,<span class="at">fill=</span>Model))<span class="sc">+</span><span class="fu">geom_col</span>()<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>Fit_Method)</span>
<span id="cb98-940"><a href="#cb98-940" aria-hidden="true" tabindex="-1"></a>post_dat <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Model,<span class="at">y=</span>mean_error,<span class="at">fill=</span>Model))<span class="sc">+</span><span class="fu">geom_col</span>()<span class="sc">+</span><span class="fu">facet_wrap</span>(condit<span class="sc">~</span>Fit_Method)</span>
<span id="cb98-941"><a href="#cb98-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-942"><a href="#cb98-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-943"><a href="#cb98-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-944"><a href="#cb98-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-945"><a href="#cb98-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-946"><a href="#cb98-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-949"><a href="#cb98-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-950"><a href="#cb98-950" aria-hidden="true" tabindex="-1"></a><span class="co"># post_tabs &lt;- map(post_tabs, ~cbind(.x,run_info) |&gt; mutate(fn=file_name))</span></span>
<span id="cb98-951"><a href="#cb98-951" aria-hidden="true" tabindex="-1"></a><span class="co"># post_tabs$agg_pred_full_train &lt;- pt_train$agg_pred_full</span></span>
<span id="cb98-952"><a href="#cb98-952" aria-hidden="true" tabindex="-1"></a><span class="co"># post_tabs$block_pred_full &lt;- pt_train$block_pred_full</span></span>
<span id="cb98-953"><a href="#cb98-953" aria-hidden="true" tabindex="-1"></a><span class="co"># post_tabs$block_pred_full_x &lt;- pt_train$block_pred_full_x</span></span>
<span id="cb98-954"><a href="#cb98-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-955"><a href="#cb98-955" aria-hidden="true" tabindex="-1"></a><span class="co"># # path1 = "../../../data/abc_tabs"</span></span>
<span id="cb98-956"><a href="#cb98-956" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(post_tabs, paste0(path1, "/", tools::file_path_sans_ext(basename(file_name)),"_post_tab", ".rds"))</span></span>
<span id="cb98-957"><a href="#cb98-957" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(post_tabs, paste0(tools::file_path_sans_ext(basename(file_name)),"_post_tab", ".rds"))</span></span>
<span id="cb98-958"><a href="#cb98-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-959"><a href="#cb98-959" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/tegorman13/htw/blob/main/Sections/e1_model_appendix.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/tegorman13/htw/edit/main/Sections/e1_model_appendix.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/tegorman13/htw/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>